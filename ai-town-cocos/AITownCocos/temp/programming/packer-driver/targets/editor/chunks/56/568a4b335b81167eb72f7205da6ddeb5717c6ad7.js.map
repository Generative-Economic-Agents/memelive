{"version":3,"sources":["file:///Users/feiwang/cutepet/node_modules/aws-sdk/lib/resource_waiter.js"],"names":["_cjsLoader","_req","__cjsMetaURL","_req0","url","define","exports","require","module","__filename","__dirname","AWS","inherit","util","jmespath","CHECK_ACCEPTORS","resp","waiter","request","_waiter","acceptors","config","acceptorMatched","state","forEach","acceptor","matcher","matchers","expected","argument","error","setSuccess","setError","ResourceWaiter","constructor","service","loadWaiterConfig","path","result","search","data","err","strictDeepEqual","pathAll","results","Array","isArray","numResults","length","ind","pathAny","status","statusCode","httpResponse","code","listeners","SequentialExecutor","addNamedListeners","add","retryDelay","delay","wait","params","callback","undefined","$waiter","copy","maxAttempts","makeRequest","operation","response","maxRetries","addListeners","send","removeAllListeners","retryable","Error","message","api","waiters","_cjsExports"],"mappings":"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","sourcesContent":["import _cjsLoader from 'cce:/internal/ml/cjs-loader.mjs';\nimport { __cjsMetaURL as _req} from './core';\nimport { __cjsMetaURL as _req0} from 'jmespath';\nlet _cjsExports;\nconst __cjsMetaURL = import.meta.url;\n_cjsLoader.define(__cjsMetaURL, function (exports, require, module, __filename, __dirname) {\n// #region ORIGINAL CODE\n\n\n /**\n  * Copyright 2012-2013 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n  *\n  * Licensed under the Apache License, Version 2.0 (the \"License\"). You\n  * may not use this file except in compliance with the License. A copy of\n  * the License is located at\n  *\n  *     http://aws.amazon.com/apache2.0/\n  *\n  * or in the \"license\" file accompanying this file. This file is\n  * distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF\n  * ANY KIND, either express or implied. See the License for the specific\n  * language governing permissions and limitations under the License.\n  */\n\n var AWS = require('./core');\n var inherit = AWS.util.inherit;\n var jmespath = require('jmespath');\n\n /**\n  * @api private\n  */\n function CHECK_ACCEPTORS(resp) {\n   var waiter = resp.request._waiter;\n   var acceptors = waiter.config.acceptors;\n   var acceptorMatched = false;\n   var state = 'retry';\n\n   acceptors.forEach(function(acceptor) {\n     if (!acceptorMatched) {\n       var matcher = waiter.matchers[acceptor.matcher];\n       if (matcher && matcher(resp, acceptor.expected, acceptor.argument)) {\n         acceptorMatched = true;\n         state = acceptor.state;\n       }\n     }\n   });\n\n   if (!acceptorMatched && resp.error) state = 'failure';\n\n   if (state === 'success') {\n     waiter.setSuccess(resp);\n   } else {\n     waiter.setError(resp, state === 'retry');\n   }\n }\n\n /**\n  * @api private\n  */\n AWS.ResourceWaiter = inherit({\n   /**\n    * Waits for a given state on a service object\n    * @param service [Service] the service object to wait on\n    * @param state [String] the state (defined in waiter configuration) to wait\n    *   for.\n    * @example Create a waiter for running EC2 instances\n    *   var ec2 = new AWS.EC2;\n    *   var waiter = new AWS.ResourceWaiter(ec2, 'instanceRunning');\n    */\n   constructor: function constructor(service, state) {\n     this.service = service;\n     this.state = state;\n     this.loadWaiterConfig(this.state);\n   },\n\n   service: null,\n\n   state: null,\n\n   config: null,\n\n   matchers: {\n     path: function(resp, expected, argument) {\n       try {\n         var result = jmespath.search(resp.data, argument);\n       } catch (err) {\n         return false;\n       }\n\n       return jmespath.strictDeepEqual(result,expected);\n     },\n\n     pathAll: function(resp, expected, argument) {\n       try {\n         var results = jmespath.search(resp.data, argument);\n       } catch (err) {\n         return false;\n       }\n\n       if (!Array.isArray(results)) results = [results];\n       var numResults = results.length;\n       if (!numResults) return false;\n       for (var ind = 0 ; ind < numResults; ind++) {\n         if (!jmespath.strictDeepEqual(results[ind], expected)) {\n           return false;\n         }\n       }\n       return true;\n     },\n\n     pathAny: function(resp, expected, argument) {\n       try {\n         var results = jmespath.search(resp.data, argument);\n       } catch (err) {\n         return false;\n       }\n\n       if (!Array.isArray(results)) results = [results];\n       var numResults = results.length;\n       for (var ind = 0 ; ind < numResults; ind++) {\n         if (jmespath.strictDeepEqual(results[ind], expected)) {\n           return true;\n         }\n       }\n       return false;\n     },\n\n     status: function(resp, expected) {\n       var statusCode = resp.httpResponse.statusCode;\n       return (typeof statusCode === 'number') && (statusCode === expected);\n     },\n\n     error: function(resp, expected) {\n       if (typeof expected === 'string' && resp.error) {\n         return expected === resp.error.code;\n       }\n       // if expected is not string, can be boolean indicating presence of error\n       return expected === !!resp.error;\n     }\n   },\n\n   listeners: new AWS.SequentialExecutor().addNamedListeners(function(add) {\n     add('RETRY_CHECK', 'retry', function(resp) {\n       var waiter = resp.request._waiter;\n       if (resp.error && resp.error.code === 'ResourceNotReady') {\n         resp.error.retryDelay = (waiter.config.delay || 0) * 1000;\n       }\n     });\n\n     add('CHECK_OUTPUT', 'extractData', CHECK_ACCEPTORS);\n\n     add('CHECK_ERROR', 'extractError', CHECK_ACCEPTORS);\n   }),\n\n   /**\n    * @return [AWS.Request]\n    */\n   wait: function wait(params, callback) {\n     if (typeof params === 'function') {\n       callback = params; params = undefined;\n     }\n\n     if (params && params.$waiter) {\n       params = AWS.util.copy(params);\n       if (typeof params.$waiter.delay === 'number') {\n         this.config.delay = params.$waiter.delay;\n       }\n       if (typeof params.$waiter.maxAttempts === 'number') {\n         this.config.maxAttempts = params.$waiter.maxAttempts;\n       }\n       delete params.$waiter;\n     }\n\n     var request = this.service.makeRequest(this.config.operation, params);\n     request._waiter = this;\n     request.response.maxRetries = this.config.maxAttempts;\n     request.addListeners(this.listeners);\n\n     if (callback) request.send(callback);\n     return request;\n   },\n\n   setSuccess: function setSuccess(resp) {\n     resp.error = null;\n     resp.data = resp.data || {};\n     resp.request.removeAllListeners('extractData');\n   },\n\n   setError: function setError(resp, retryable) {\n     resp.data = null;\n     resp.error = AWS.util.error(resp.error || new Error(), {\n       code: 'ResourceNotReady',\n       message: 'Resource is not in the state ' + this.state,\n       retryable: retryable\n     });\n   },\n\n   /**\n    * Loads waiter configuration from API configuration\n    *\n    * @api private\n    */\n   loadWaiterConfig: function loadWaiterConfig(state) {\n     if (!this.service.api.waiters[state]) {\n       throw new AWS.util.error(new Error(), {\n         code: 'StateNotFoundError',\n         message: 'State ' + state + ' not found.'\n       });\n     }\n\n     this.config = AWS.util.copy(this.service.api.waiters[state]);\n   }\n });\n\n\n// #endregion ORIGINAL CODE\n\n_cjsExports = module.exports;\n\n\n}, () => ({\n  './core': _req,\n  'jmespath': _req0,\n}));\nexport { _cjsExports as default };\nexport { __cjsMetaURL }\n"]}