{"version":3,"sources":["file:///Users/feiwang/cutepet/node_modules/tough-cookie/lib/memstore.js"],"names":["_cjsLoader","_req","__cjsMetaURL","_req0","_req1","_req2","url","define","exports","require","module","__filename","__dirname","Store","permuteDomain","pathMatch","util","MemoryCookieStore","call","idx","inherits","prototype","synchronous","inspect","custom","findCookie","domain","path","key","cb","undefined","findCookies","results","pathMatcher","matchAll","domainIndex","curPath","pathIndex","push","matchRFC","Object","keys","forEach","cookiePath","domains","curDomain","putCookie","cookie","updateCookie","oldCookie","newCookie","removeCookie","removeCookies","removeAllCookies","getAllCookies","cookies","paths","sort","a","b","creationIndex","_cjsExports","_MemoryCookieStore"],"mappings":"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","sourcesContent":["import _cjsLoader from 'cce:/internal/ml/cjs-loader.mjs';\nimport { __cjsMetaURL as _req} from './store';\nimport { __cjsMetaURL as _req0} from './permuteDomain';\nimport { __cjsMetaURL as _req1} from './pathMatch';\nimport { __cjsMetaURL as _req2} from 'util';\nlet _cjsExports;\nlet _MemoryCookieStore;\nconst __cjsMetaURL = import.meta.url;\n_cjsLoader.define(__cjsMetaURL, function (exports, require, module, __filename, __dirname) {\n// #region ORIGINAL CODE\n\n\n /*!\n  * Copyright (c) 2015, Salesforce.com, Inc.\n  * All rights reserved.\n  *\n  * Redistribution and use in source and binary forms, with or without\n  * modification, are permitted provided that the following conditions are met:\n  *\n  * 1. Redistributions of source code must retain the above copyright notice,\n  * this list of conditions and the following disclaimer.\n  *\n  * 2. Redistributions in binary form must reproduce the above copyright notice,\n  * this list of conditions and the following disclaimer in the documentation\n  * and/or other materials provided with the distribution.\n  *\n  * 3. Neither the name of Salesforce.com nor the names of its contributors may\n  * be used to endorse or promote products derived from this software without\n  * specific prior written permission.\n  *\n  * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n  * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n  * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE\n  * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n  * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n  * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n  * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n  * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n  * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n  * POSSIBILITY OF SUCH DAMAGE.\n  */\n 'use strict';\n var Store = require('./store').Store;\n var permuteDomain = require('./permuteDomain').permuteDomain;\n var pathMatch = require('./pathMatch').pathMatch;\n var util = require('util');\n\n function MemoryCookieStore() {\n   Store.call(this);\n   this.idx = {};\n }\n util.inherits(MemoryCookieStore, Store);\n exports.MemoryCookieStore = MemoryCookieStore;\n MemoryCookieStore.prototype.idx = null;\n\n // Since it's just a struct in RAM, this Store is synchronous\n MemoryCookieStore.prototype.synchronous = true;\n\n // force a default depth:\n MemoryCookieStore.prototype.inspect = function() {\n   return \"{ idx: \"+util.inspect(this.idx, false, 2)+' }';\n };\n\n // Use the new custom inspection symbol to add the custom inspect function if\n // available.\n if (util.inspect.custom) {\n   MemoryCookieStore.prototype[util.inspect.custom] = MemoryCookieStore.prototype.inspect;\n }\n\n MemoryCookieStore.prototype.findCookie = function(domain, path, key, cb) {\n   if (!this.idx[domain]) {\n     return cb(null,undefined);\n   }\n   if (!this.idx[domain][path]) {\n     return cb(null,undefined);\n   }\n   return cb(null,this.idx[domain][path][key]||null);\n };\n\n MemoryCookieStore.prototype.findCookies = function(domain, path, cb) {\n   var results = [];\n   if (!domain) {\n     return cb(null,[]);\n   }\n\n   var pathMatcher;\n   if (!path) {\n     // null means \"all paths\"\n     pathMatcher = function matchAll(domainIndex) {\n       for (var curPath in domainIndex) {\n         var pathIndex = domainIndex[curPath];\n         for (var key in pathIndex) {\n           results.push(pathIndex[key]);\n         }\n       }\n     };\n\n   } else {\n     pathMatcher = function matchRFC(domainIndex) {\n        //NOTE: we should use path-match algorithm from S5.1.4 here\n        //(see : https://github.com/ChromiumWebApps/chromium/blob/b3d3b4da8bb94c1b2e061600df106d590fda3620/net/cookies/canonical_cookie.cc#L299)\n        Object.keys(domainIndex).forEach(function (cookiePath) {\n          if (pathMatch(path, cookiePath)) {\n            var pathIndex = domainIndex[cookiePath];\n\n            for (var key in pathIndex) {\n              results.push(pathIndex[key]);\n            }\n          }\n        });\n      };\n   }\n\n   var domains = permuteDomain(domain) || [domain];\n   var idx = this.idx;\n   domains.forEach(function(curDomain) {\n     var domainIndex = idx[curDomain];\n     if (!domainIndex) {\n       return;\n     }\n     pathMatcher(domainIndex);\n   });\n\n   cb(null,results);\n };\n\n MemoryCookieStore.prototype.putCookie = function(cookie, cb) {\n   if (!this.idx[cookie.domain]) {\n     this.idx[cookie.domain] = {};\n   }\n   if (!this.idx[cookie.domain][cookie.path]) {\n     this.idx[cookie.domain][cookie.path] = {};\n   }\n   this.idx[cookie.domain][cookie.path][cookie.key] = cookie;\n   cb(null);\n };\n\n MemoryCookieStore.prototype.updateCookie = function(oldCookie, newCookie, cb) {\n   // updateCookie() may avoid updating cookies that are identical.  For example,\n   // lastAccessed may not be important to some stores and an equality\n   // comparison could exclude that field.\n   this.putCookie(newCookie,cb);\n };\n\n MemoryCookieStore.prototype.removeCookie = function(domain, path, key, cb) {\n   if (this.idx[domain] && this.idx[domain][path] && this.idx[domain][path][key]) {\n     delete this.idx[domain][path][key];\n   }\n   cb(null);\n };\n\n MemoryCookieStore.prototype.removeCookies = function(domain, path, cb) {\n   if (this.idx[domain]) {\n     if (path) {\n       delete this.idx[domain][path];\n     } else {\n       delete this.idx[domain];\n     }\n   }\n   return cb(null);\n };\n\n MemoryCookieStore.prototype.removeAllCookies = function(cb) {\n   this.idx = {};\n   return cb(null);\n }\n\n MemoryCookieStore.prototype.getAllCookies = function(cb) {\n   var cookies = [];\n   var idx = this.idx;\n\n   var domains = Object.keys(idx);\n   domains.forEach(function(domain) {\n     var paths = Object.keys(idx[domain]);\n     paths.forEach(function(path) {\n       var keys = Object.keys(idx[domain][path]);\n       keys.forEach(function(key) {\n         if (key !== null) {\n           cookies.push(idx[domain][path][key]);\n         }\n       });\n     });\n   });\n\n   // Sort by creationIndex so deserializing retains the creation order.\n   // When implementing your own store, this SHOULD retain the order too\n   cookies.sort(function(a,b) {\n     return (a.creationIndex||0) - (b.creationIndex||0);\n   });\n\n   cb(null, cookies);\n };\n\n\n// #endregion ORIGINAL CODE\n\n_cjsExports = module.exports;\n_MemoryCookieStore = module.exports.MemoryCookieStore;\n\n}, () => ({\n  './store': _req,\n  './permuteDomain': _req0,\n  './pathMatch': _req1,\n  'util': _req2,\n}));\nexport { _cjsExports as default };\nexport { __cjsMetaURL }\n"]}