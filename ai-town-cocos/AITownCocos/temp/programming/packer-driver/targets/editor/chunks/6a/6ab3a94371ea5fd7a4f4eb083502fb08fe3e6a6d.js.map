{"version":3,"sources":["file:///Users/feiwang/AITown/AITownCocos/assets/src/module/main/TabGroup.ts"],"names":["_decorator","Component","Node","Button","modelMgr","observer","EventType","AudioManager","ccclass","property","TabGroup","type","String","start","on_tab_button_click","mainModel","currentTapIndex","tabtype","node","on","TOUCH_END","_onTouchEnd","TOUCH_CANCEL","touchEvent","update","deltaTime","disable_tab","index","tabbtns","getComponent","interactable","getChildByName","active","tabcontents","enable_tab","emit","e","parseInt","i","length","refresh_tab_content","instance","playSound","post","UPDATE_SHOP_INDEX","chgTab","ind","setShowTab","tabIndex","needShow","resetAllTabs"],"mappings":"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","sourcesContent":["import { _decorator, Component, Node, Button, EventTouch } from 'cc';\nimport { modelMgr, observer } from '../../game/App';\nimport { EventType } from '../../EventType';\nimport { AudioManager } from '../../manager/AudioManager';\nconst { ccclass, property } = _decorator;\n\n@ccclass('TabGroup')\nexport class TabGroup extends Component {\n    @property({ type: [Node] })\n    public tabbtns: Node[] = [];\n    @property({ type: [Node] })\n    public tabcontents: Node[] = [];\n    @property(String)\n    public tabtype: string = \"\";\n    start() {\n        //记录打开当前页index,即使被销毁后\n        this.on_tab_button_click(null, modelMgr.mainModel.currentTapIndex[this.tabtype]);\n        this.node.on(Node.EventType.TOUCH_END, this._onTouchEnd, this);\n        this.node.on(Node.EventType.TOUCH_CANCEL, this._onTouchEnd, this);\n        // for (let index = 0; index <  this.tabbtns.length; index++) {\n        //     const element =  this.tabbtns[index];\n        //     if(!element.hasEventListener(Button.EventType.CLICK,this.on_tab_button_click,this)){\n        //         element.on(Button.EventType.CLICK,this.on_tab_button_click,this);\n        //     }\n        // }\n\n    }\n    _onTouchEnd(touchEvent: EventTouch) {\n    }\n    update(deltaTime: number) {\n\n    }\n    private disable_tab(index: any) {\n        if (this.tabbtns[index]) {\n            this.tabbtns[index].getComponent(Button).interactable = true;\n            this.tabbtns[index].getChildByName(\"on\").active = false;\n            this.tabbtns[index].getChildByName(\"off\").active = true;\n            this.tabcontents[index].active = false;\n        }\n\n\n\n    };\n    private enable_tab(index) {\n        if (this.tabbtns[index]) {\n            this.tabbtns[index].getComponent(Button).interactable = false;//禁用,已处于点击状态\n            this.tabbtns[index].getChildByName(\"on\").active = true;\n            this.tabbtns[index].getChildByName(\"off\").active = false;\n            this.tabcontents[index].active = true;\n            modelMgr.mainModel.currentTapIndex[this.tabtype] = index;\n            this.node.emit(\"update_tab_content\", this.tabcontents[index]);\n        }\n\n    };\n    private on_tab_button_click(e, index) {\n        //AudioManager.instance.playSound(\"new_NormanBtn\");\n        index = parseInt(index);\n        for (let i = 0; i < this.tabbtns.length; i++) {\n            if (i == index) {\n                // this.enable_tab(i);\n            }\n            else {\n                this.disable_tab(i);\n            }\n        }\n        //支持操作同一个content\n        if (this.tabbtns[index]) {\n            this.enable_tab(index);\n            this.node.emit(\"tabgroupeclick\", index);\n        }\n\n    }\n\n    private refresh_tab_content(e, index){\n        AudioManager.instance.playSound(\"new_NormanBtn\");\n        index = parseInt(index);\n        for (let i = 0; i < this.tabbtns.length; i++) {\n            if (i == index) {\n                // this.enable_tab(i);\n            }\n            else {\n                if (this.tabbtns[i]) {\n                    this.tabbtns[i].getComponent(Button).interactable = true;\n                    this.tabbtns[i].getChildByName(\"on\").active = false;\n                    this.tabbtns[i].getChildByName(\"off\").active = true;\n                }\n            }\n        }\n        //支持操作同一个content\n        if (this.tabbtns[index]) {\n            //this.enable_tab(index);\n            if (this.tabbtns[index]) {\n                this.tabbtns[index].getComponent(Button).interactable = false;//禁用,已处于点击状态\n                this.tabbtns[index].getChildByName(\"on\").active = true;\n                this.tabbtns[index].getChildByName(\"off\").active = false;\n                //this.tabcontents[index].active = true;\n                //modelMgr.mainModel.currentTapIndex[this.tabtype] = index;\n            }\n        }\n        observer.post(EventType.UPDATE_SHOP_INDEX, index + 1)\n    }\n\n    /**\n     * 外部改变tabgroup\n     * @param ind \n     */\n    public chgTab(ind) {\n        this.on_tab_button_click(null, ind);\n    }\n    /**\n     * 显示/隐藏某个tab\n     * @param tabIndex \n     * @param needShow \n     */\n    public setShowTab(tabIndex: number, needShow: boolean) {\n        if (this.tabbtns[tabIndex]) {\n            this.tabbtns[tabIndex].active = needShow;\n            if (this.tabcontents[tabIndex].active) {\n                if (tabIndex == 0) {\n                    this.on_tab_button_click(null, tabIndex + 1);\n                } else {\n                    this.on_tab_button_click(null, 0);\n                }\n\n            }\n        }\n    }\n\n    /**\n     * 隐藏所有tabs\n     */\n    public resetAllTabs() {\n        for (let i = 0; i < this.tabbtns.length; i++) {\n            this.disable_tab(i);\n        }\n        modelMgr.mainModel.currentTapIndex[this.tabtype] = -1;\n    }\n\n}\n\n/**\n * \n */"]}