{"version":3,"sources":["file:///Users/feiwang/cutepet/node_modules/sshpk/lib/ssh-buffer.js"],"names":["_cjsLoader","_req","__cjsMetaURL","_req0","url","define","exports","require","module","__filename","__dirname","SSHBuffer","assert","Buffer","opts","object","buffer","undefined","_size","length","_buffer","alloc","_offset","prototype","toBuffer","slice","atEnd","remainder","skip","n","expand","buf","copy","readPart","data","readBuffer","len","readUInt32BE","ok","toString","readString","readCString","offset","str","readInt","v","readInt64","readChar","writeBuffer","writeUInt32BE","writeString","from","writeCString","write","writeInt","writeInt64","lead","i","strictEqual","writeChar","writePart","p","_cjsExports"],"mappings":"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","sourcesContent":["import _cjsLoader from 'cce:/internal/ml/cjs-loader.mjs';\nimport { __cjsMetaURL as _req} from 'assert-plus';\nimport { __cjsMetaURL as _req0} from 'safer-buffer';\nlet _cjsExports;\nconst __cjsMetaURL = import.meta.url;\n_cjsLoader.define(__cjsMetaURL, function (exports, require, module, __filename, __dirname) {\n// #region ORIGINAL CODE\n\n\n // Copyright 2015 Joyent, Inc.\n\n module.exports = SSHBuffer;\n\n var assert = require('assert-plus');\n var Buffer = require('safer-buffer').Buffer;\n\n function SSHBuffer(opts) {\n \tassert.object(opts, 'options');\n \tif (opts.buffer !== undefined)\n \t\tassert.buffer(opts.buffer, 'options.buffer');\n\n \tthis._size = opts.buffer ? opts.buffer.length : 1024;\n \tthis._buffer = opts.buffer || Buffer.alloc(this._size);\n \tthis._offset = 0;\n }\n\n SSHBuffer.prototype.toBuffer = function () {\n \treturn (this._buffer.slice(0, this._offset));\n };\n\n SSHBuffer.prototype.atEnd = function () {\n \treturn (this._offset >= this._buffer.length);\n };\n\n SSHBuffer.prototype.remainder = function () {\n \treturn (this._buffer.slice(this._offset));\n };\n\n SSHBuffer.prototype.skip = function (n) {\n \tthis._offset += n;\n };\n\n SSHBuffer.prototype.expand = function () {\n \tthis._size *= 2;\n \tvar buf = Buffer.alloc(this._size);\n \tthis._buffer.copy(buf, 0);\n \tthis._buffer = buf;\n };\n\n SSHBuffer.prototype.readPart = function () {\n \treturn ({data: this.readBuffer()});\n };\n\n SSHBuffer.prototype.readBuffer = function () {\n \tvar len = this._buffer.readUInt32BE(this._offset);\n \tthis._offset += 4;\n \tassert.ok(this._offset + len <= this._buffer.length,\n \t    'length out of bounds at +0x' + this._offset.toString(16) +\n \t    ' (data truncated?)');\n \tvar buf = this._buffer.slice(this._offset, this._offset + len);\n \tthis._offset += len;\n \treturn (buf);\n };\n\n SSHBuffer.prototype.readString = function () {\n \treturn (this.readBuffer().toString());\n };\n\n SSHBuffer.prototype.readCString = function () {\n \tvar offset = this._offset;\n \twhile (offset < this._buffer.length &&\n \t    this._buffer[offset] !== 0x00)\n \t\toffset++;\n \tassert.ok(offset < this._buffer.length, 'c string does not terminate');\n \tvar str = this._buffer.slice(this._offset, offset).toString();\n \tthis._offset = offset + 1;\n \treturn (str);\n };\n\n SSHBuffer.prototype.readInt = function () {\n \tvar v = this._buffer.readUInt32BE(this._offset);\n \tthis._offset += 4;\n \treturn (v);\n };\n\n SSHBuffer.prototype.readInt64 = function () {\n \tassert.ok(this._offset + 8 < this._buffer.length,\n \t    'buffer not long enough to read Int64');\n \tvar v = this._buffer.slice(this._offset, this._offset + 8);\n \tthis._offset += 8;\n \treturn (v);\n };\n\n SSHBuffer.prototype.readChar = function () {\n \tvar v = this._buffer[this._offset++];\n \treturn (v);\n };\n\n SSHBuffer.prototype.writeBuffer = function (buf) {\n \twhile (this._offset + 4 + buf.length > this._size)\n \t\tthis.expand();\n \tthis._buffer.writeUInt32BE(buf.length, this._offset);\n \tthis._offset += 4;\n \tbuf.copy(this._buffer, this._offset);\n \tthis._offset += buf.length;\n };\n\n SSHBuffer.prototype.writeString = function (str) {\n \tthis.writeBuffer(Buffer.from(str, 'utf8'));\n };\n\n SSHBuffer.prototype.writeCString = function (str) {\n \twhile (this._offset + 1 + str.length > this._size)\n \t\tthis.expand();\n \tthis._buffer.write(str, this._offset);\n \tthis._offset += str.length;\n \tthis._buffer[this._offset++] = 0;\n };\n\n SSHBuffer.prototype.writeInt = function (v) {\n \twhile (this._offset + 4 > this._size)\n \t\tthis.expand();\n \tthis._buffer.writeUInt32BE(v, this._offset);\n \tthis._offset += 4;\n };\n\n SSHBuffer.prototype.writeInt64 = function (v) {\n \tassert.buffer(v, 'value');\n \tif (v.length > 8) {\n \t\tvar lead = v.slice(0, v.length - 8);\n \t\tfor (var i = 0; i < lead.length; ++i) {\n \t\t\tassert.strictEqual(lead[i], 0,\n \t\t\t    'must fit in 64 bits of precision');\n \t\t}\n \t\tv = v.slice(v.length - 8, v.length);\n \t}\n \twhile (this._offset + 8 > this._size)\n \t\tthis.expand();\n \tv.copy(this._buffer, this._offset);\n \tthis._offset += 8;\n };\n\n SSHBuffer.prototype.writeChar = function (v) {\n \twhile (this._offset + 1 > this._size)\n \t\tthis.expand();\n \tthis._buffer[this._offset++] = v;\n };\n\n SSHBuffer.prototype.writePart = function (p) {\n \tthis.writeBuffer(p.data);\n };\n\n SSHBuffer.prototype.write = function (buf) {\n \twhile (this._offset + buf.length > this._size)\n \t\tthis.expand();\n \tbuf.copy(this._buffer, this._offset);\n \tthis._offset += buf.length;\n };\n\n\n// #endregion ORIGINAL CODE\n\n_cjsExports = module.exports;\n\n\n}, () => ({\n  'assert-plus': _req,\n  'safer-buffer': _req0,\n}));\nexport { _cjsExports as default };\nexport { __cjsMetaURL }\n"]}