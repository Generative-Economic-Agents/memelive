{"version":3,"sources":["file:///Users/feiwang/cutepet/node_modules/sshpk/lib/ed-compat.js"],"names":["_cjsLoader","_req","__cjsMetaURL","_req0","_req1","_req2","_req3","_req4","url","define","exports","require","module","__filename","__dirname","Verifier","Signer","nacl","stream","util","assert","Buffer","Signature","key","hashAlgo","toLowerCase","Error","chunks","Writable","call","inherits","prototype","_write","chunk","enc","cb","push","update","from","verify","signature","fmt","sig","isSignature","type","toBuffer","buffer","sign","detached","Uint8Array","concat","part","A","data","k","sigBuf","sigObj","parse","hashAlgorithm","_cjsExports","_Verifier","_Signer"],"mappings":"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","sourcesContent":["import _cjsLoader from 'cce:/internal/ml/cjs-loader.mjs';\nimport { __cjsMetaURL as _req} from 'tweetnacl';\nimport { __cjsMetaURL as _req0} from 'stream';\nimport { __cjsMetaURL as _req1} from 'util';\nimport { __cjsMetaURL as _req2} from 'assert-plus';\nimport { __cjsMetaURL as _req3} from 'safer-buffer';\nimport { __cjsMetaURL as _req4} from './signature';\nlet _cjsExports;\nlet _Verifier;\nlet _Signer;\nconst __cjsMetaURL = import.meta.url;\n_cjsLoader.define(__cjsMetaURL, function (exports, require, module, __filename, __dirname) {\n// #region ORIGINAL CODE\n\n\n // Copyright 2015 Joyent, Inc.\n\n module.exports = {\n \tVerifier: Verifier,\n \tSigner: Signer\n };\n\n var nacl = require('tweetnacl');\n var stream = require('stream');\n var util = require('util');\n var assert = require('assert-plus');\n var Buffer = require('safer-buffer').Buffer;\n var Signature = require('./signature');\n\n function Verifier(key, hashAlgo) {\n \tif (hashAlgo.toLowerCase() !== 'sha512')\n \t\tthrow (new Error('ED25519 only supports the use of ' +\n \t\t    'SHA-512 hashes'));\n\n \tthis.key = key;\n \tthis.chunks = [];\n\n \tstream.Writable.call(this, {});\n }\n util.inherits(Verifier, stream.Writable);\n\n Verifier.prototype._write = function (chunk, enc, cb) {\n \tthis.chunks.push(chunk);\n \tcb();\n };\n\n Verifier.prototype.update = function (chunk) {\n \tif (typeof (chunk) === 'string')\n \t\tchunk = Buffer.from(chunk, 'binary');\n \tthis.chunks.push(chunk);\n };\n\n Verifier.prototype.verify = function (signature, fmt) {\n \tvar sig;\n \tif (Signature.isSignature(signature, [2, 0])) {\n \t\tif (signature.type !== 'ed25519')\n \t\t\treturn (false);\n \t\tsig = signature.toBuffer('raw');\n\n \t} else if (typeof (signature) === 'string') {\n \t\tsig = Buffer.from(signature, 'base64');\n\n \t} else if (Signature.isSignature(signature, [1, 0])) {\n \t\tthrow (new Error('signature was created by too old ' +\n \t\t    'a version of sshpk and cannot be verified'));\n \t}\n\n \tassert.buffer(sig);\n \treturn (nacl.sign.detached.verify(\n \t    new Uint8Array(Buffer.concat(this.chunks)),\n \t    new Uint8Array(sig),\n \t    new Uint8Array(this.key.part.A.data)));\n };\n\n function Signer(key, hashAlgo) {\n \tif (hashAlgo.toLowerCase() !== 'sha512')\n \t\tthrow (new Error('ED25519 only supports the use of ' +\n \t\t    'SHA-512 hashes'));\n\n \tthis.key = key;\n \tthis.chunks = [];\n\n \tstream.Writable.call(this, {});\n }\n util.inherits(Signer, stream.Writable);\n\n Signer.prototype._write = function (chunk, enc, cb) {\n \tthis.chunks.push(chunk);\n \tcb();\n };\n\n Signer.prototype.update = function (chunk) {\n \tif (typeof (chunk) === 'string')\n \t\tchunk = Buffer.from(chunk, 'binary');\n \tthis.chunks.push(chunk);\n };\n\n Signer.prototype.sign = function () {\n \tvar sig = nacl.sign.detached(\n \t    new Uint8Array(Buffer.concat(this.chunks)),\n \t    new Uint8Array(Buffer.concat([\n \t\tthis.key.part.k.data, this.key.part.A.data])));\n \tvar sigBuf = Buffer.from(sig);\n \tvar sigObj = Signature.parse(sigBuf, 'ed25519', 'raw');\n \tsigObj.hashAlgorithm = 'sha512';\n \treturn (sigObj);\n };\n\n\n// #endregion ORIGINAL CODE\n\n_cjsExports = module.exports;\n_Verifier = module.exports.Verifier;\n_Signer = module.exports.Signer;\n\n}, () => ({\n  'tweetnacl': _req,\n  'stream': _req0,\n  'util': _req1,\n  'assert-plus': _req2,\n  'safer-buffer': _req3,\n  './signature': _req4,\n}));\nexport { _cjsExports as default };\nexport { __cjsMetaURL }\n"]}