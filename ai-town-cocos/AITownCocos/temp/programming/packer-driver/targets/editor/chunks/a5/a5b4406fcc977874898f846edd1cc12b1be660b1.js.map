{"version":3,"sources":["file:///Users/feiwang/cutepet/node_modules/ecc-jsbn/index.js"],"names":["_cjsLoader","_req","__cjsMetaURL","_req0","_req1","_req2","_req3","url","define","exports","require","module","__filename","__dirname","crypto","BigInteger","ECPointFp","Buffer","ECCurves","unstupid","hex","len","length","ECKey","curve","key","isPublic","priv","c","n","getN","bytes","Math","floor","bitLength","getCurve","P","decodePointHex","toString","n1","subtract","ONE","r","randomBytes","mod","add","getG","multiply","PublicKey","from","encodeCompressedPointHex","PrivateKey","deriveSharedSecret","S","getX","toBigInteger","_cjsExports","_ECCurves","_ECKey"],"mappings":"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","sourcesContent":["import _cjsLoader from 'cce:/internal/ml/cjs-loader.mjs';\nimport { __cjsMetaURL as _req} from 'crypto';\nimport { __cjsMetaURL as _req0} from 'jsbn';\nimport { __cjsMetaURL as _req1} from './lib/ec.js';\nimport { __cjsMetaURL as _req2} from 'safer-buffer';\nimport { __cjsMetaURL as _req3} from './lib/sec.js';\nlet _cjsExports;\nlet _ECCurves;\nlet _ECKey;\nconst __cjsMetaURL = import.meta.url;\n_cjsLoader.define(__cjsMetaURL, function (exports, require, module, __filename, __dirname) {\n// #region ORIGINAL CODE\n\n\n var crypto = require(\"crypto\");\n var BigInteger = require(\"jsbn\").BigInteger;\n var ECPointFp = require(\"./lib/ec.js\").ECPointFp;\n var Buffer = require(\"safer-buffer\").Buffer;\n exports.ECCurves = require(\"./lib/sec.js\");\n\n // zero prepad\n function unstupid(hex,len)\n {\n \treturn (hex.length >= len) ? hex : unstupid(\"0\"+hex,len);\n }\n\n exports.ECKey = function(curve, key, isPublic)\n {\n   var priv;\n \tvar c = curve();\n \tvar n = c.getN();\n   var bytes = Math.floor(n.bitLength()/8);\n\n   if(key)\n   {\n     if(isPublic)\n     {\n       var curve = c.getCurve();\n //      var x = key.slice(1,bytes+1); // skip the 04 for uncompressed format\n //      var y = key.slice(bytes+1);\n //      this.P = new ECPointFp(curve,\n //        curve.fromBigInteger(new BigInteger(x.toString(\"hex\"), 16)),\n //        curve.fromBigInteger(new BigInteger(y.toString(\"hex\"), 16)));      \n       this.P = curve.decodePointHex(key.toString(\"hex\"));\n     }else{\n       if(key.length != bytes) return false;\n       priv = new BigInteger(key.toString(\"hex\"), 16);      \n     }\n   }else{\n     var n1 = n.subtract(BigInteger.ONE);\n     var r = new BigInteger(crypto.randomBytes(n.bitLength()));\n     priv = r.mod(n1).add(BigInteger.ONE);\n     this.P = c.getG().multiply(priv);\n   }\n   if(this.P)\n   {\n //  var pubhex = unstupid(this.P.getX().toBigInteger().toString(16),bytes*2)+unstupid(this.P.getY().toBigInteger().toString(16),bytes*2);\n //  this.PublicKey = Buffer.from(\"04\"+pubhex,\"hex\");\n     this.PublicKey = Buffer.from(c.getCurve().encodeCompressedPointHex(this.P),\"hex\");\n   }\n   if(priv)\n   {\n     this.PrivateKey = Buffer.from(unstupid(priv.toString(16),bytes*2),\"hex\");\n     this.deriveSharedSecret = function(key)\n     {\n       if(!key || !key.P) return false;\n       var S = key.P.multiply(priv);\n       return Buffer.from(unstupid(S.getX().toBigInteger().toString(16),bytes*2),\"hex\");\n    }     \n   }\n }\n\n\n\n// #endregion ORIGINAL CODE\n\n_cjsExports = module.exports;\n_ECCurves = module.exports.ECCurves;\n_ECKey = module.exports.ECKey;\n\n}, () => ({\n  'crypto': _req,\n  'jsbn': _req0,\n  './lib/ec.js': _req1,\n  'safer-buffer': _req2,\n  './lib/sec.js': _req3,\n}));\nexport { _cjsExports as default };\nexport { __cjsMetaURL }\n"]}