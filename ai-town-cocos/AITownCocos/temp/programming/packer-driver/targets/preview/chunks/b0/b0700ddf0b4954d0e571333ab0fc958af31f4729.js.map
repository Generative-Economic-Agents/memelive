{"version":3,"sources":["file:///Users/feiwang/workSpace/AITown/cutepet/assets/src/game/scene/SceneManager.ts"],"names":["SceneManager","Node","Vec3","ObjDictionary","mGameConfig","Camera2D","LayerEnum","camera","_camera","scene","_scene","constructor","_layer_map","_layer_actor","_layer_effect","_layer_tip","_layer_debug","_layerDic","init","init2dScene","getChildByPath","active","IsDebug","add","MapLayer","ActorLayer","EffectLayer","DebugLayer","addToLayer","spr","layer","posX","posY","layerSpr","get","addChild","setPosition","console","log","getLayer","update","instance","_instance"],"mappings":"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","sourcesContent":["import { Component, Node, Sprite, Vec3 } from \"cc\";\nimport ObjDictionary from \"../../core/dataStructue/ObjDictionary\";\nimport mGameConfig from \"../../utils/MGameConfig\";\nimport Camera2D from \"./Camera2D\";\nimport LayerEnum from \"./LayerEnum\";\n\nexport default class SceneManager\n{\n\t\n\tprivate _camera:Camera2D;\n\tpublic get camera():Camera2D\n\t{\n\t\treturn this._camera;\n\t}\n\t\n\t\n\tprivate _scene:Node;\n\tpublic get scene():Node\n\t{\n\t\treturn this._scene;\n\t}\n\t\n\n\tprivate _layer_map:Node;\n\t\n\tprivate _layer_actor:Node;\n\t\n\tprivate _layer_effect:Node;\n\t\n\tprivate _layer_tip:Node;\n\t\n\tprivate _layer_debug:Node;\n\t\n\tprivate _layerDic:ObjDictionary;\n\t\n\tpublic constructor()\n\t{\n\n\t}\n\t\n\tpublic init():void\n\t{\n\t\t// this.init2dScene();\n\t\t//Laya.stage.scrollRect = new Rectangle(0, 0, mGameConfig.DeviceW, mGameConfig.DeviceH); \n\t}\n\t\n\tpublic init2dScene(scene:Node):void\n\t{\n\t\tthis._scene = scene;\n\t\tthis._layer_map = this._scene.getChildByPath(\"_layer_map\");\n\t\tthis._layer_actor =  this._scene.getChildByPath(\"_layer_actor\");\n\t\tthis._layer_effect =  this._scene.getChildByPath(\"_layer_effect\");\n\t\tthis._layer_debug =  this._scene.getChildByPath(\"_layer_debug\");\n\t\t// this._layer_tip =  this._scene.getChildByPath(\"_layer_tip\");\n        \n\t\tthis._layer_debug.active = mGameConfig.IsDebug;\n\t\tthis._layerDic = new ObjDictionary(Node);\n\t\tthis._layerDic.add(LayerEnum.MapLayer, this._layer_map);\n\t\tthis._layerDic.add(LayerEnum.ActorLayer, this._layer_actor);\n\t\tthis._layerDic.add(LayerEnum.EffectLayer, this._layer_effect);\n\t\tthis._layerDic.add(LayerEnum.DebugLayer, this._layer_debug);\n\t\t// this._layerDic.add(LayerEnum.TipLayer, this._layer_tip);\n\t\t\n\t\tthis._camera = new Camera2D(this._scene);\n\t}\n\t\n\t\n\t\n\n\t// public showAutoPlayerAni():void\n\t// {\n\t// \tlet ani:Laya.Animation = new Laya.Animation();\n\t// \tani.loadImages([\"ui_main/ui_auto_01.png\",\"ui_main/ui_auto_02.png\",\"ui_main/ui_auto_03.png\",\"ui_main/ui_auto_04.png\"]);\n\t// \tani.pos((mGameConfig.DeviceW>>1)-100, (mGameConfig.DeviceH>>1) + 200);\n\t// \tLaya.stage.addChild(ani);\n\t// \tani.interval = 250;\n\t// \tani.play();\n\t// }\n\t\n\tpublic addToLayer(spr:Node, layer:String=LayerEnum.MapLayer, posX:number=0, posY:number=0):void\n\t{\n\t\tlet layerSpr:Node = this._layerDic.get(layer) as Node;\n\t\tif(layerSpr)\n\t\t{\n\t\t\tlayerSpr.addChild(spr);\n            spr.setPosition(new Vec3(posX,posY,0));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconsole.log(\"can not find layer \" + layer);\t\t\t\t\n\t\t}\n\t}\n\t\n\tpublic getLayer(layer:string):Node\n\t{\n\t\treturn  this._layerDic.get(layer);\n\t}\n\t\n\n\t// public getGlobalScreenPos():Point\n\t// {\n\t// \tif(this._scene)\n\t// \t\treturn this._scene.localToGlobal(new Point(this._scene.mouseX, this._scene.mouseY));\n\t// \telse\n\t// \t\treturn new Point();\n\t// }\n\t\n\t// public getMousePos():Point\n\t// {\n\t// \tif(this._scene)\n\t// \t\treturn new Point(this._scene.mouseX, this._scene.mouseY);\n\t// \telse\n\t// \t\treturn new Point();\n\t// }\n\t\n\tpublic update():void\n\t{\n\t\tif(this._camera)\n\t\t\tthis._camera.update();\n\t}\n\t\n\tprivate static _instance:SceneManager\n\tpublic static get instance():SceneManager\n\t{\n\t\tif(!this._instance){ this._instance = new SceneManager(); }\n\t\treturn this._instance;\n\t}\n\t\n}"]}