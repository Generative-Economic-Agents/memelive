{"version":3,"sources":["file:///Users/feiwang/cutepet/node_modules/oauth-sign/index.js"],"names":["_cjsLoader","_req","__cjsMetaURL","url","define","exports","require","module","__filename","__dirname","crypto","sha","key","body","algorithm","createHmac","update","digest","rsa","createSign","sign","rfc3986","str","encodeURIComponent","replace","map","obj","val","arr","Array","isArray","i","length","push","prop","compare","a","b","generateBase","httpMethod","base_uri","params","normalized","p","sort","join","base","toUpperCase","hmacsign","consumer_secret","token_secret","hmacsign256","rsasign","private_key","plaintext","signMethod","method","skipArgs","Error","apply","slice","call","arguments","_cjsExports","_hmacsign","_hmacsign256","_rsasign","_plaintext","_sign","_rfc3986","_generateBase"],"mappings":"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","sourcesContent":["import _cjsLoader from 'cce:/internal/ml/cjs-loader.mjs';\nimport { __cjsMetaURL as _req} from 'crypto';\nlet _cjsExports;\nlet _hmacsign;\nlet _hmacsign256;\nlet _rsasign;\nlet _plaintext;\nlet _sign;\nlet _rfc3986;\nlet _generateBase;\nconst __cjsMetaURL = import.meta.url;\n_cjsLoader.define(__cjsMetaURL, function (exports, require, module, __filename, __dirname) {\n// #region ORIGINAL CODE\n\n\n var crypto = require('crypto')\n\n function sha (key, body, algorithm) {\n   return crypto.createHmac(algorithm, key).update(body).digest('base64')\n }\n\n function rsa (key, body) {\n   return crypto.createSign('RSA-SHA1').update(body).sign(key, 'base64')\n }\n\n function rfc3986 (str) {\n   return encodeURIComponent(str)\n     .replace(/!/g,'%21')\n     .replace(/\\*/g,'%2A')\n     .replace(/\\(/g,'%28')\n     .replace(/\\)/g,'%29')\n     .replace(/'/g,'%27')\n }\n\n // Maps object to bi-dimensional array\n // Converts { foo: 'A', bar: [ 'b', 'B' ]} to\n // [ ['foo', 'A'], ['bar', 'b'], ['bar', 'B'] ]\n function map (obj) {\n   var key, val, arr = []\n   for (key in obj) {\n     val = obj[key]\n     if (Array.isArray(val))\n       for (var i = 0; i < val.length; i++)\n         arr.push([key, val[i]])\n     else if (typeof val === 'object')\n       for (var prop in val)\n         arr.push([key + '[' + prop + ']', val[prop]])\n     else\n       arr.push([key, val])\n   }\n   return arr\n }\n\n // Compare function for sort\n function compare (a, b) {\n   return a > b ? 1 : a < b ? -1 : 0\n }\n\n function generateBase (httpMethod, base_uri, params) {\n   // adapted from https://dev.twitter.com/docs/auth/oauth and \n   // https://dev.twitter.com/docs/auth/creating-signature\n\n   // Parameter normalization\n   // http://tools.ietf.org/html/rfc5849#section-3.4.1.3.2\n   var normalized = map(params)\n   // 1.  First, the name and value of each parameter are encoded\n   .map(function (p) {\n     return [ rfc3986(p[0]), rfc3986(p[1] || '') ]\n   })\n   // 2.  The parameters are sorted by name, using ascending byte value\n   //     ordering.  If two or more parameters share the same name, they\n   //     are sorted by their value.\n   .sort(function (a, b) {\n     return compare(a[0], b[0]) || compare(a[1], b[1])\n   })\n   // 3.  The name of each parameter is concatenated to its corresponding\n   //     value using an \"=\" character (ASCII code 61) as a separator, even\n   //     if the value is empty.\n   .map(function (p) { return p.join('=') })\n    // 4.  The sorted name/value pairs are concatenated together into a\n    //     single string by using an \"&\" character (ASCII code 38) as\n    //     separator.\n   .join('&')\n\n   var base = [\n     rfc3986(httpMethod ? httpMethod.toUpperCase() : 'GET'),\n     rfc3986(base_uri),\n     rfc3986(normalized)\n   ].join('&')\n\n   return base\n }\n\n function hmacsign (httpMethod, base_uri, params, consumer_secret, token_secret) {\n   var base = generateBase(httpMethod, base_uri, params)\n   var key = [\n     consumer_secret || '',\n     token_secret || ''\n   ].map(rfc3986).join('&')\n\n   return sha(key, base, 'sha1')\n }\n\n function hmacsign256 (httpMethod, base_uri, params, consumer_secret, token_secret) {\n   var base = generateBase(httpMethod, base_uri, params)\n   var key = [\n     consumer_secret || '',\n     token_secret || ''\n   ].map(rfc3986).join('&')\n\n   return sha(key, base, 'sha256')\n }\n\n function rsasign (httpMethod, base_uri, params, private_key, token_secret) {\n   var base = generateBase(httpMethod, base_uri, params)\n   var key = private_key || ''\n\n   return rsa(key, base)\n }\n\n function plaintext (consumer_secret, token_secret) {\n   var key = [\n     consumer_secret || '',\n     token_secret || ''\n   ].map(rfc3986).join('&')\n\n   return key\n }\n\n function sign (signMethod, httpMethod, base_uri, params, consumer_secret, token_secret) {\n   var method\n   var skipArgs = 1\n\n   switch (signMethod) {\n     case 'RSA-SHA1':\n       method = rsasign\n       break\n     case 'HMAC-SHA1':\n       method = hmacsign\n       break\n     case 'HMAC-SHA256':\n       method = hmacsign256\n       break\n     case 'PLAINTEXT':\n       method = plaintext\n       skipArgs = 4\n       break\n     default:\n      throw new Error('Signature method not supported: ' + signMethod)\n   }\n\n   return method.apply(null, [].slice.call(arguments, skipArgs))\n }\n\n exports.hmacsign = hmacsign\n exports.hmacsign256 = hmacsign256\n exports.rsasign = rsasign\n exports.plaintext = plaintext\n exports.sign = sign\n exports.rfc3986 = rfc3986\n exports.generateBase = generateBase\n\n// #endregion ORIGINAL CODE\n\n_cjsExports = module.exports;\n_hmacsign = module.exports.hmacsign;\n_hmacsign256 = module.exports.hmacsign256;\n_rsasign = module.exports.rsasign;\n_plaintext = module.exports.plaintext;\n_sign = module.exports.sign;\n_rfc3986 = module.exports.rfc3986;\n_generateBase = module.exports.generateBase;\n\n}, () => ({\n  'crypto': _req,\n}));\nexport { _cjsExports as default };\nexport { __cjsMetaURL }\n"]}