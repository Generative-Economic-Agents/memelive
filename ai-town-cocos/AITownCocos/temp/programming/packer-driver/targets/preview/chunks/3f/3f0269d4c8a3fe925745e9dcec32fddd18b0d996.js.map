{"version":3,"sources":["file:///Users/feiwang/cutepet/node_modules/asn1/lib/ber/writer.js"],"names":["_cjsLoader","_req","__cjsMetaURL","_req0","_req1","_req2","url","define","exports","require","module","__filename","__dirname","assert","Buffer","ASN1","errors","newInvalidAsn1Error","DEFAULT_OPTS","size","growthFactor","merge","from","to","ok","equal","keys","Object","getOwnPropertyNames","forEach","key","value","getOwnPropertyDescriptor","defineProperty","Writer","options","_buf","alloc","_size","length","_offset","_options","_seq","prototype","get","slice","writeByte","b","TypeError","_ensure","writeInt","i","tag","Integer","sz","writeNull","Null","writeEnumeration","Enumeration","writeBoolean","Boolean","writeString","s","OctetString","len","byteLength","writeLength","write","writeBuffer","buf","isBuffer","copy","writeStringArray","strings","Array","self","writeOID","OID","test","Error","encodeOctet","bytes","octet","push","tmp","split","parseInt","startSequence","Sequence","Constructor","endSequence","seq","pop","start","_shift","shift","undefined","_cjsExports"],"mappings":"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","sourcesContent":["import _cjsLoader from 'cce:/internal/ml/cjs-loader.mjs';\nimport { __cjsMetaURL as _req} from 'assert';\nimport { __cjsMetaURL as _req0} from 'safer-buffer';\nimport { __cjsMetaURL as _req1} from './types';\nimport { __cjsMetaURL as _req2} from './errors';\nlet _cjsExports;\nconst __cjsMetaURL = import.meta.url;\n_cjsLoader.define(__cjsMetaURL, function (exports, require, module, __filename, __dirname) {\n// #region ORIGINAL CODE\n\n\n // Copyright 2011 Mark Cavage <mcavage@gmail.com> All rights reserved.\n\n var assert = require('assert');\n var Buffer = require('safer-buffer').Buffer;\n var ASN1 = require('./types');\n var errors = require('./errors');\n\n\n // --- Globals\n\n var newInvalidAsn1Error = errors.newInvalidAsn1Error;\n\n var DEFAULT_OPTS = {\n   size: 1024,\n   growthFactor: 8\n };\n\n\n // --- Helpers\n\n function merge(from, to) {\n   assert.ok(from);\n   assert.equal(typeof (from), 'object');\n   assert.ok(to);\n   assert.equal(typeof (to), 'object');\n\n   var keys = Object.getOwnPropertyNames(from);\n   keys.forEach(function (key) {\n     if (to[key])\n       return;\n\n     var value = Object.getOwnPropertyDescriptor(from, key);\n     Object.defineProperty(to, key, value);\n   });\n\n   return to;\n }\n\n\n\n // --- API\n\n function Writer(options) {\n   options = merge(DEFAULT_OPTS, options || {});\n\n   this._buf = Buffer.alloc(options.size || 1024);\n   this._size = this._buf.length;\n   this._offset = 0;\n   this._options = options;\n\n   // A list of offsets in the buffer where we need to insert\n   // sequence tag/len pairs.\n   this._seq = [];\n }\n\n Object.defineProperty(Writer.prototype, 'buffer', {\n   get: function () {\n     if (this._seq.length)\n       throw newInvalidAsn1Error(this._seq.length + ' unended sequence(s)');\n\n     return (this._buf.slice(0, this._offset));\n   }\n });\n\n Writer.prototype.writeByte = function (b) {\n   if (typeof (b) !== 'number')\n     throw new TypeError('argument must be a Number');\n\n   this._ensure(1);\n   this._buf[this._offset++] = b;\n };\n\n\n Writer.prototype.writeInt = function (i, tag) {\n   if (typeof (i) !== 'number')\n     throw new TypeError('argument must be a Number');\n   if (typeof (tag) !== 'number')\n     tag = ASN1.Integer;\n\n   var sz = 4;\n\n   while ((((i & 0xff800000) === 0) || ((i & 0xff800000) === 0xff800000 >> 0)) &&\n         (sz > 1)) {\n     sz--;\n     i <<= 8;\n   }\n\n   if (sz > 4)\n     throw newInvalidAsn1Error('BER ints cannot be > 0xffffffff');\n\n   this._ensure(2 + sz);\n   this._buf[this._offset++] = tag;\n   this._buf[this._offset++] = sz;\n\n   while (sz-- > 0) {\n     this._buf[this._offset++] = ((i & 0xff000000) >>> 24);\n     i <<= 8;\n   }\n\n };\n\n\n Writer.prototype.writeNull = function () {\n   this.writeByte(ASN1.Null);\n   this.writeByte(0x00);\n };\n\n\n Writer.prototype.writeEnumeration = function (i, tag) {\n   if (typeof (i) !== 'number')\n     throw new TypeError('argument must be a Number');\n   if (typeof (tag) !== 'number')\n     tag = ASN1.Enumeration;\n\n   return this.writeInt(i, tag);\n };\n\n\n Writer.prototype.writeBoolean = function (b, tag) {\n   if (typeof (b) !== 'boolean')\n     throw new TypeError('argument must be a Boolean');\n   if (typeof (tag) !== 'number')\n     tag = ASN1.Boolean;\n\n   this._ensure(3);\n   this._buf[this._offset++] = tag;\n   this._buf[this._offset++] = 0x01;\n   this._buf[this._offset++] = b ? 0xff : 0x00;\n };\n\n\n Writer.prototype.writeString = function (s, tag) {\n   if (typeof (s) !== 'string')\n     throw new TypeError('argument must be a string (was: ' + typeof (s) + ')');\n   if (typeof (tag) !== 'number')\n     tag = ASN1.OctetString;\n\n   var len = Buffer.byteLength(s);\n   this.writeByte(tag);\n   this.writeLength(len);\n   if (len) {\n     this._ensure(len);\n     this._buf.write(s, this._offset);\n     this._offset += len;\n   }\n };\n\n\n Writer.prototype.writeBuffer = function (buf, tag) {\n   if (typeof (tag) !== 'number')\n     throw new TypeError('tag must be a number');\n   if (!Buffer.isBuffer(buf))\n     throw new TypeError('argument must be a buffer');\n\n   this.writeByte(tag);\n   this.writeLength(buf.length);\n   this._ensure(buf.length);\n   buf.copy(this._buf, this._offset, 0, buf.length);\n   this._offset += buf.length;\n };\n\n\n Writer.prototype.writeStringArray = function (strings) {\n   if ((!strings instanceof Array))\n     throw new TypeError('argument must be an Array[String]');\n\n   var self = this;\n   strings.forEach(function (s) {\n     self.writeString(s);\n   });\n };\n\n // This is really to solve DER cases, but whatever for now\n Writer.prototype.writeOID = function (s, tag) {\n   if (typeof (s) !== 'string')\n     throw new TypeError('argument must be a string');\n   if (typeof (tag) !== 'number')\n     tag = ASN1.OID;\n\n   if (!/^([0-9]+\\.){3,}[0-9]+$/.test(s))\n     throw new Error('argument is not a valid OID string');\n\n   function encodeOctet(bytes, octet) {\n     if (octet < 128) {\n         bytes.push(octet);\n     } else if (octet < 16384) {\n         bytes.push((octet >>> 7) | 0x80);\n         bytes.push(octet & 0x7F);\n     } else if (octet < 2097152) {\n       bytes.push((octet >>> 14) | 0x80);\n       bytes.push(((octet >>> 7) | 0x80) & 0xFF);\n       bytes.push(octet & 0x7F);\n     } else if (octet < 268435456) {\n       bytes.push((octet >>> 21) | 0x80);\n       bytes.push(((octet >>> 14) | 0x80) & 0xFF);\n       bytes.push(((octet >>> 7) | 0x80) & 0xFF);\n       bytes.push(octet & 0x7F);\n     } else {\n       bytes.push(((octet >>> 28) | 0x80) & 0xFF);\n       bytes.push(((octet >>> 21) | 0x80) & 0xFF);\n       bytes.push(((octet >>> 14) | 0x80) & 0xFF);\n       bytes.push(((octet >>> 7) | 0x80) & 0xFF);\n       bytes.push(octet & 0x7F);\n     }\n   }\n\n   var tmp = s.split('.');\n   var bytes = [];\n   bytes.push(parseInt(tmp[0], 10) * 40 + parseInt(tmp[1], 10));\n   tmp.slice(2).forEach(function (b) {\n     encodeOctet(bytes, parseInt(b, 10));\n   });\n\n   var self = this;\n   this._ensure(2 + bytes.length);\n   this.writeByte(tag);\n   this.writeLength(bytes.length);\n   bytes.forEach(function (b) {\n     self.writeByte(b);\n   });\n };\n\n\n Writer.prototype.writeLength = function (len) {\n   if (typeof (len) !== 'number')\n     throw new TypeError('argument must be a Number');\n\n   this._ensure(4);\n\n   if (len <= 0x7f) {\n     this._buf[this._offset++] = len;\n   } else if (len <= 0xff) {\n     this._buf[this._offset++] = 0x81;\n     this._buf[this._offset++] = len;\n   } else if (len <= 0xffff) {\n     this._buf[this._offset++] = 0x82;\n     this._buf[this._offset++] = len >> 8;\n     this._buf[this._offset++] = len;\n   } else if (len <= 0xffffff) {\n     this._buf[this._offset++] = 0x83;\n     this._buf[this._offset++] = len >> 16;\n     this._buf[this._offset++] = len >> 8;\n     this._buf[this._offset++] = len;\n   } else {\n     throw newInvalidAsn1Error('Length too long (> 4 bytes)');\n   }\n };\n\n Writer.prototype.startSequence = function (tag) {\n   if (typeof (tag) !== 'number')\n     tag = ASN1.Sequence | ASN1.Constructor;\n\n   this.writeByte(tag);\n   this._seq.push(this._offset);\n   this._ensure(3);\n   this._offset += 3;\n };\n\n\n Writer.prototype.endSequence = function () {\n   var seq = this._seq.pop();\n   var start = seq + 3;\n   var len = this._offset - start;\n\n   if (len <= 0x7f) {\n     this._shift(start, len, -2);\n     this._buf[seq] = len;\n   } else if (len <= 0xff) {\n     this._shift(start, len, -1);\n     this._buf[seq] = 0x81;\n     this._buf[seq + 1] = len;\n   } else if (len <= 0xffff) {\n     this._buf[seq] = 0x82;\n     this._buf[seq + 1] = len >> 8;\n     this._buf[seq + 2] = len;\n   } else if (len <= 0xffffff) {\n     this._shift(start, len, 1);\n     this._buf[seq] = 0x83;\n     this._buf[seq + 1] = len >> 16;\n     this._buf[seq + 2] = len >> 8;\n     this._buf[seq + 3] = len;\n   } else {\n     throw newInvalidAsn1Error('Sequence too long');\n   }\n };\n\n\n Writer.prototype._shift = function (start, len, shift) {\n   assert.ok(start !== undefined);\n   assert.ok(len !== undefined);\n   assert.ok(shift);\n\n   this._buf.copy(this._buf, start + shift, start, start + len);\n   this._offset += shift;\n };\n\n Writer.prototype._ensure = function (len) {\n   assert.ok(len);\n\n   if (this._size - this._offset < len) {\n     var sz = this._size * this._options.growthFactor;\n     if (sz - this._offset < len)\n       sz += len;\n\n     var buf = Buffer.alloc(sz);\n\n     this._buf.copy(buf, 0, 0, this._offset);\n     this._buf = buf;\n     this._size = sz;\n   }\n };\n\n\n\n // --- Exported API\n\n module.exports = Writer;\n\n\n// #endregion ORIGINAL CODE\n\n_cjsExports = module.exports;\n\n\n}, () => ({\n  'assert': _req,\n  'safer-buffer': _req0,\n  './types': _req1,\n  './errors': _req2,\n}));\nexport { _cjsExports as default };\nexport { __cjsMetaURL }\n"]}