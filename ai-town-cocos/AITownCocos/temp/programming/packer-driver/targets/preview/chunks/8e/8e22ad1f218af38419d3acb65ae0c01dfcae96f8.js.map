{"version":3,"sources":["file:///Users/feiwang/cutepet/node_modules/request/lib/oauth.js"],"names":["_cjsLoader","_req","__cjsMetaURL","_req0","_req1","_req2","_req3","_req4","_req5","url","define","exports","require","module","__filename","__dirname","qs","caseless","uuid","oauth","crypto","Buffer","OAuth","request","params","prototype","buildParams","_oauth","uri","method","query","form","qsLib","oa","i","oauth_version","oauth_timestamp","Math","floor","Date","now","toString","oauth_nonce","replace","oauth_signature_method","consumer_secret_or_private_key","oauth_consumer_secret","oauth_private_key","token_secret","oauth_token_secret","realm","oauth_realm","oauth_transport_method","baseurl","protocol","host","pathname","parse","concat","stringify","join","oauth_signature","sign","buildBodyHash","body","indexOf","signature_method","emit","Error","shasum","createHash","update","sha1","digest","from","concatParams","sep","wrap","Object","keys","filter","sort","splice","push","map","rfc3986","onRequest","self","headers","contentType","get","formContentType","transport","transport_method","slice","length","body_hash","setHeader","href","path","_cjsExports","_OAuth"],"mappings":"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","sourcesContent":["import _cjsLoader from 'cce:/internal/ml/cjs-loader.mjs';\nimport { __cjsMetaURL as _req} from 'url';\nimport { __cjsMetaURL as _req0} from 'qs';\nimport { __cjsMetaURL as _req1} from 'caseless';\nimport { __cjsMetaURL as _req2} from 'uuid/v4';\nimport { __cjsMetaURL as _req3} from 'oauth-sign';\nimport { __cjsMetaURL as _req4} from 'crypto';\nimport { __cjsMetaURL as _req5} from 'safe-buffer';\nlet _cjsExports;\nlet _OAuth;\nconst __cjsMetaURL = import.meta.url;\n_cjsLoader.define(__cjsMetaURL, function (exports, require, module, __filename, __dirname) {\n// #region ORIGINAL CODE\n\n\n 'use strict'\n\n var url = require('url')\n var qs = require('qs')\n var caseless = require('caseless')\n var uuid = require('uuid/v4')\n var oauth = require('oauth-sign')\n var crypto = require('crypto')\n var Buffer = require('safe-buffer').Buffer\n\n function OAuth (request) {\n   this.request = request\n   this.params = null\n }\n\n OAuth.prototype.buildParams = function (_oauth, uri, method, query, form, qsLib) {\n   var oa = {}\n   for (var i in _oauth) {\n     oa['oauth_' + i] = _oauth[i]\n   }\n   if (!oa.oauth_version) {\n     oa.oauth_version = '1.0'\n   }\n   if (!oa.oauth_timestamp) {\n     oa.oauth_timestamp = Math.floor(Date.now() / 1000).toString()\n   }\n   if (!oa.oauth_nonce) {\n     oa.oauth_nonce = uuid().replace(/-/g, '')\n   }\n   if (!oa.oauth_signature_method) {\n     oa.oauth_signature_method = 'HMAC-SHA1'\n   }\n\n   var consumer_secret_or_private_key = oa.oauth_consumer_secret || oa.oauth_private_key // eslint-disable-line camelcase\n   delete oa.oauth_consumer_secret\n   delete oa.oauth_private_key\n\n   var token_secret = oa.oauth_token_secret // eslint-disable-line camelcase\n   delete oa.oauth_token_secret\n\n   var realm = oa.oauth_realm\n   delete oa.oauth_realm\n   delete oa.oauth_transport_method\n\n   var baseurl = uri.protocol + '//' + uri.host + uri.pathname\n   var params = qsLib.parse([].concat(query, form, qsLib.stringify(oa)).join('&'))\n\n   oa.oauth_signature = oauth.sign(\n     oa.oauth_signature_method,\n     method,\n     baseurl,\n     params,\n     consumer_secret_or_private_key, // eslint-disable-line camelcase\n     token_secret // eslint-disable-line camelcase\n   )\n\n   if (realm) {\n     oa.realm = realm\n   }\n\n   return oa\n }\n\n OAuth.prototype.buildBodyHash = function (_oauth, body) {\n   if (['HMAC-SHA1', 'RSA-SHA1'].indexOf(_oauth.signature_method || 'HMAC-SHA1') < 0) {\n     this.request.emit('error', new Error('oauth: ' + _oauth.signature_method +\n       ' signature_method not supported with body_hash signing.'))\n   }\n\n   var shasum = crypto.createHash('sha1')\n   shasum.update(body || '')\n   var sha1 = shasum.digest('hex')\n\n   return Buffer.from(sha1, 'hex').toString('base64')\n }\n\n OAuth.prototype.concatParams = function (oa, sep, wrap) {\n   wrap = wrap || ''\n\n   var params = Object.keys(oa).filter(function (i) {\n     return i !== 'realm' && i !== 'oauth_signature'\n   }).sort()\n\n   if (oa.realm) {\n     params.splice(0, 0, 'realm')\n   }\n   params.push('oauth_signature')\n\n   return params.map(function (i) {\n     return i + '=' + wrap + oauth.rfc3986(oa[i]) + wrap\n   }).join(sep)\n }\n\n OAuth.prototype.onRequest = function (_oauth) {\n   var self = this\n   self.params = _oauth\n\n   var uri = self.request.uri || {}\n   var method = self.request.method || ''\n   var headers = caseless(self.request.headers)\n   var body = self.request.body || ''\n   var qsLib = self.request.qsLib || qs\n\n   var form\n   var query\n   var contentType = headers.get('content-type') || ''\n   var formContentType = 'application/x-www-form-urlencoded'\n   var transport = _oauth.transport_method || 'header'\n\n   if (contentType.slice(0, formContentType.length) === formContentType) {\n     contentType = formContentType\n     form = body\n   }\n   if (uri.query) {\n     query = uri.query\n   }\n   if (transport === 'body' && (method !== 'POST' || contentType !== formContentType)) {\n     self.request.emit('error', new Error('oauth: transport_method of body requires POST ' +\n       'and content-type ' + formContentType))\n   }\n\n   if (!form && typeof _oauth.body_hash === 'boolean') {\n     _oauth.body_hash = self.buildBodyHash(_oauth, self.request.body.toString())\n   }\n\n   var oa = self.buildParams(_oauth, uri, method, query, form, qsLib)\n\n   switch (transport) {\n     case 'header':\n       self.request.setHeader('Authorization', 'OAuth ' + self.concatParams(oa, ',', '\"'))\n       break\n\n     case 'query':\n       var href = self.request.uri.href += (query ? '&' : '?') + self.concatParams(oa, '&')\n       self.request.uri = url.parse(href)\n       self.request.path = self.request.uri.path\n       break\n\n     case 'body':\n       self.request.body = (form ? form + '&' : '') + self.concatParams(oa, '&')\n       break\n\n     default:\n       self.request.emit('error', new Error('oauth: transport_method invalid'))\n   }\n }\n\n exports.OAuth = OAuth\n\n\n// #endregion ORIGINAL CODE\n\n_cjsExports = module.exports;\n_OAuth = module.exports.OAuth;\n\n}, () => ({\n  'url': _req,\n  'qs': _req0,\n  'caseless': _req1,\n  'uuid/v4': _req2,\n  'oauth-sign': _req3,\n  'crypto': _req4,\n  'safe-buffer': _req5,\n}));\nexport { _cjsExports as default };\nexport { __cjsMetaURL }\n"]}