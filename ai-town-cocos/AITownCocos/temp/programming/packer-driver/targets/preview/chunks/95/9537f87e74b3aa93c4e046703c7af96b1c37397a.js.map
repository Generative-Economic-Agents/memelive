{"version":3,"sources":["file:///Users/feiwang/AITown/AITownCocos/assets/src/town/touch.ts"],"names":["_decorator","Component","Node","ScrollView","Vec2","GlobalConfig","ccclass","property","touch","npcIndex","start","node","on","EventType","TOUCH_START","event","scroll","scrollNode","getComponent","TOUCH_END","startPos","getStartLocation","prePos","getPreviousLocation","Math","abs","y","x","scrollToOffset","getScrollOffset","console","log","canvas","scale","setScale","scrollEvent","data","preOffset","curOffset","instance","currentNpcIndex","scrollUp","scrollDown","scrollLeft","scrollRight","update","deltaTime"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAuBC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,U,OAAAA,U;AAAyBC,MAAAA,I,OAAAA,I;;AAClEC,MAAAA,Y,iBAAAA,Y;;;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBP,U;;uBAGjBQ,K,WADZF,OAAO,CAAC,OAAD,C,UAEHC,QAAQ,CAACL,IAAD,C,UAGRK,QAAQ,CAACL,IAAD,C,2BALb,MACaM,KADb,SAC2BP,SAD3B,CACqC;AAAA;AAAA;;AAAA;;AAAA;;AAAA,eAOjCQ,QAPiC,GAOd,CAPc;AAAA;;AAQjCC,QAAAA,KAAK,GAAG;AACJ,eAAKC,IAAL,CAAUC,EAAV,CAAaV,IAAI,CAACW,SAAL,CAAeC,WAA5B,EAA0CC,KAAD,IAAS;AAC9C,gBAAMC,MAAM,GAAG,KAAKC,UAAL,CAAgBC,YAAhB,CAA6Bf,UAA7B,CAAf;AAEH,WAHD;AAKA,eAAKQ,IAAL,CAAUC,EAAV,CAAaV,IAAI,CAACW,SAAL,CAAeM,SAA5B,EAAwCJ,KAAD,IAAqB;AACxD,gBAAMK,QAAQ,GAAGL,KAAK,CAACP,KAAN,CAAYa,gBAAZ,EAAjB;AACA,gBAAMC,MAAM,GAAGP,KAAK,CAACP,KAAN,CAAYe,mBAAZ,EAAf;;AACA,gBAAGC,IAAI,CAACC,GAAL,CAASL,QAAQ,CAACM,CAAT,GAAaJ,MAAM,CAACI,CAA7B,IAAmCF,IAAI,CAACC,GAAL,CAASL,QAAQ,CAACO,CAAT,GAAaL,MAAM,CAACK,CAA7B,CAAtC,EAAsE;AAClE,kBAAGP,QAAQ,CAACM,CAAT,GAAaJ,MAAM,CAACI,CAAvB,EAAyB;AACrB,oBAAMV,MAAM,GAAG,KAAKC,UAAL,CAAgBC,YAAhB,CAA6Bf,UAA7B,CAAf;AACAa,gBAAAA,MAAM,CAACY,cAAP,CAAsB,IAAIxB,IAAJ,CAASY,MAAM,CAACa,eAAP,GAAyBF,CAAlC,EAAoCX,MAAM,CAACa,eAAP,GAAyBH,CAAzB,GAA6B,GAAjE,CAAtB,EAA6F,CAA7F,EAAgG,IAAhG;AACH;;AACD,kBAAGN,QAAQ,CAACM,CAAT,GAAaJ,MAAM,CAACI,CAAvB,EAAyB;AACrB,oBAAMV,OAAM,GAAG,KAAKC,UAAL,CAAgBC,YAAhB,CAA6Bf,UAA7B,CAAf;;AACAa,gBAAAA,OAAM,CAACY,cAAP,CAAsB,IAAIxB,IAAJ,CAASY,OAAM,CAACa,eAAP,GAAyBF,CAAlC,EAAoCX,OAAM,CAACa,eAAP,GAAyBH,CAAzB,GAA6B,GAAjE,CAAtB,EAA6F,CAA7F,EAAgG,IAAhG;AACH;AACJ,aATD,MASK;AACD,kBAAGN,QAAQ,CAACO,CAAT,GAAaL,MAAM,CAACK,CAAvB,EAAyB;AACrBG,gBAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ;;AACA,oBAAG,KAAKC,MAAL,CAAYC,KAAZ,CAAkBN,CAAlB,KAAwB,CAA3B,EAA6B;AACzB,uBAAKK,MAAL,CAAYE,QAAZ,CAAqB,CAArB,EAAuB,CAAvB;AACH;AACJ;;AACD,kBAAGd,QAAQ,CAACO,CAAT,GAAaL,MAAM,CAACK,CAAvB,EAAyB;AACrBG,gBAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ;;AACA,oBAAG,KAAKC,MAAL,CAAYC,KAAZ,CAAkBN,CAAlB,KAAwB,CAA3B,EAA6B;AACzB,uBAAKK,MAAL,CAAYE,QAAZ,CAAqB,CAArB,EAAuB,CAAvB;AACH;AACJ;AACJ;AACJ,WA1BD;AA2BH;;AAEDC,QAAAA,WAAW,CAACpB,KAAD,EAAQqB,IAAR,EAAa;AACpB,cAAIC,SAAJ;AACA,cAAIC,SAAJ;;AACA,cAAGF,IAAI,KAAK,EAAZ,EAAe;AACX,gBAAMpB,MAAM,GAAG,KAAKC,UAAL,CAAgBC,YAAhB,CAA6Bf,UAA7B,CAAf;AACAkC,YAAAA,SAAS,GAAGrB,MAAM,CAACa,eAAP,GAAyBH,CAArC;AACAI,YAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ,EAAoBf,MAAM,CAACa,eAAP,GAAyBH,CAA7C;AACH;;AAED,cAAGU,IAAI,KAAK,CAAZ,EAAc;AACV,gBAAMpB,QAAM,GAAG,KAAKC,UAAL,CAAgBC,YAAhB,CAA6Bf,UAA7B,CAAf;;AACAmC,YAAAA,SAAS,GAAGtB,QAAM,CAACa,eAAP,GAAyBH,CAArC;AACAI,YAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ,EAAoBf,QAAM,CAACa,eAAP,GAAyBH,CAA7C;AACH;;AACD,cAAGW,SAAS,GAAGC,SAAf,EAAyB;AACrB;AAAA;AAAA,8CAAaC,QAAb,CAAsBC,eAAtB,GAAwC;AAAA;AAAA,8CAAaD,QAAb,CAAsBC,eAAtB,GAAwC,CAAhF;AACA,iBAAK/B,QAAL,GAAgB;AAAA;AAAA,8CAAa8B,QAAb,CAAsBC,eAAtC;AACH,WAHD,MAGK;AACD;AAAA;AAAA,8CAAaD,QAAb,CAAsBC,eAAtB,GAAwC;AAAA;AAAA,8CAAaD,QAAb,CAAsBC,eAAtB,GAAwC,CAAhF;AACA,iBAAK/B,QAAL,GAAgB;AAAA;AAAA,8CAAa8B,QAAb,CAAsBC,eAAtC;AACH;AACJ;;AAEDC,QAAAA,QAAQ,GAAE,CAET;;AAEDC,QAAAA,UAAU,GAAE,CAEX;;AAEDC,QAAAA,UAAU,GAAE,CAEX;;AAEDC,QAAAA,WAAW,GAAE,CAEZ;;AAEDC,QAAAA,MAAM,CAACC,SAAD,EAAoB,CAEzB;;AApFgC,O","sourcesContent":["import { _decorator, Component, EventTouch, Node, ScrollView, SystemEvent, Vec2, Vec3 } from 'cc';\nimport { GlobalConfig } from '../game/config/GlobalConfig';\nconst { ccclass, property } = _decorator;\n\n@ccclass('touch')\nexport class touch extends Component {\n    @property(Node)\n    scrollNode: Node\n\n    @property(Node)\n    canvas: Node\n\n    npcIndex: number = 0\n    start() {\n        this.node.on(Node.EventType.TOUCH_START, (event)=>{\n            const scroll = this.scrollNode.getComponent(ScrollView)\n\n        })\n\n        this.node.on(Node.EventType.TOUCH_END, (event: EventTouch)=>{\n            const startPos = event.touch.getStartLocation()\n            const prePos = event.touch.getPreviousLocation()\n            if(Math.abs(startPos.y - prePos.y) >  Math.abs(startPos.x - prePos.x)){\n                if(startPos.y > prePos.y){\n                    const scroll = this.scrollNode.getComponent(ScrollView)\n                    scroll.scrollToOffset(new Vec2(scroll.getScrollOffset().x,scroll.getScrollOffset().y - 930), 1, true)\n                }\n                if(startPos.y < prePos.y){ \n                    const scroll = this.scrollNode.getComponent(ScrollView)\n                    scroll.scrollToOffset(new Vec2(scroll.getScrollOffset().x,scroll.getScrollOffset().y + 930), 1, true)\n                }\n            }else{\n                if(startPos.x > prePos.x){\n                    console.log('====left')\n                    if(this.canvas.scale.x === 2){\n                        this.canvas.setScale(1,1)\n                    }\n                }\n                if(startPos.x < prePos.x){\n                    console.log('====right')\n                    if(this.canvas.scale.x === 1){\n                        this.canvas.setScale(2,2)\n                    }\n                }\n            }\n        })\n    }\n\n    scrollEvent(event, data){\n        let preOffset\n        let curOffset\n        if(data === 12){\n            const scroll = this.scrollNode.getComponent(ScrollView)\n            preOffset = scroll.getScrollOffset().y\n            console.log('====', scroll.getScrollOffset().y)\n        }\n\n        if(data === 9){\n            const scroll = this.scrollNode.getComponent(ScrollView)\n            curOffset = scroll.getScrollOffset().y\n            console.log('====', scroll.getScrollOffset().y)\n        }\n        if(preOffset < curOffset){\n            GlobalConfig.instance.currentNpcIndex = GlobalConfig.instance.currentNpcIndex + 1\n            this.npcIndex = GlobalConfig.instance.currentNpcIndex\n        }else{\n            GlobalConfig.instance.currentNpcIndex = GlobalConfig.instance.currentNpcIndex - 1\n            this.npcIndex = GlobalConfig.instance.currentNpcIndex\n        }\n    }\n\n    scrollUp(){\n\n    }\n\n    scrollDown(){\n\n    }\n\n    scrollLeft(){\n\n    }\n\n    scrollRight(){\n\n    }\n\n    update(deltaTime: number) {\n        \n    }\n}\n\n"]}