{"version":3,"sources":["file:///Users/feiwang/cutepet/node_modules/sshpk/lib/identity.js"],"names":["_cjsLoader","_req","__cjsMetaURL","_req0","_req1","_req2","_req3","_req4","_req5","_req6","_req7","_req8","url","define","exports","require","module","__filename","__dirname","Identity","assert","algs","crypto","Fingerprint","Signature","errs","util","utils","asn1","Buffer","DNS_NAME_RE","oids","cn","o","ou","l","s","c","sn","postalCode","serialNumber","street","x500UniqueIdentifier","role","telephoneNumber","description","dc","uid","mail","title","gn","initials","pseudonym","emailAddress","unoids","Object","keys","forEach","k","opts","self","object","arrayOfObject","components","componentLookup","name","oid","undefined","push","length","value","optionalString","type","match","hostname","map","join","email","Error","prototype","toString","n","toUpperCase","replace","v","get","asArray","string","arr","toArray","idx","NOT_PRINTABLE","NOT_IA5","toAsn1","der","tag","startSequence","Ber","Constructor","Set","writeOID","asn1type","Utf8String","from","writeBuffer","IA5String","writeString","PrintableString","endSequence","globMatch","a","b","aParts","split","bParts","i","equals","other","isIdentity","forHost","forUser","forEmail","parseDN","dn","parts","rem","m","exec","slice","cmps","trim","eqPos","indexOf","charAt","toLowerCase","fromArray","cmp","isBuffer","parseAsn1","top","readSequence","end","offset","after","readOID","peek","OctetString","T61String","readString","CharacterString","BMPString","_offset","obj","ver","isCompatible","_sshpkApiVersion","_oldVersionDetect","_cjsExports"],"mappings":"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","sourcesContent":["import _cjsLoader from 'cce:/internal/ml/cjs-loader.mjs';\nimport { __cjsMetaURL as _req} from 'assert-plus';\nimport { __cjsMetaURL as _req0} from './algs';\nimport { __cjsMetaURL as _req1} from 'crypto';\nimport { __cjsMetaURL as _req2} from './fingerprint';\nimport { __cjsMetaURL as _req3} from './signature';\nimport { __cjsMetaURL as _req4} from './errors';\nimport { __cjsMetaURL as _req5} from 'util';\nimport { __cjsMetaURL as _req6} from './utils';\nimport { __cjsMetaURL as _req7} from 'asn1';\nimport { __cjsMetaURL as _req8} from 'safer-buffer';\nlet _cjsExports;\nconst __cjsMetaURL = import.meta.url;\n_cjsLoader.define(__cjsMetaURL, function (exports, require, module, __filename, __dirname) {\n// #region ORIGINAL CODE\n\n\n // Copyright 2017 Joyent, Inc.\n\n module.exports = Identity;\n\n var assert = require('assert-plus');\n var algs = require('./algs');\n var crypto = require('crypto');\n var Fingerprint = require('./fingerprint');\n var Signature = require('./signature');\n var errs = require('./errors');\n var util = require('util');\n var utils = require('./utils');\n var asn1 = require('asn1');\n var Buffer = require('safer-buffer').Buffer;\n\n /*JSSTYLED*/\n var DNS_NAME_RE = /^([*]|[a-z0-9][a-z0-9\\-]{0,62})(?:\\.([*]|[a-z0-9][a-z0-9\\-]{0,62}))*$/i;\n\n var oids = {};\n oids.cn = '2.5.4.3';\n oids.o = '2.5.4.10';\n oids.ou = '2.5.4.11';\n oids.l = '2.5.4.7';\n oids.s = '2.5.4.8';\n oids.c = '2.5.4.6';\n oids.sn = '2.5.4.4';\n oids.postalCode = '2.5.4.17';\n oids.serialNumber = '2.5.4.5';\n oids.street = '2.5.4.9';\n oids.x500UniqueIdentifier = '2.5.4.45';\n oids.role = '2.5.4.72';\n oids.telephoneNumber = '2.5.4.20';\n oids.description = '2.5.4.13';\n oids.dc = '0.9.2342.19200300.100.1.25';\n oids.uid = '0.9.2342.19200300.100.1.1';\n oids.mail = '0.9.2342.19200300.100.1.3';\n oids.title = '2.5.4.12';\n oids.gn = '2.5.4.42';\n oids.initials = '2.5.4.43';\n oids.pseudonym = '2.5.4.65';\n oids.emailAddress = '1.2.840.113549.1.9.1';\n\n var unoids = {};\n Object.keys(oids).forEach(function (k) {\n \tunoids[oids[k]] = k;\n });\n\n function Identity(opts) {\n \tvar self = this;\n \tassert.object(opts, 'options');\n \tassert.arrayOfObject(opts.components, 'options.components');\n \tthis.components = opts.components;\n \tthis.componentLookup = {};\n \tthis.components.forEach(function (c) {\n \t\tif (c.name && !c.oid)\n \t\t\tc.oid = oids[c.name];\n \t\tif (c.oid && !c.name)\n \t\t\tc.name = unoids[c.oid];\n \t\tif (self.componentLookup[c.name] === undefined)\n \t\t\tself.componentLookup[c.name] = [];\n \t\tself.componentLookup[c.name].push(c);\n \t});\n \tif (this.componentLookup.cn && this.componentLookup.cn.length > 0) {\n \t\tthis.cn = this.componentLookup.cn[0].value;\n \t}\n \tassert.optionalString(opts.type, 'options.type');\n \tif (opts.type === undefined) {\n \t\tif (this.components.length === 1 &&\n \t\t    this.componentLookup.cn &&\n \t\t    this.componentLookup.cn.length === 1 &&\n \t\t    this.componentLookup.cn[0].value.match(DNS_NAME_RE)) {\n \t\t\tthis.type = 'host';\n \t\t\tthis.hostname = this.componentLookup.cn[0].value;\n\n \t\t} else if (this.componentLookup.dc &&\n \t\t    this.components.length === this.componentLookup.dc.length) {\n \t\t\tthis.type = 'host';\n \t\t\tthis.hostname = this.componentLookup.dc.map(\n \t\t\t    function (c) {\n \t\t\t\treturn (c.value);\n \t\t\t}).join('.');\n\n \t\t} else if (this.componentLookup.uid &&\n \t\t    this.components.length ===\n \t\t    this.componentLookup.uid.length) {\n \t\t\tthis.type = 'user';\n \t\t\tthis.uid = this.componentLookup.uid[0].value;\n\n \t\t} else if (this.componentLookup.cn &&\n \t\t    this.componentLookup.cn.length === 1 &&\n \t\t    this.componentLookup.cn[0].value.match(DNS_NAME_RE)) {\n \t\t\tthis.type = 'host';\n \t\t\tthis.hostname = this.componentLookup.cn[0].value;\n\n \t\t} else if (this.componentLookup.uid &&\n \t\t    this.componentLookup.uid.length === 1) {\n \t\t\tthis.type = 'user';\n \t\t\tthis.uid = this.componentLookup.uid[0].value;\n\n \t\t} else if (this.componentLookup.mail &&\n \t\t    this.componentLookup.mail.length === 1) {\n \t\t\tthis.type = 'email';\n \t\t\tthis.email = this.componentLookup.mail[0].value;\n\n \t\t} else if (this.componentLookup.cn &&\n \t\t    this.componentLookup.cn.length === 1) {\n \t\t\tthis.type = 'user';\n \t\t\tthis.uid = this.componentLookup.cn[0].value;\n\n \t\t} else {\n \t\t\tthis.type = 'unknown';\n \t\t}\n \t} else {\n \t\tthis.type = opts.type;\n \t\tif (this.type === 'host')\n \t\t\tthis.hostname = opts.hostname;\n \t\telse if (this.type === 'user')\n \t\t\tthis.uid = opts.uid;\n \t\telse if (this.type === 'email')\n \t\t\tthis.email = opts.email;\n \t\telse\n \t\t\tthrow (new Error('Unknown type ' + this.type));\n \t}\n }\n\n Identity.prototype.toString = function () {\n \treturn (this.components.map(function (c) {\n \t\tvar n = c.name.toUpperCase();\n \t\t/*JSSTYLED*/\n \t\tn = n.replace(/=/g, '\\\\=');\n \t\tvar v = c.value;\n \t\t/*JSSTYLED*/\n \t\tv = v.replace(/,/g, '\\\\,');\n \t\treturn (n + '=' + v);\n \t}).join(', '));\n };\n\n Identity.prototype.get = function (name, asArray) {\n \tassert.string(name, 'name');\n \tvar arr = this.componentLookup[name];\n \tif (arr === undefined || arr.length === 0)\n \t\treturn (undefined);\n \tif (!asArray && arr.length > 1)\n \t\tthrow (new Error('Multiple values for attribute ' + name));\n \tif (!asArray)\n \t\treturn (arr[0].value);\n \treturn (arr.map(function (c) {\n \t\treturn (c.value);\n \t}));\n };\n\n Identity.prototype.toArray = function (idx) {\n \treturn (this.components.map(function (c) {\n \t\treturn ({\n \t\t\tname: c.name,\n \t\t\tvalue: c.value\n \t\t});\n \t}));\n };\n\n /*\n  * These are from X.680 -- PrintableString allowed chars are in section 37.4\n  * table 8. Spec for IA5Strings is \"1,6 + SPACE + DEL\" where 1 refers to\n  * ISO IR #001 (standard ASCII control characters) and 6 refers to ISO IR #006\n  * (the basic ASCII character set).\n  */\n /* JSSTYLED */\n var NOT_PRINTABLE = /[^a-zA-Z0-9 '(),+.\\/:=?-]/;\n /* JSSTYLED */\n var NOT_IA5 = /[^\\x00-\\x7f]/;\n\n Identity.prototype.toAsn1 = function (der, tag) {\n \tder.startSequence(tag);\n \tthis.components.forEach(function (c) {\n \t\tder.startSequence(asn1.Ber.Constructor | asn1.Ber.Set);\n \t\tder.startSequence();\n \t\tder.writeOID(c.oid);\n \t\t/*\n \t\t * If we fit in a PrintableString, use that. Otherwise use an\n \t\t * IA5String or UTF8String.\n \t\t *\n \t\t * If this identity was parsed from a DN, use the ASN.1 types\n \t\t * from the original representation (otherwise this might not\n \t\t * be a full match for the original in some validators).\n \t\t */\n \t\tif (c.asn1type === asn1.Ber.Utf8String ||\n \t\t    c.value.match(NOT_IA5)) {\n \t\t\tvar v = Buffer.from(c.value, 'utf8');\n \t\t\tder.writeBuffer(v, asn1.Ber.Utf8String);\n\n \t\t} else if (c.asn1type === asn1.Ber.IA5String ||\n \t\t    c.value.match(NOT_PRINTABLE)) {\n \t\t\tder.writeString(c.value, asn1.Ber.IA5String);\n\n \t\t} else {\n \t\t\tvar type = asn1.Ber.PrintableString;\n \t\t\tif (c.asn1type !== undefined)\n \t\t\t\ttype = c.asn1type;\n \t\t\tder.writeString(c.value, type);\n \t\t}\n \t\tder.endSequence();\n \t\tder.endSequence();\n \t});\n \tder.endSequence();\n };\n\n function globMatch(a, b) {\n \tif (a === '**' || b === '**')\n \t\treturn (true);\n \tvar aParts = a.split('.');\n \tvar bParts = b.split('.');\n \tif (aParts.length !== bParts.length)\n \t\treturn (false);\n \tfor (var i = 0; i < aParts.length; ++i) {\n \t\tif (aParts[i] === '*' || bParts[i] === '*')\n \t\t\tcontinue;\n \t\tif (aParts[i] !== bParts[i])\n \t\t\treturn (false);\n \t}\n \treturn (true);\n }\n\n Identity.prototype.equals = function (other) {\n \tif (!Identity.isIdentity(other, [1, 0]))\n \t\treturn (false);\n \tif (other.components.length !== this.components.length)\n \t\treturn (false);\n \tfor (var i = 0; i < this.components.length; ++i) {\n \t\tif (this.components[i].oid !== other.components[i].oid)\n \t\t\treturn (false);\n \t\tif (!globMatch(this.components[i].value,\n \t\t    other.components[i].value)) {\n \t\t\treturn (false);\n \t\t}\n \t}\n \treturn (true);\n };\n\n Identity.forHost = function (hostname) {\n \tassert.string(hostname, 'hostname');\n \treturn (new Identity({\n \t\ttype: 'host',\n \t\thostname: hostname,\n \t\tcomponents: [ { name: 'cn', value: hostname } ]\n \t}));\n };\n\n Identity.forUser = function (uid) {\n \tassert.string(uid, 'uid');\n \treturn (new Identity({\n \t\ttype: 'user',\n \t\tuid: uid,\n \t\tcomponents: [ { name: 'uid', value: uid } ]\n \t}));\n };\n\n Identity.forEmail = function (email) {\n \tassert.string(email, 'email');\n \treturn (new Identity({\n \t\ttype: 'email',\n \t\temail: email,\n \t\tcomponents: [ { name: 'mail', value: email } ]\n \t}));\n };\n\n Identity.parseDN = function (dn) {\n \tassert.string(dn, 'dn');\n \tvar parts = [''];\n \tvar idx = 0;\n \tvar rem = dn;\n \twhile (rem.length > 0) {\n \t\tvar m;\n \t\t/*JSSTYLED*/\n \t\tif ((m = /^,/.exec(rem)) !== null) {\n \t\t\tparts[++idx] = '';\n \t\t\trem = rem.slice(m[0].length);\n \t\t/*JSSTYLED*/\n \t\t} else if ((m = /^\\\\,/.exec(rem)) !== null) {\n \t\t\tparts[idx] += ',';\n \t\t\trem = rem.slice(m[0].length);\n \t\t/*JSSTYLED*/\n \t\t} else if ((m = /^\\\\./.exec(rem)) !== null) {\n \t\t\tparts[idx] += m[0];\n \t\t\trem = rem.slice(m[0].length);\n \t\t/*JSSTYLED*/\n \t\t} else if ((m = /^[^\\\\,]+/.exec(rem)) !== null) {\n \t\t\tparts[idx] += m[0];\n \t\t\trem = rem.slice(m[0].length);\n \t\t} else {\n \t\t\tthrow (new Error('Failed to parse DN'));\n \t\t}\n \t}\n \tvar cmps = parts.map(function (c) {\n \t\tc = c.trim();\n \t\tvar eqPos = c.indexOf('=');\n \t\twhile (eqPos > 0 && c.charAt(eqPos - 1) === '\\\\')\n \t\t\teqPos = c.indexOf('=', eqPos + 1);\n \t\tif (eqPos === -1) {\n \t\t\tthrow (new Error('Failed to parse DN'));\n \t\t}\n \t\t/*JSSTYLED*/\n \t\tvar name = c.slice(0, eqPos).toLowerCase().replace(/\\\\=/g, '=');\n \t\tvar value = c.slice(eqPos + 1);\n \t\treturn ({ name: name, value: value });\n \t});\n \treturn (new Identity({ components: cmps }));\n };\n\n Identity.fromArray = function (components) {\n \tassert.arrayOfObject(components, 'components');\n \tcomponents.forEach(function (cmp) {\n \t\tassert.object(cmp, 'component');\n \t\tassert.string(cmp.name, 'component.name');\n \t\tif (!Buffer.isBuffer(cmp.value) &&\n \t\t    !(typeof (cmp.value) === 'string')) {\n \t\t\tthrow (new Error('Invalid component value'));\n \t\t}\n \t});\n \treturn (new Identity({ components: components }));\n };\n\n Identity.parseAsn1 = function (der, top) {\n \tvar components = [];\n \tder.readSequence(top);\n \tvar end = der.offset + der.length;\n \twhile (der.offset < end) {\n \t\tder.readSequence(asn1.Ber.Constructor | asn1.Ber.Set);\n \t\tvar after = der.offset + der.length;\n \t\tder.readSequence();\n \t\tvar oid = der.readOID();\n \t\tvar type = der.peek();\n \t\tvar value;\n \t\tswitch (type) {\n \t\tcase asn1.Ber.PrintableString:\n \t\tcase asn1.Ber.IA5String:\n \t\tcase asn1.Ber.OctetString:\n \t\tcase asn1.Ber.T61String:\n \t\t\tvalue = der.readString(type);\n \t\t\tbreak;\n \t\tcase asn1.Ber.Utf8String:\n \t\t\tvalue = der.readString(type, true);\n \t\t\tvalue = value.toString('utf8');\n \t\t\tbreak;\n \t\tcase asn1.Ber.CharacterString:\n \t\tcase asn1.Ber.BMPString:\n \t\t\tvalue = der.readString(type, true);\n \t\t\tvalue = value.toString('utf16le');\n \t\t\tbreak;\n \t\tdefault:\n \t\t\tthrow (new Error('Unknown asn1 type ' + type));\n \t\t}\n \t\tcomponents.push({ oid: oid, asn1type: type, value: value });\n \t\tder._offset = after;\n \t}\n \tder._offset = end;\n \treturn (new Identity({\n \t\tcomponents: components\n \t}));\n };\n\n Identity.isIdentity = function (obj, ver) {\n \treturn (utils.isCompatible(obj, Identity, ver));\n };\n\n /*\n  * API versions for Identity:\n  * [1,0] -- initial ver\n  */\n Identity.prototype._sshpkApiVersion = [1, 0];\n\n Identity._oldVersionDetect = function (obj) {\n \treturn ([1, 0]);\n };\n\n\n// #endregion ORIGINAL CODE\n\n_cjsExports = module.exports;\n\n\n}, () => ({\n  'assert-plus': _req,\n  './algs': _req0,\n  'crypto': _req1,\n  './fingerprint': _req2,\n  './signature': _req3,\n  './errors': _req4,\n  'util': _req5,\n  './utils': _req6,\n  'asn1': _req7,\n  'safer-buffer': _req8,\n}));\nexport { _cjsExports as default };\nexport { __cjsMetaURL }\n"]}