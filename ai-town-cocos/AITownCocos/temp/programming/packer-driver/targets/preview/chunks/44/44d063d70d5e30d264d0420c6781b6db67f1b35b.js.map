{"version":3,"sources":["file:///Users/feiwang/AITown/AITownCocos/assets/src/town/TownView.ts"],"names":["_decorator","Component","instantiate","KeyCode","Label","Node","TiledMap","TiledObjectGroup","tween","UITransform","Vec2","Vec3","view","modelMgr","observer","socket","EventType","network","WebUtils","BubbleImgUrl","EventNpcInfoMap","NpcEventType","NpcIndex","NPCPartDisplayInfo","ProductsItemUrl","NPCControl","_","PromiseUtils","GlobalConfig","ccclass","property","sleepFramePosX","sleepFrameTime","bubbleTime","hight","PosAdapt","TownView","type","_curPlayerTile","_npcTileArray","sleepFrameAdd","homeBedFrameIndex","info_farmland1","farmland","fieldNode","info_farmland2","info_farmland3","info_farmland4","testFrameIndex","testbakerIndex","_layerFloor","start","json","GetAllNPCRequest","command","sendWebSocketBinary","townModel","refreshItemDate","on","SOCKET_GETALL_NPCS","setNPCPos","SOCKET_ONLINE_NPCS","initOtherNPCByData","SOCKET_OFFLINE_NPCS","removeNPC","SOCKET_NPC_ACTION","playNPCAction","SOCKET_ITEM_STATE_CHANGE","objectStateChange","SOCKET_ITEMUPDATE","updateObjectStateChange","node","getComponent","getLayer","window","herdSleep","data","bid","actionId","npcId","params","oid","herdCook","items","itemId","count","herdDinning","farm","farmHarvest","farmGoSleep","farmStopSleep","farmcook","farmeat","fieldReady","setFieldReady","bakerSleep","bakerCook","bakerDinning","GrocerSleep","GrocerCook","GrocerDinning","NPCs","initPlayerNPC","myNpc","otherNpc","initOtherNPCs","checkPlayerId","actionData","item","find","users","instance","LoginData","player","playerId","length","setNpcHomeBed","currentIndex","farmHomeBedHead","setPosition","getPosition","y","herdmanHomeBedHead","bakerHomeBedHead","grocerHomeBedHead","getPartInfo","label","id","part","getSleepNode","head","bubble","farmHomeBedBubble","herdmanBedBubble","bakerBedBubble","grocerBedBubble","stopNpcSleep","npc","cb","active","npcSleep","getResouceImg","sleep","getChildByName","scheduleOnce","npcCook","food","ItemCfg","foodItem","url","wait","cook","shouldSend","NpcActionDone","objId","x","isFinish","state","stopCook","npcDinning","eating","dinning","getDinning","afterDinner","eat","farmDinning","grocerDinning","stopDinning","stopActionNormal","setItemCountChange","npcFarming","farmItem","fieldName","setParent","fieldArr","children","fieldIndexX","adaptX","adaptY","field","farmerHoe","farmerWater","startTile","_getTilePos","finishTile","aStartMove","setNPCMoveDirect","KEY_A","npcHarvest","farmerSickle","removeFromParent","butcherFeeding","img","string","clean","butcherSkill","knife","breadMake","sale","price","buy","speak","content","stopFarming","actions","otherNPCarr","NpcID","eventPox","toNpc","toPos","error","nodes","setNpcDirect","farming","harvest","getup","move","slaughter","make","feeding","directType","direct","finishNPCAction","farmAction","myNPC","parent","_curTile","pos","getPositionAt","camera","gameView","getVisibleSize","mainCamera","loading","forEach","NPC","initOtherNPC","playerInstantiate","playerLayer","addChild","push","npcTile","isValueIncluded","includes","npcIndex","model","frame_path","hair","top","bottoms","offLineNPC","npcIds","remove","updateOtherPlayerInfo","moveNPC","steepKey","KEY_D","KEY_S","KEY_W","setMoveSprite","setNPCPosition","to","position","onComplete","posInPixel","mapSize","contentSize","tileSize","getTileSize","Math","floor","width","height","onDestroy","off","testFarmRound","testBakerRound","object","update","deltaTime"],"mappings":"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","sourcesContent":["import {\n  _decorator,\n  Component,\n  instantiate,\n  KeyCode,\n  Label,\n  Node,\n  TiledLayer,\n  TiledMap,\n  TiledObjectGroup,\n  tween,\n  UITransform,\n  Vec2,\n  Vec3,\n  view,\n} from \"cc\";\nimport { modelMgr, observer, socket } from \"../game/App\";\nimport { EventType } from \"../EventType\";\nimport { NPCServerD } from \"../game/config/DataStruct\";\nimport { network } from \"../model/RequestData\";\nimport WebUtils from \"../utils/WebUtils\";\nimport {\n  BubbleImgUrl,\n  EventNpcInfoMap,\n  NpcEventType,\n  NpcIndex,\n  NPCPartDisplayInfo,\n  ProductsItemUrl,\n} from \"../StaticUtils/NPCConfig\";\nimport { frameSpeed, NPCControl } from \"../NPC/NPCControl\";\nimport _ from \"lodash\";\nimport { DataEvents, DataFarmEvent } from \"../model/DataEvents\";\nimport { PromiseUtils } from \"../StaticUtils/PromiseUtils\";\nimport { GlobalConfig } from \"../game/config/GlobalConfig\";\nconst { ccclass, property } = _decorator;\nexport const sleepFramePosX = [40, -61];\nexport const sleepFrameTime = 0.45;\nexport const bubbleTime = 0.7;\n\nexport const hight = 6720\n// 434, 820\nconst PosAdapt = 1;\ndeclare global {\n  interface Window {\n    farmGoSleep: any;\n    farm: any;\n    farmcook: any;\n    farmeat: any;\n    fieldReady: any;\n\n    herdSleep: any;\n    herdCook: any;\n    herdDinning: any;\n\n    bakerSleep: any;\n    bakerCook: any;\n    bakerDinning: any;\n\n    GrocerSleep: any;\n    GrocerCook: any;\n    GrocerDinning: any;\n    farmHarvest: any;\n    farmStopSleep: any\n  }\n}\n@ccclass(\"TownView\")\nexport class TownView extends Component {\n  @property({ type: [Node] })\n  public otherNPCarr: Node[] = [];\n\n  @property(Node)\n  public player: Node = null;\n\n  @property(Node)\n  public playerInstantiate: Node = null;\n\n  @property(Node)\n  public playerLayer: Node = null;\n\n  @property(Node)\n  public playerNode: Node = null;\n\n  @property({ type: TiledObjectGroup })\n  public tileObject: TiledObjectGroup | null = null;\n\n  @property(Node)\n  public loading: Node = null;\n\n  @property(Node)\n  public farmHomeBedHead: Node = null;\n\n  @property(Node)\n  public farmHomeBedBubble: Node = null;\n\n  @property(Node)\n  public farmDinning: Node = null;\n\n  @property(Node)\n  public fieldWheat: Node = null;\n\n  @property(Node)\n  public fieldCorn: Node = null;\n\n  @property(Node)\n  public fieldCabbage: Node = null;\n\n  @property(Node)\n  public farmland1: Node = null;\n\n  @property(Node)\n  public farmland2: Node = null;\n\n  @property(Node)\n  public farmland3: Node = null;\n\n  @property(Node)\n  public farmland4: Node = null;\n\n  @property(Node)\n  public herdmanHomeBedHead: Node = null;\n\n  @property(Node)\n  public herdmanBedBubble: Node = null;\n\n  @property(Node)\n  public herdDinning: Node = null;\n\n  @property(Node)\n  public bakerHomeBedHead: Node = null;\n\n  @property(Node)\n  public bakerBedBubble: Node = null;\n\n  @property(Node)\n  public bakerDinning: Node = null;\n\n  @property(Node)\n  public grocerHomeBedHead: Node = null;\n\n  @property(Node)\n  public grocerBedBubble: Node = null;\n\n  @property(Node)\n  public grocerDinning: Node = null;\n\n  private _curPlayerTile = new Vec2();\n\n  _npcTileArray: Vec2[] = [];\n  sleepFrameAdd = 0;\n  homeBedFrameIndex = 0;\n\n  info_farmland1 = {\n    farmland: 'farmland1',\n    fieldNode: null\n  }\n\n  info_farmland2 = {\n    farmland: 'farmland2',\n    fieldNode: null\n  }\n\n  info_farmland3 = {\n    farmland: 'farmland3',\n    fieldNode: null\n  }\n\n  info_farmland4 = {\n    farmland: 'farmland4',\n    fieldNode: null\n  }\n\n  // farmland4 = [];\n\n  // farmland3 = [];\n\n  // farmland1 = [];\n\n  testFrameIndex = 0\n  testbakerIndex = 0\n\n  private _layerFloor: TiledLayer = null!;\n  async start() {\n    let json = new network.GetAllNPCRequest();\n    json.command = 10002;\n    json.type = 1;\n    socket.sendWebSocketBinary(json);\n\n    modelMgr.townModel.refreshItemDate()\n\n    observer.on(EventType.SOCKET_GETALL_NPCS, this.setNPCPos, this);\n    observer.on(EventType.SOCKET_ONLINE_NPCS, this.initOtherNPCByData, this);\n    observer.on(EventType.SOCKET_OFFLINE_NPCS, this.removeNPC, this);\n    //observer.on(EventType.SOCKET_NPC_MOVE, this.updateOtherPlayerInfo, this);\n    observer.on(EventType.SOCKET_NPC_ACTION, this.playNPCAction, this);\n\n    observer.on(EventType.SOCKET_ITEM_STATE_CHANGE, this.objectStateChange, this);\n\n    observer.on(EventType.SOCKET_ITEMUPDATE, this.updateObjectStateChange, this);\n\n    observer.on(EventType.SOCKET_ITEMUPDATE, this.updateObjectStateChange, this);\n\n    this._layerFloor = this.node.getComponent(TiledMap).getLayer(\"building\")!;\n\n    // this.farmland4 = [...this.farmFieldWheat.children];\n\n    // this.farmland3 = [...this.farmFieldCorn.children];\n\n    // this.farmland1 = [...this.farmFieldCabbage.children];\n    //!herd\n    window.herdSleep = () => {\n      this.playNPCAction({\n        data:{\n            data:        {\n        bid: 10,\n        actionId: 106,\n        npcId: 10004,\n        params: {\n          oid: \"breedingBed\",\n        },\n      }\n        }\n      }\n\n);\n    };\n\n    window.herdCook = () => {\n      this.playNPCAction(\n        \n        {\n            data:{\n                data: {\n                    bid: 11,\n                    actionId: 104,\n                    npcId: 10004,\n                    params: {\n                      oid: \"breedingCook\",\n                      items: [\n                        {\n                          itemId: 10101006,\n                          count: 1,\n                        },\n                        {\n                          itemId: 10101003,\n                          count: 1,\n                        },\n                        {\n                          itemId: 10101005,\n                          count: 1,\n                        },\n                      ],\n                    },\n                  }\n            }\n        }\n\n);\n    };\n\n    window.herdDinning = () => {\n      this.playNPCAction({\n        bid: 12,\n        actionId: 105,\n        npcId: 10004,\n        params: {\n          oid: \"breedingTable\",\n        },\n      });\n    };\n\n    //!farmer\n\n    window.farm = async () => {\n      await this.playNPCAction({\n        data:{\n          data:{\n            bid: 13,\n            actionId: 100,\n            npcId: 10002,\n            params: {\n              oid: \"farmland4\",\n              itemId: 10101001,\n            },\n          }\n\n        }\n\n      });\n    };\n\n    window.farmHarvest = () =>{\n        this.playNPCAction({\n            data:{\n                data:{\n                    bid: 14,\n                    actionId: 101,\n                    npcId: 10002,\n                    params: {\n                      oid: \"farmland4\",\n                      items: [\n                        {\n                          itemId: 10101001,\n                          count: 1,\n                        },\n                      ]}\n                }\n\n            }\n    });\n    }\n\n    window.farmGoSleep = () => {\n\n      this.playNPCAction(        {\n        data:{\n            data:{\n                bid: 15,\n                actionId: 106,\n                npcId: 10002,\n                params: {\n                  oid: \"farmerBed\",\n                },\n              }\n        }\n    });\n    };\n\n    window.farmStopSleep = ()=>{\n        this.playNPCAction(        {\n            data:{\n                data:{\n                    bid: 15,\n                    actionId: 111,\n                    npcId: 10002,\n                    params: {\n                      oid: \"farmerBed\",\n                    },\n                  }\n            }\n        })\n    }\n\n    window.farmcook = () => {\n      this.playNPCAction({\n        bid: 16,\n        actionId: 104,\n        npcId: 10002,\n        params: {\n          oid: \"farmerCook\",\n          items: [\n            {\n              itemId: 10101006,\n              count: 1,\n            },\n            {\n              itemId: 10101003,\n              count: 1,\n            },\n            {\n              itemId: 10101005,\n              count: 1,\n            },\n          ],\n        },\n      });\n    };\n\n    window.farmeat = () => {\n      this.playNPCAction({\n        bid: 17,\n        actionId: 105,\n        npcId: 10002,\n        params: {\n          oid: \"farmerTable\",\n        },\n      });\n    };\n\n    window.fieldReady = ()=>{\n        this.setFieldReady({\n            bid: 18,\n            actionId: 105,\n            npcId: 10002,\n            params: {\n              oid: \"farmland4\",\n            }\n        })\n    }\n\n    //!baker\n    window.bakerSleep = () => {\n      this.playNPCAction({\n        bid: 18,\n        actionId: 106,\n        npcId: 10005,\n        params: {\n          oid: \"bakerBed\",\n        },\n      });\n    };\n\n    window.bakerCook = () => {\n      this.playNPCAction({\n        bid: 19,\n        actionId: 104,\n        npcId: 10005,\n        params: {\n          oid: \"bakerCook\",\n          items: [\n            {\n              itemId: 10101006,\n              count: 1,\n            },\n            {\n              itemId: 10101003,\n              count: 1,\n            },\n            {\n              itemId: 10101005,\n              count: 1,\n            },\n          ],\n        },\n      });\n    };\n\n    window.bakerDinning = () => {\n      this.playNPCAction({\n        bid: 20,\n        actionId: 105,\n        npcId: 10005,\n        params: {\n          oid: \"bakerTable\",\n        },\n      });\n    };\n        //!baker\n        window.GrocerSleep = () => {\n            this.playNPCAction({\n                bid: 21,\n              actionId: 106,\n              npcId: 10003,\n              params: {\n                oid: \"salerBed\",\n              },\n            });\n          };\n      \n          window.GrocerCook = () => {\n            this.playNPCAction({\n                bid: 22,\n              actionId: 104,\n              npcId: 10003,\n              params: {\n                oid: \"salerCook\",\n                items: [\n                  {\n                    itemId: 10101006,\n                    count: 1,\n                  },\n                  {\n                    itemId: 10101003,\n                    count: 1,\n                  },\n                  {\n                    itemId: 10101005,\n                    count: 1,\n                  },\n                ],\n              },\n            });\n          };\n      \n          window.GrocerDinning = () => {\n            this.playNPCAction({\n              bid: 23,\n              actionId: 105,\n              npcId: 10003,\n              params: {\n                oid: \"salerTable\",\n              },\n            });\n          };\n    //await this.testFarmRound()\n    //await this.testBakerRound()\n    //this.tiledLayer.addUserNode(this.playerNode)\n  }\n\n  setNPCPos(NPCs: any) {\n    if (!NPCs) {\n      return;\n    }\n    this.initPlayerNPC(NPCs.data.data.myNpc);\n    NPCs?.data?.data?.otherNpc && this.initOtherNPCs(NPCs.data.data.otherNpc);\n  }\n\n  async checkPlayerId(actionData){\n\n    const item = _.find(actionData.users, (item) => {\n      return item === GlobalConfig.instance.LoginData.data.player.playerId;\n    });\n    if(item || !actionData?.users?.length){\n      return true\n    }else{\n      return false\n    }\n  }\n\n  setNpcHomeBed(currentIndex: number) {\n    this.farmHomeBedHead.setPosition(\n      sleepFramePosX[currentIndex],\n      this.farmHomeBedHead.getPosition().y\n    );\n    this.herdmanHomeBedHead.setPosition(\n      sleepFramePosX[currentIndex],\n      this.herdmanHomeBedHead.getPosition().y\n    );\n    this.bakerHomeBedHead.setPosition(\n      sleepFramePosX[currentIndex],\n      this.bakerHomeBedHead.getPosition().y\n    );\n    this.grocerHomeBedHead.setPosition(\n        sleepFramePosX[currentIndex],\n        this.grocerHomeBedHead.getPosition().y\n      );\n  }\n\n  getPartInfo(label: string, id: number) {\n    return NPCPartDisplayInfo[label]?.find((part) => part.id === id) ?? null;\n  }\n\n  //!npc\n  getSleepNode(npcId: number) {\n    switch (npcId) {\n      case 10002:\n        return {\n          head: this.farmHomeBedHead,\n          bubble: this.farmHomeBedBubble,\n        };\n      case 10004:\n        return {\n          head: this.herdmanHomeBedHead,\n          bubble: this.herdmanBedBubble,\n        };\n      case 10005:\n        return {\n          head: this.bakerHomeBedHead,\n          bubble: this.bakerBedBubble,\n        };\n      case 10003:\n        return {\n          head: this.grocerHomeBedHead,\n          bubble: this.grocerBedBubble,\n        };\n        //idnode\n        break;\n      default:\n        return {\n          head: this.farmHomeBedHead,\n          bubble: this.farmHomeBedBubble,\n        };\n        break;\n    }\n  }\n\n  stopNpcSleep(npc: Node, actionData: DataEvents, cb?: () => void) {\n    switch (actionData.npcId) {\n      case 10002:\n        this.farmHomeBedHead.active = false;\n        this.farmHomeBedBubble.active = false;\n        npc.active = true;\n        break;\n      case 10004:\n        this.herdmanHomeBedHead.active = false;\n        this.herdmanBedBubble.active = false;\n        npc.active = true;\n        break;\n      case 10005:\n        this.bakerHomeBedHead.active = false;\n        this.bakerBedBubble.active = false;\n        npc.active = true;\n        break;\n      case 10003:\n        this.grocerHomeBedHead.active = false;\n        this.grocerBedBubble.active = false;\n        npc.active = true;\n        break;\n        //idnode\n        break;\n      default:\n        break;\n    }\n  }\n\n  npcSleep(npc: Node, head: Node, bubble: Node, cb?: () => void) {\n    WebUtils.getResouceImg(\n      BubbleImgUrl.sleep,\n      npc.getChildByName(\"bubble\"),\n      () => {\n        npc.getChildByName(\"bubble\").active = true;\n      }\n    );\n    this.scheduleOnce(() => {\n      cb();\n      head.active = true;\n      bubble.active = true;\n    }, bubbleTime);\n  }\n\n\n\n  //!npc\n  async npcCook(npc: Node, actionData: DataEvents, cb?: () => void) {\n    for (const foodItem of actionData.params.items) {\n      const food = _.find(ProductsItemUrl.ItemCfg, (item) => {\n        return item.id === foodItem.itemId;\n      });\n      WebUtils.getResouceImg(food.url, npc.getChildByName(\"bubble\"), () => {\n        npc.getChildByName(\"bubble\").active = true;\n      });\n\n      await PromiseUtils.wait(bubbleTime * 2000);\n      WebUtils.getResouceImg(BubbleImgUrl.cook, npc.getChildByName(\"bubble\"));\n\n      const shouldSend = await this.checkPlayerId(actionData)\n\n      if(shouldSend){\n        let json = new network.NpcActionDone();\n        json.command = 10008;\n        json.type = 1;\n        json.data.bid = actionData.bid\n        json.data.npcId = actionData.npcId\n        json.data.objId = actionData.params.oid\n        json.data.x = npc.getPosition().x\n        json.data.y = hight - npc.getPosition().y\n        json.data.isFinish = 1 \n        json.data.state = 1 \n        json.data.params = {\n          oid: actionData.params.oid,\n          itemId: actionData.params.itemId,\n          count: 1,\n        }\n        socket.sendWebSocketBinary(json);\n        await PromiseUtils.wait(bubbleTime * 2000);\n      }\n\n    }\n  }\n\n  stopCook(npc: Node, cb?: () => void) {\n    npc.getChildByName(\"bubble\").active = false;\n  }\n\n  //!\n  async npcDinning(npc: Node, actionData: DataEvents) {\n    WebUtils.getResouceImg(\n      BubbleImgUrl.eating,\n      npc.getChildByName(\"bubble\"),\n      () => {\n        npc.getChildByName(\"bubble\").active = true;\n      }\n    );\n    const dinning = this.getDinning(actionData.npcId);\n    WebUtils.getResouceImg(BubbleImgUrl.dinning, dinning.dinning, () => {\n      dinning.dinning.active = true;\n    });\n\n    await PromiseUtils.wait(bubbleTime * 4000);\n    WebUtils.getResouceImg(BubbleImgUrl.afterDinner, dinning.dinning, () => {\n      WebUtils.getResouceImg(\n        BubbleImgUrl.eat,\n        npc.getChildByName(\"bubble\"),\n        () => {}\n      );\n    });\n    await PromiseUtils.wait(bubbleTime * 2000);\n  }\n\n  getDinning(npcId: number) {\n    switch (npcId) {\n      case 10002:\n        return {\n          dinning: this.farmDinning,\n        };\n      case 10004:\n        return {\n          dinning: this.herdDinning,\n        };\n      case 10005:\n        return {\n          dinning: this.bakerDinning,\n        };\n      case 10003:\n        return {\n          dinning: this.grocerDinning,\n        };\n        //idnode\n        break;\n      default:\n        return {\n          dinning: this.farmDinning,\n        };\n        break;\n    }\n  }\n\n  stopDinning(npc: Node, cb?: () => void) {\n    npc.getChildByName(\"bubble\").active = false;\n  }\n\n  stopActionNormal(npc: Node, actionData: DataEvents, cb?: () => void) {\n    this.stopNpcSleep(npc, actionData, cb);\n    npc.getChildByName(\"bubble\").active = false;\n  }\n\n  setItemCountChange(){\n\n  }\n\n  //!\n  async npcFarming(npc: Node, actionData: DataEvents) {\n    if(!this[actionData.params.oid]){\n      return\n    }\n\n\n\n    const farmItem = _.find(ProductsItemUrl.ItemCfg, (item) => {\n      return item.id === actionData.params.itemId;\n    })\n\n    const item = instantiate(this[farmItem.fieldName]) as Node;\n    item.setParent(this[actionData.params.oid])\n    this[`info_${actionData.params.oid}`].fieldNode = item\n    item.setPosition(new Vec3(0,0,0))\n    const fieldArr: Node[] = [...item.children]\n    actionData.params.itemId\n    \n    let fieldIndexX = 1;\n    let adaptX;\n    let adaptY;\n    for (const field of fieldArr) {\n      if (fieldIndexX % 3 === 0) {\n        adaptX = -1;\n        adaptY = 0;\n      } else {\n        adaptX = 0;\n        adaptY = fieldIndexX === 4 || fieldIndexX === 5 ? -1 : 1;\n      }\n      //?\n      WebUtils.getResouceImg(\n        BubbleImgUrl.farmerHoe,\n        npc.getChildByName(\"bubble\"),\n        () => {\n          npc.getChildByName(\"bubble\").active = true;\n        }\n      );\n\n      await PromiseUtils.wait(bubbleTime * 2000);\n      //?\n      field.active = true;\n      await PromiseUtils.wait(bubbleTime * 2000);\n      //?\n      WebUtils.getResouceImg(\n        BubbleImgUrl.farmerWater,\n        npc.getChildByName(\"bubble\")\n      );\n      await PromiseUtils.wait(bubbleTime * 2000);\n\n      const startTile = this._getTilePos(\n        new Vec2(npc.getPosition().x, npc.getPosition().y)\n      );\n      const finishTile = this._getTilePos(\n        new Vec2(\n          npc.getPosition().x + adaptX * 32,\n          npc.getPosition().y + adaptY * 32\n        )\n      );\n      npc\n        .getChildByName(\"NPCinstantiate\")\n        .getComponent(NPCControl)\n        .aStartMove(\n          new Vec2(startTile.x, startTile.y),\n          new Vec2(finishTile.x, finishTile.y),\n          () => {\n            npc\n              .getChildByName(\"NPCinstantiate\")\n              .getComponent(NPCControl)\n              .setNPCMoveDirect(KeyCode.KEY_A);\n          }\n        );\n\n      fieldIndexX = fieldIndexX + 1;\n      await PromiseUtils.wait(bubbleTime * 2000);\n    }\n  }\n\n    //!\n    async npcHarvest(npc: Node, actionData: DataEvents) {\n\n      const farmItem = _.find(ProductsItemUrl.ItemCfg, (item) => {\n        return item.id === actionData.params.itemId;\n      })\n      const item = this[`info_${actionData.params.oid}`].fieldNode\n      const fieldArr: Node[] = [...item.children]\n        let fieldIndexX = 1;\n        let adaptX;\n        let adaptY;\n        for (const field of fieldArr) {\n          if (fieldIndexX % 3 === 0) {\n            adaptX = -2;\n            adaptY = 0;\n          } else {\n            adaptX = 0;\n            adaptY = fieldIndexX === 4 || fieldIndexX === 5 ? -2 : 2;\n          }\n          //?\n          WebUtils.getResouceImg(\n            BubbleImgUrl.farmerSickle,\n            npc.getChildByName(\"bubble\"),\n            () => {\n              npc.getChildByName(\"bubble\").active = true;\n            }\n          );\n    \n          await PromiseUtils.wait(bubbleTime * 2000);\n          //\n          field.active = false;\n          field.getChildByName('farm_wheat_l').active = false\n          await PromiseUtils.wait(bubbleTime * 2000);\n          //\n          const food = _.find(ProductsItemUrl.ItemCfg, (item) => {\n            return item.id === actionData.params.itemId;\n          });\n          WebUtils.getResouceImg(\n            food.url,\n            npc.getChildByName(\"bubble\")\n          );\n          npc.getChildByName('count').active = true\n          await PromiseUtils.wait(bubbleTime * 2000);\n          npc.getChildByName('count').active = false\n          npc.getChildByName(\"bubble\").active = false;\n          const startTile = this._getTilePos(\n            new Vec2(npc.getPosition().x, npc.getPosition().y)\n          );\n          const finishTile = this._getTilePos(\n            new Vec2(\n              npc.getPosition().x + adaptX * 32,\n              npc.getPosition().y + adaptY * 32\n            )\n          );\n          npc\n            .getChildByName(\"NPCinstantiate\")\n            .getComponent(NPCControl)\n            .aStartMove(\n              new Vec2(startTile.x, startTile.y),\n              new Vec2(finishTile.x, finishTile.y),\n              () => {\n                npc\n                  .getChildByName(\"NPCinstantiate\")\n                  .getComponent(NPCControl)\n                  .setNPCMoveDirect(KeyCode.KEY_A);\n              }\n            );\n    \n          fieldIndexX = fieldIndexX + 1;\n          if(fieldIndexX >= 9){\n            // let json = new network.NpcActionDone();\n            // json.command = 10008;\n            // json.type = 1;\n            // json.data.bid = actionData.bid\n            // json.data.npcId = actionData.npcId\n            // json.data.objId = actionData.params.oid\n            // socket.sendWebSocketBinary(json);\n          }\n          await PromiseUtils.wait(bubbleTime * 2000);\n        }\n\n        item.removeFromParent()\n        this[`info_${actionData.params.oid}`].fieldNode = null\n      }\n\n    //!\n    async butcherFeeding(npc: Node, actionData: DataEvents){\n      const img = 'action/bubble/farm/wheat'\n      WebUtils.getResouceImg(\n        img,\n        npc.getChildByName(\"bubble\"),\n        () => {\n          npc.getChildByName(\"bubble\").active = true;\n        }\n      );\n      npc.getChildByName('count').getComponent(Label).string = `-${actionData.params.count}`\n      npc.getChildByName('count').active = true\n      await PromiseUtils.wait(bubbleTime * 2000);\n      npc.getChildByName('count').active = false\n\n\n      WebUtils.getResouceImg(\n        BubbleImgUrl.clean,\n        npc.getChildByName(\"bubble\"),\n        () => {\n          npc.getChildByName(\"bubble\").active = true;\n        }\n      );\n      //npc.getChildByName('count').active = true\n      await PromiseUtils.wait(bubbleTime * 2000);\n      //npc.getChildByName('count').active = false\n\n      npc.getChildByName(\"bubble\").active = false;\n      \n    }\n\n    async butcherSkill(npc: Node, actionData: DataEvents){\n      const img = 'action/bubble/farm/wheat'\n      WebUtils.getResouceImg(\n        BubbleImgUrl.knife,\n        npc.getChildByName(\"bubble\"),\n        () => {\n          npc.getChildByName(\"bubble\").active = true;\n        }\n      );\n      await PromiseUtils.wait(bubbleTime * 2000);\n\n      WebUtils.getResouceImg(\n        'action/bubble/cook/hock',\n        npc.getChildByName(\"bubble\"),\n        () => {\n          npc.getChildByName(\"bubble\").active = true;\n        }\n      );\n      npc.getChildByName('count').active = true\n      npc.getChildByName('count').getComponent(Label).string = `+${actionData.params.count}`\n      await PromiseUtils.wait(bubbleTime * 2000);\n      npc.getChildByName('count').active = false\n      npc.getChildByName(\"bubble\").active = false;\n    }\n\n    async breadMake(npc: Node, actionData: DataEvents){\n      const img = 'action/bubble/farm/wheat'\n      WebUtils.getResouceImg(\n        'action/bubble/farm/wheat',\n        npc.getChildByName(\"bubble\"),\n        () => {\n          npc.getChildByName(\"bubble\").active = true;\n        }\n      );\n      npc.getChildByName('count').getComponent(Label).string = `-${actionData.params.items[0].count}`\n      npc.getChildByName('count').active = true\n      await PromiseUtils.wait(bubbleTime * 2000);\n      npc.getChildByName('count').active = false\n\n      WebUtils.getResouceImg(\n        'action/bubble/cook/bread',\n        npc.getChildByName(\"bubble\"),\n        () => {\n          npc.getChildByName(\"bubble\").active = true;\n        }\n      );\n      npc.getChildByName('count').getComponent(Label).string = `+${actionData.params.items[0].count}`\n      npc.getChildByName('count').active = true\n      await PromiseUtils.wait(bubbleTime * 2000);\n      npc.getChildByName('count').active = false\n      npc.getChildByName(\"bubble\").active = false;\n    }\n\n    //\n    async sale(npc: Node, actionData: DataEvents){\n      const item = _.find(ProductsItemUrl.ItemCfg, (item) => {\n        return item.id === actionData.params.itemId;\n      });\n      WebUtils.getResouceImg(\n        item.url,\n        npc.getChildByName(\"bubble\"),\n        () => {\n          npc.getChildByName(\"bubble\").active = true;\n        }\n      );\n      npc.getChildByName('count').getComponent(Label).string = `-${actionData.params.count}`\n      npc.getChildByName('count').active = true\n      await PromiseUtils.wait(bubbleTime * 2000);\n      npc.getChildByName('count').active = false\n\n      WebUtils.getResouceImg(\n        'action/bubble/sale/money',\n        npc.getChildByName(\"bubble\"),\n        () => {\n          npc.getChildByName(\"bubble\").active = true;\n        }\n      );\n\n      npc.getChildByName('count').getComponent(Label).string = `+${actionData.params.count * actionData.params.price}`\n      npc.getChildByName('count').active = true\n      await PromiseUtils.wait(bubbleTime * 2000);\n      npc.getChildByName('count').active = false\n      npc.getChildByName(\"bubble\").active = false;\n    }\n\n    async buy(npc: Node, actionData: DataEvents){\n      const item = _.find(ProductsItemUrl.ItemCfg, (item) => {\n        return item.id === actionData.params.itemId;\n      });\n      WebUtils.getResouceImg(\n        'action/bubble/sale/money',\n        npc.getChildByName(\"bubble\"),\n        () => {\n          npc.getChildByName(\"bubble\").active = true;\n        }\n      );\n      npc.getChildByName('count').getComponent(Label).string = `-${actionData.params.count * actionData.params.price}`\n      npc.getChildByName('count').active = true\n      await PromiseUtils.wait(bubbleTime * 2000);\n      npc.getChildByName('count').active = false\n\n      WebUtils.getResouceImg(\n        item.url,\n        npc.getChildByName(\"bubble\"),\n        () => {\n          npc.getChildByName(\"bubble\").active = true;\n        }\n      );\n      npc.getChildByName('count').getComponent(Label).string = `+${actionData.params.count}`\n      npc.getChildByName('count').active = true\n      await PromiseUtils.wait(bubbleTime * 2000);\n      npc.getChildByName('count').active = false\n      npc.getChildByName(\"bubble\").active = false;\n    }\n\n    speak(npc, actionData){\n      npc.getChildByName('speakContent').getComponent(Label).string = actionData.params.content\n      npc.getChildByName('speakContent').active = true\n    }\n\n  stopFarming(npc: Node, cb?: () => void) {\n    npc.getChildByName(\"bubble\").active = false;\n  }\n\n  //?\n  async playNPCAction(actions: any) {\n    //!\n    const actionData : DataEvents= actions.data.data\n    const npc = _.find(this.otherNPCarr, (item) => {\n      return (\n        item.getChildByName(\"NPCinstantiate\").getComponent(NPCControl).NpcID ===\n        actionData.npcId\n      );\n    });\n    let eventPox\n    let finishTile\n\n    const startTile = this._getTilePos(\n      new Vec2(npc.getPosition().x, npc.getPosition().y)\n    );\n    try {\n          \n      if(actionData.actionId === NpcEventType.speak){\n        const toNpc = _.find(this.otherNPCarr, (item) => {\n          return (\n            item.getChildByName(\"NPCinstantiate\").getComponent(NPCControl).NpcID ===\n            actionData.params.npcId\n          );\n        });\n        const toPos = this._getTilePos(\n          new Vec2(toNpc.getPosition().x, toNpc.getPosition().y)\n        );\n        eventPox = toNpc.getPosition()\n        finishTile = toPos;\n      }else{\n        finishTile =  this._getTilePos(new Vec2(eventPox.x, eventPox.y));\n      }\n\n  } catch (error) {\n      \n  }\n    \n    let cb: any;\n\n    //!\n    if (actionData.actionId === NpcEventType.sleep) {\n      cb = () => {\n        const nodes = this.getSleepNode(actionData.npcId);\n        this.setNpcDirect(npc, actionData, \"sleepHeadDirect\");\n        this.npcSleep(npc, nodes.head, nodes.bubble, async () => {\n          npc.getChildByName(\"bubble\").active = false;\n          npc.active = false;\n          const shouldSend = await this.checkPlayerId(actionData)\n          if(!shouldSend){\n            return\n          }\n          let json = new network.NpcActionDone();\n          json.command = 10008;\n          json.type = 1;\n          json.data.bid = actionData.bid\n          json.data.npcId = actionData.npcId\n          json.data.objId = actionData.params.oid\n          json.data.x = eventPox.x\n          json.data.y = hight - eventPox.y\n          json.data.isFinish = 1 \n          json.data.state = 1 \n          json.data.params = {\n            oid: actionData.params.oid\n          }\n          socket.sendWebSocketBinary(json);\n        });\n      };\n    } else if (actionData.actionId === NpcEventType.cook) {\n      cb = async () => {\n        this.setNpcDirect(npc, actionData, \"cookHeadDirect\");\n        await this.npcCook(npc, actionData);\n      };\n    } else if (actionData.actionId === NpcEventType.dinning) {\n      cb = async () => {\n        this.setNpcDirect(npc, actionData, \"diningHeadDirect\");\n        await this.npcDinning(npc, actionData);\n        const shouldSend = await this.checkPlayerId(actionData)\n        if(!shouldSend){\n          return\n        }\n        let json = new network.NpcActionDone();\n        json.command = 10008;\n        json.type = 1;\n        json.data.bid = actionData.bid\n        json.data.npcId = actionData.npcId\n        json.data.objId = actionData.params.oid\n        json.data.x = eventPox.x\n        json.data.y = hight - eventPox.y\n        json.data.isFinish = 1 \n        json.data.state = 1 \n        json.data.params = {\n          oid: actionData.params.oid,\n          itemId: actionData.params.itemId,\n          count: 1,\n        }\n        socket.sendWebSocketBinary(json);\n      };\n    } else if (actionData.actionId === NpcEventType.farming) {\n      cb = async () => {\n\n        npc\n          .getChildByName(\"NPCinstantiate\")\n          .getComponent(NPCControl)\n          .setNPCMoveDirect(KeyCode.KEY_A);\n        await PromiseUtils.wait(bubbleTime * 2000);\n        await this.npcFarming(npc, actionData);\n        const shouldSend = await this.checkPlayerId(actionData)\n        if(!shouldSend){\n          return\n        }\n        let json = new network.NpcActionDone();\n        json.command = 10008;\n        json.type = 1;\n        json.data.bid = actionData.bid\n        json.data.npcId = actionData.npcId\n        json.data.objId = actionData.params.oid\n        json.data.x = eventPox.x\n        json.data.y = hight - eventPox.y\n        json.data.isFinish = 1 \n        json.data.state = 1 \n        json.data.params = {\n          oid: actionData.params.oid,\n          itemId: actionData.params.itemId,\n          count: 9,\n        }\n        socket.sendWebSocketBinary(json);\n      };\n    } else if (actionData.actionId === NpcEventType.harvest){\n        cb = async () => {\n            npc\n            .getChildByName(\"NPCinstantiate\")\n            .getComponent(NPCControl)\n            .setNPCMoveDirect(KeyCode.KEY_A);\n            await PromiseUtils.wait(bubbleTime * 2000);\n            await this.npcHarvest(npc,actionData)\n            const shouldSend = await this.checkPlayerId(actionData)\n            if(!shouldSend){\n              return\n            }\n            let json = new network.NpcActionDone();\n            json.command = 10008;\n            json.type = 1;\n            json.data.bid = actionData.bid\n            json.data.npcId = actionData.npcId\n            json.data.objId = actionData.params.oid\n            json.data.x = eventPox.x\n            json.data.y = hight - eventPox.y\n            json.data.isFinish = 1 \n            json.data.state = 1 \n            json.data.params = {\n              oid: actionData.params.oid\n            }\n            socket.sendWebSocketBinary(json);\n          };\n\n    } else if (actionData.actionId === NpcEventType.getup){\n        cb = async ()=>{\n          const shouldSend = await this.checkPlayerId(actionData)\n          if(!shouldSend){\n            return\n          }\n            let json = new network.NpcActionDone();\n            json.command = 10008;\n            json.type = 1;\n            json.data.bid = actionData.bid\n            json.data.npcId = actionData.npcId\n            json.data.objId = actionData.params.oid\n            json.data.x = eventPox.x\n            json.data.y = hight - eventPox.y\n            json.data.isFinish = 1 \n            json.data.state = 1 \n            json.data.params = {\n              oid: actionData.params.oid\n            }\n            socket.sendWebSocketBinary(json);\n        }\n\n    } else if(actionData.actionId === NpcEventType.move){\n      cb = async () => {\n        const shouldSend = await this.checkPlayerId(actionData)\n        if(!shouldSend){\n          return\n        }\n        let json = new network.NpcActionDone();\n        json.command = 10008;\n        json.type = 1;\n        json.data.npcId = actionData.npcId\n        json.data.actionId = 112\n        json.data.x = eventPox.x\n        json.data.y = hight - eventPox.y\n        json.data.isFinish = 1 \n        json.data.state = 1 \n        json.data.bid = actionData.bid\n        socket.sendWebSocketBinary(json);\n      };\n    } else if(actionData.actionId === NpcEventType.move){\n      cb = async () => {\n        const shouldSend = await this.checkPlayerId(actionData)\n        if(!shouldSend){\n          return\n        }\n        let json = new network.NpcActionDone();\n        json.command = 10008;\n        json.type = 1;\n        json.data.npcId = actionData.npcId\n        json.data.actionId = 112\n        json.data.x = eventPox.x\n        json.data.y = hight - eventPox.y\n        json.data.isFinish = 1 \n        json.data.state = 1 \n        json.data.bid = actionData.bid\n        socket.sendWebSocketBinary(json);\n      };\n    } else if(actionData.actionId === NpcEventType.speak){\n      cb = async () => {\n        this.speak(npc, actionData)\n        const shouldSend = await this.checkPlayerId(actionData)\n        if(!shouldSend){\n          return\n        }\n        let json = new network.NpcActionDone();\n\n        json.command = 10008;\n        json.type = 1;\n        json.data.bid = actionData.bid\n        json.data.npcId = actionData.npcId\n        json.data.objId = actionData.params.oid\n        json.data.x = eventPox.x\n        json.data.y = hight - eventPox.y\n        json.data.isFinish = 1 \n        json.data.state = 1 \n        socket.sendWebSocketBinary(json);\n      };\n    } else if(actionData.actionId === NpcEventType.buy){\n      cb = async () => {\n        await this.buy(npc, actionData,)\n        const shouldSend = await this.checkPlayerId(actionData)\n        if(!shouldSend){\n          return\n        }\n        let json = new network.NpcActionDone();\n        json.command = 10008;\n        json.type = 1;\n        json.data.bid = actionData.bid\n        json.data.npcId = actionData.npcId\n        json.data.objId = actionData.params.oid\n        json.data.x = eventPox.x\n        json.data.y = hight - eventPox.y\n        json.data.isFinish = 1 \n        json.data.state = 1 \n        socket.sendWebSocketBinary(json);\n      };\n    } else if(actionData.actionId === NpcEventType.sale){\n      cb = async () => {\n        await this.sale(npc, actionData,)\n        const shouldSend = await this.checkPlayerId(actionData)\n        if(!shouldSend){\n          return\n        }\n        let json = new network.NpcActionDone();\n        json.command = 10008;\n        json.type = 1;\n        json.data.bid = actionData.bid\n        json.data.npcId = actionData.npcId\n        json.data.objId = actionData.params.oid\n        json.data.x = eventPox.x\n        json.data.y = hight - eventPox.y\n        json.data.isFinish = 1 \n        json.data.state = 1 \n        socket.sendWebSocketBinary(json);\n      };\n    } else if(actionData.actionId === NpcEventType.slaughter){\n      cb = async () => {\n        await this.butcherSkill(npc, actionData,)\n        const shouldSend = await this.checkPlayerId(actionData)\n        if(!shouldSend){\n          return\n        }\n        let json = new network.NpcActionDone();\n        json.command = 10008;\n        json.type = 1;\n        json.data.bid = actionData.bid\n        json.data.npcId = actionData.npcId\n        json.data.objId = actionData.params.oid\n        json.data.x = eventPox.x\n        json.data.y = hight - eventPox.y\n        json.data.isFinish = 1 \n        json.data.state = 1 \n        socket.sendWebSocketBinary(json);\n      };\n    } else if(actionData.actionId === NpcEventType.make){\n      cb = async () => {\n        await this.breadMake(npc, actionData,)\n        const shouldSend = await this.checkPlayerId(actionData)\n        if(!shouldSend){\n          return\n        }\n        let json = new network.NpcActionDone();\n        json.command = 10008;\n        json.type = 1;\n        json.data.bid = actionData.bid\n        json.data.npcId = actionData.npcId\n        json.data.objId = actionData.params.oid\n        json.data.x = eventPox.x\n        json.data.y = hight - eventPox.y\n        json.data.isFinish = 1 \n        json.data.state = 1 \n        socket.sendWebSocketBinary(json);\n      };\n    } else if(actionData.actionId === NpcEventType.feeding){\n      cb = async () => {\n        await this.butcherFeeding(npc, actionData,)\n        const shouldSend = await this.checkPlayerId(actionData)\n        if(!shouldSend){\n          return\n        }\n        let json = new network.NpcActionDone();\n        json.command = 10008;\n        json.type = 1;\n        json.data.bid = actionData.bid\n        json.data.npcId = actionData.npcId\n        json.data.objId = actionData.params.oid\n        json.data.x = eventPox.x\n        json.data.y = hight - eventPox.y\n        json.data.isFinish = 1 \n        json.data.state = 1 \n        socket.sendWebSocketBinary(json);\n      };\n    }\n\n    // if(startTile.x === finishTile.x && startTile.y === finishTile.y){\n    //     return\n    // }\n\n      this.stopActionNormal(npc, actionData);\n      npc\n        .getChildByName(\"NPCinstantiate\")\n        .getComponent(NPCControl)\n        .aStartMove(\n          new Vec2(startTile.x, startTile.y),\n          new Vec2(finishTile.x, finishTile.y),\n          cb\n        );\n    \n\n  }\n\n  async setFieldReady(actionData: any) {\n    \n    const farmItem = _.find(ProductsItemUrl.ItemCfg, (item) => {\n      return item.id === actionData.params.itemId;\n    })\n\n    const item = instantiate(this[farmItem.fieldName]) as Node;\n    item.setParent(this[actionData.params.oid])\n    this[`info_${actionData.params.oid}`].fieldNode = item\n    item.setPosition(new Vec3(0,0,0))\n    const fieldArr: Node[] = [...item.children]\n    if(!fieldArr){\n      return\n    }\n    let fieldIndexX = 1;\n    let adaptX;\n    let adaptY;\n    for (const field of fieldArr) {\n        field.active = true\n        await PromiseUtils.wait(bubbleTime * 2000);\n        field.getChildByName('farm_wheat_l').active = true\n    }\n  }\n\n  setNpcDirect(npc: Node, actionData: DataEvents, directType: string) {\n    const direct = EventNpcInfoMap[actionData.npcId][directType];\n    npc\n      .getChildByName(\"NPCinstantiate\")\n      .getComponent(NPCControl)\n      .setNPCMoveDirect(direct);\n  }\n\n  //?\n  finishNPCAction(farmAction: DataFarmEvent) {}\n\n  initPlayerNPC(myNPC: NPCServerD) {\n    this._curPlayerTile = this._getTilePos(new Vec2(9, 11));\n    //this.player.parent.getComponent(NPCControl).NpcID = myNPC.id;\n    this.player.parent.getComponent(NPCControl)._curTile = new Vec2(9, 11);\n    const pos = this._layerFloor.getPositionAt(this._curPlayerTile)!;\n    this.player.parent.parent.setPosition(300, 1000);\n    if (this.player.parent.getComponent(NPCControl).camera) {\n      const gameView = view.getVisibleSize();\n      let mainCamera = this.player.parent.getComponent(NPCControl).camera.node;\n      mainCamera.setPosition(pos.x, pos.y);\n\n      // if (pos.x < gameView.x) {\n      //   mainCamera.setPosition(gameView.x, mainCamera.getPosition().y);\n      // } else if (pos.x > hight - gameView.x) {\n      //   mainCamera.setPosition(hight - gameView.x, mainCamera.getPosition().y);\n      // } else {\n      //   mainCamera.setPosition(pos.x, mainCamera.getPosition().y);\n      // }\n      // if (pos.y < gameView.y) {\n      //   mainCamera.setPosition(mainCamera.getPosition().x, gameView.y);\n      // } else if (pos.y > hight - gameView.y) {\n      //   mainCamera.setPosition(mainCamera.getPosition().x, hight - gameView.y);\n      // } else {\n      //   mainCamera.setPosition(mainCamera.getPosition().x, pos.y);\n      // }\n    }\n    //this.player.parent.getComponent(NPCControl).camera.node.setPosition(myNPC.x, myNPC.y)\n    //  'hair'id  100 \n    //const hairPartInfo = getPartInfo('hair', myNPC.hair);\n    // WebUtils.getResouceImg(\n    //   this.getPartInfo(\"hair\", myNPC.hair).frame_path,\n    //   this.player.getChildByName(\"hair\")\n    // );\n    // WebUtils.getResouceImg(\n    //   this.getPartInfo(\"shirt\", myNPC.top).frame_path,\n    //   this.player.getChildByName(\"shirt\")\n    // );\n    // WebUtils.getResouceImg(\n    //   this.getPartInfo(\"pants\", myNPC.bottoms).frame_path,\n    //   this.player.getChildByName(\"pants\")\n    // );\n    this.loading.active = false;\n  }\n\n  initOtherNPCs(myNPC: NPCServerD[]) {\n    myNPC.forEach((NPC: NPCServerD) => {\n      this.initOtherNPC(NPC);\n    });\n  }\n\n  initOtherNPC(NPC: NPCServerD) {\n    let item = instantiate(this.playerInstantiate) as Node;\n    item.active = true;\n    this.playerLayer.addChild(item);\n    //this.tiledLayer.addUserNode(item)\n    item.getChildByName(\"NPCinstantiate\").getComponent(NPCControl).NpcID =\n      NPC.id;\n    this.otherNPCarr.push(item);\n    let npcTile = new Vec2();\n    const isValueIncluded = _.includes([10002, 10003, 10004, 10005], NPC.id);\n    if (isValueIncluded) {\n      npcTile = this._getTilePos(\n        new Vec2(NPC.x * PosAdapt, hight - NPC.y * PosAdapt)\n      );\n    }\n    const pos = this._layerFloor.getPositionAt(npcTile)!;\n    this._npcTileArray.push(npcTile);\n    item.getChildByName(\"NPCinstantiate\").getComponent(NPCControl)._curTile =\n      npcTile;\n    item.setPosition(pos.x, pos.y);\n    item.getChildByName(\"NPCinstantiate\").getComponent(NPCControl).npcIndex =\n    NpcIndex[NPC.id];\n    this.scheduleOnce(() => {\n      WebUtils.getResouceImg(\n        this.getPartInfo(\"body\", NPC.model)?.frame_path,\n        item\n          .getChildByName(\"NPCinstantiate\")\n          .getChildByName(\"npc_root\")\n          .getChildByName(\"body\")\n      );\n      WebUtils.getResouceImg(\n        \"\",\n        item\n          .getChildByName(\"NPCinstantiate\")\n          .getChildByName(\"npc_root\")\n          .getChildByName(\"hair\")\n      );\n      WebUtils.getResouceImg(\n        \"\",\n        item\n          .getChildByName(\"NPCinstantiate\")\n          .getChildByName(\"npc_root\")\n          .getChildByName(\"shirt\")\n      );\n      WebUtils.getResouceImg(\n        \"\",\n        item\n          .getChildByName(\"NPCinstantiate\")\n          .getChildByName(\"npc_root\")\n          .getChildByName(\"pants\")\n      );\n      if (NPC.model <= 10001) {\n        this.getPartInfo(\"hair\", NPC.hair)?.frame_path &&\n          WebUtils.getResouceImg(\n            this.getPartInfo(\"hair\", NPC.hair)?.frame_path,\n            item\n              .getChildByName(\"NPCinstantiate\")\n              .getChildByName(\"npc_root\")\n              .getChildByName(\"hair\")\n          );\n        this.getPartInfo(\"shirt\", NPC.top)?.frame_path &&\n          WebUtils.getResouceImg(\n            this.getPartInfo(\"shirt\", NPC.top)?.frame_path,\n            item\n              .getChildByName(\"NPCinstantiate\")\n              .getChildByName(\"npc_root\")\n              .getChildByName(\"shirt\")\n          );\n        this.getPartInfo(\"pants\", NPC.bottoms)?.frame_path &&\n          WebUtils.getResouceImg(\n            this.getPartInfo(\"pants\", NPC.bottoms)?.frame_path,\n            item\n              .getChildByName(\"NPCinstantiate\")\n              .getChildByName(\"npc_root\")\n              .getChildByName(\"pants\")\n          );\n      }\n    }, 0);\n  }\n\n  initOtherNPCByData(data: any) {\n    this.initOtherNPC(data.data.myNpc);\n  }\n\n  removeNPC(data: any) {\n    const offLineNPC = _.find(\n      this.otherNPCarr,\n      (item) => item?.getComponent(NPCControl)?.NpcID === data?.data?.npcIds[0]\n    );\n    offLineNPC?.removeFromParent();\n    this.otherNPCarr = _.remove(\n      this.otherNPCarr,\n      (item) => item?.getComponent(NPCControl)?.NpcID !== data?.data?.npcIds[0]\n    );\n  }\n\n  updateOtherPlayerInfo(data: any) {\n    if (this.player.parent.getComponent(NPCControl).NpcID === data.data.npcId) {\n      return;\n    }\n    const moveNPC = _.find(\n      this.otherNPCarr,\n      (item) =>\n        item.getChildByName(\"NPCinstantiate\").getComponent(NPCControl).NpcID ===\n        data.data.npcId\n    );\n    let steepKey: KeyCode;\n    if (data.data.x > moveNPC.getPosition().x) {\n      steepKey = KeyCode.KEY_D;\n    }\n    if (data.data.x < moveNPC.getPosition().x) {\n      steepKey = KeyCode.KEY_A;\n    }\n    if (data.data.y < moveNPC.getPosition().y) {\n      steepKey = KeyCode.KEY_S;\n    }\n    if (data.data.y > moveNPC.getPosition().y) {\n      steepKey = KeyCode.KEY_W;\n    }\n    moveNPC\n      .getChildByName(\"NPCinstantiate\")\n      .getComponent(NPCControl)\n      .setNPCMoveDirect(steepKey);\n\n    moveNPC\n      .getChildByName(\"NPCinstantiate\")\n      .getComponent(NPCControl)\n      .setMoveSprite(steepKey);\n    moveNPC\n      .getChildByName(\"NPCinstantiate\")\n      .getComponent(NPCControl)\n      .setNPCPosition(steepKey);\n    tween(moveNPC)\n      .to(\n        0.05,\n        { position: new Vec3(data.data.x, data.data.y, 0) },\n        {\n          onComplete: () => {\n            //this.ClientPlayerMoveCallBack(tilePos, pid);\n            // let json = new network.NpcActionDone();\n            // json.command = 10008;\n            // json.type = 1;\n            // json.data.actionId = 112\n            // json.data.npcId = data.data.npcId\n            // json.data.x = moveNPC.getPosition().x\n            // json.data.y = hight - moveNPC.getPosition().y\n            // json.data.isFinish = 1 \n            // json.data.state = 1 \n            // socket.sendWebSocketBinary(json);\n          },\n        }\n      )\n      .start();\n  }\n\n  _getTilePos(posInPixel: { x: number; y: number }) {\n    const mapSize = this.node.getComponent(UITransform).contentSize;\n    const tileSize = this.getComponent(TiledMap).getTileSize();\n    const x = Math.floor(posInPixel.x / tileSize.width);\n    const y = Math.floor((mapSize.height - posInPixel.y) / tileSize.height);\n    return new Vec2(x, y - 1);\n  }\n\n  protected onDestroy(): void {\n    observer.off(EventType.SOCKET_GETALL_NPCS, this.setNPCPos, this);\n    // observer.off(EventType.SOCKET_ONLINE_NPCS, this.initOtherNPC, this)\n    // observer.off(EventType.SOCKET_OFFLINE_NPCS, this.removeNPC, this)\n  }\n\n  async testFarmRound(){\n    // await PromiseUtils.wait(bubbleTime * 1000);\n    // window.farmcook()\n    // await PromiseUtils.wait(bubbleTime * 20000);\n    // window.farmeat()\n    // await PromiseUtils.wait(bubbleTime * 10000);\n    // window.farm()\n    // await PromiseUtils.wait(bubbleTime * 80000);\n    // window.farmGoSleep()\n    // await PromiseUtils.wait(bubbleTime * 80000);\n    // window.fieldReady()\n    // await PromiseUtils.wait(bubbleTime * 10000);\n    // window.farmHarvest()\n    // await PromiseUtils.wait(bubbleTime * 80000);\n    // this.testFrameIndex = 0\n  }\n\n  async testBakerRound(){\n    // await PromiseUtils.wait(bubbleTime * 1000);\n    // window.bakerCook()\n    // await PromiseUtils.wait(bubbleTime * 60000);\n    // window.bakerDinning()\n    // await PromiseUtils.wait(bubbleTime * 10000);\n    // window.bakerSleep()\n    // await PromiseUtils.wait(bubbleTime * 40000);\n    // this.testbakerIndex = 0\n  }\n\n  async updateObjectStateChange(data){\n    data?.data && data.data.forEach(async (object)=>{\n      if(object.objId === 'farmland1' || object.objId === 'farmland2' || object.objId === 'farmland3' || object.objId === 'farmland4'){\n        if(object.state === '2'){\n          await this.setFieldReady({\n            params:{\n              oid: object.objId,\n              itemId: object.params.itemId\n            }\n\n          })\n        }\n      }\n    })\n\n  }\n\n  async objectStateChange(data){\n    if(data.data.oid === 'farmland1' || data.data.oid === 'farmland3' || data.data.oid === 'farmland4'){\n      if(data.data.state === '2'){\n        await this.setFieldReady({\n          params:{\n            oid: data.oid,\n            itemId: data.params.itemId\n          }\n        })\n      }\n\n    }\n  }\n\n  async update(deltaTime: number) {\n    this.sleepFrameAdd = this.sleepFrameAdd + deltaTime;\n    if (this.sleepFrameAdd > sleepFrameTime) {\n      this.setNpcHomeBed(this.homeBedFrameIndex);\n      this.homeBedFrameIndex = ++this.homeBedFrameIndex > 1 ? 0 : 1;\n      this.sleepFrameAdd = 0;\n    }\n\n    if(this.testbakerIndex === 0){\n        this.testbakerIndex = this.testbakerIndex + deltaTime\n        this.testBakerRound()\n    }\n    if(this.testFrameIndex === 0){\n        this.testFrameIndex = this.testFrameIndex + deltaTime\n        await this.testFarmRound()\n    }\n\n\n  }\n}\n"]}