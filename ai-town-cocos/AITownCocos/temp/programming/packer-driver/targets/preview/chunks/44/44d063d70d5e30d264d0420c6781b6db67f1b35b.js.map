{"version":3,"sources":["file:///Users/feiwang/AITown/AITownCocos/assets/src/town/TownView.ts"],"names":["_decorator","Component","instantiate","KeyCode","Label","Node","TiledLayer","TiledMap","TiledObjectGroup","tween","UITransform","Vec2","Vec3","view","modelMgr","observer","socket","EventType","network","WebUtils","BubbleImgUrl","EventNpcInfoMap","NpcEventType","NpcIndex","NPCPartDisplayInfo","ProductsItemUrl","NPCControl","_","PromiseUtils","GlobalConfig","ccclass","property","sleepFramePosX","sleepFrameTime","bubbleTime","hight","wight","PosAdapt","TownView","type","_curPlayerTile","_npcTileArray","sleepFrameAdd","homeBedFrameIndex","info_farmland1","farmland","fieldNode","info_farmland2","info_farmland3","info_farmland4","testFrameIndex","testbakerIndex","_layerFloor","start","json","GetAllNPCRequest","command","sendWebSocketBinary","townModel","refreshItemDate","on","SOCKET_GETALL_NPCS","setNPCPos","SOCKET_ONLINE_NPCS","initOtherNPCByData","SOCKET_OFFLINE_NPCS","removeNPC","SOCKET_NPC_ACTION","playNPCAction","SOCKET_ITEM_STATE_CHANGE","objectStateChange","SOCKET_ITEMUPDATE","updateObjectStateChange","node","getComponent","getLayer","window","herdSleep","data","bid","actionId","npcId","params","oid","herdCook","items","itemId","count","herdDinning","farm","farmHarvest","farmGoSleep","farmStopSleep","farmcook","farmeat","fieldReady","setFieldReady","bakerSleep","bakerCook","bakerDinning","GrocerSleep","GrocerCook","GrocerDinning","NPCs","initPlayerNPC","myNpc","otherNpc","initOtherNPCs","checkPlayerId","actionData","item","find","users","instance","LoginData","player","playerId","length","setNpcHomeBed","currentIndex","farmHomeBedHead","setPosition","getPosition","y","herdmanHomeBedHead","bakerHomeBedHead","grocerHomeBedHead","getPartInfo","label","id","part","getSleepNode","head","bubble","farmHomeBedBubble","herdmanBedBubble","bakerBedBubble","grocerBedBubble","stopNpcSleep","npc","cb","active","npcSleep","getResouceImg","sleep","getChildByName","scheduleOnce","sendEventOver","NpcActionDone","objId","x","isFinish","state","npcCook","food","ItemCfg","foodItem","url","wait","cook","shouldSend","stopCook","npcDinning","eating","dinning","getDinning","afterDinner","eat","farmDinning","grocerDinning","stopDinning","stopActionNormal","setItemCountChange","npcFarming","farmItem","fieldName","setParent","fieldArr","children","fieldIndexX","adaptX","adaptY","field","farmerHoe","farmerWater","startTile","_getTilePos","finishTile","aStartMove","setNPCMoveDirect","KEY_A","npcHarvest","farmerSickle","removeFromParent","butcherFeeding","img","string","clean","butcherSkill","knife","breadMake","sale","price","buy","speak","content","stopFarming","actions","otherNPCarr","NpcID","eventPox","toNpc","toPos","moveToPos","getTileGIDAt","tileObject","getObject","error","nodes","setNpcDirect","farming","harvest","getup","move","slaughter","make","feeding","directType","direct","finishNPCAction","farmAction","myNPC","parent","_curTile","pos","getPositionAt","camera","gameView","getVisibleSize","mainCamera","loading","forEach","NPC","initOtherNPC","playerInstantiate","playerLayer","addChild","push","npcTile","isValueIncluded","includes","curViewNpcX","curViewNpcY","npcIndex","model","frame_path","hair","top","bottoms","offLineNPC","npcIds","remove","updateOtherPlayerInfo","moveNPC","steepKey","KEY_D","KEY_S","KEY_W","setMoveSprite","setNPCPosition","to","position","onComplete","posInPixel","mapSize","contentSize","tileSize","getTileSize","Math","floor","width","height","onDestroy","off","testFarmRound","testBakerRound","object","update","deltaTime"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACEA,MAAAA,U,OAAAA,U;AACAC,MAAAA,S,OAAAA,S;AACAC,MAAAA,W,OAAAA,W;AACAC,MAAAA,O,OAAAA,O;AACAC,MAAAA,K,OAAAA,K;AACAC,MAAAA,I,OAAAA,I;AACAC,MAAAA,U,OAAAA,U;AACAC,MAAAA,Q,OAAAA,Q;AACAC,MAAAA,gB,OAAAA,gB;AACAC,MAAAA,K,OAAAA,K;AACAC,MAAAA,W,OAAAA,W;AACAC,MAAAA,I,OAAAA,I;AACAC,MAAAA,I,OAAAA,I;AACAC,MAAAA,I,OAAAA,I;;AAEOC,MAAAA,Q,iBAAAA,Q;AAAUC,MAAAA,Q,iBAAAA,Q;AAAUC,MAAAA,M,iBAAAA,M;;AACpBC,MAAAA,S,iBAAAA,S;;AAEAC,MAAAA,O,iBAAAA,O;;AACFC,MAAAA,Q;;AAELC,MAAAA,Y,iBAAAA,Y;AACAC,MAAAA,e,iBAAAA,e;AACAC,MAAAA,Y,iBAAAA,Y;AACAC,MAAAA,Q,iBAAAA,Q;AACAC,MAAAA,kB,iBAAAA,kB;AACAC,MAAAA,e,iBAAAA,e;;AAEmBC,MAAAA,U,iBAAAA,U;;AACdC,MAAAA,C;;AAEEC,MAAAA,Y,iBAAAA,Y;;AACAC,MAAAA,Y,iBAAAA,Y;;;;;;;;;OAEH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwB/B,U;;gCACjBgC,c,GAAiB,CAAC,EAAD,EAAK,CAAC,EAAN,C;;gCACjBC,c,GAAiB,I;;4BACjBC,U,GAAa,G;;uBAEbC,K,GAAQ,I;;uBAERC,K,GAAQ,G,GACrB;;;AACMC,MAAAA,Q,GAAW,C;;0BAyBJC,Q,WADZR,OAAO,CAAC,UAAD,C,UAELC,QAAQ,CAAC;AAAEQ,QAAAA,IAAI,EAAE,CAAClC,IAAD;AAAR,OAAD,C,UAGR0B,QAAQ,CAAC1B,IAAD,C,UAGR0B,QAAQ,CAAC1B,IAAD,C,UAGR0B,QAAQ,CAAC1B,IAAD,C,UAGR0B,QAAQ,CAAC1B,IAAD,C,UAGR0B,QAAQ,CAAC;AAAEQ,QAAAA,IAAI,EAAE/B;AAAR,OAAD,C,UAGRuB,QAAQ,CAAC1B,IAAD,C,UAGR0B,QAAQ,CAAC1B,IAAD,C,WAGR0B,QAAQ,CAAC1B,IAAD,C,WAGR0B,QAAQ,CAAC1B,IAAD,C,WAGR0B,QAAQ,CAAC1B,IAAD,C,WAGR0B,QAAQ,CAAC1B,IAAD,C,WAGR0B,QAAQ,CAAC1B,IAAD,C,WAGR0B,QAAQ,CAAC1B,IAAD,C,WAGR0B,QAAQ,CAAC1B,IAAD,C,WAGR0B,QAAQ,CAAC1B,IAAD,C,WAGR0B,QAAQ,CAAC1B,IAAD,C,WAGR0B,QAAQ,CAAC1B,IAAD,C,WAGR0B,QAAQ,CAAC1B,IAAD,C,WAGR0B,QAAQ,CAAC1B,IAAD,C,WAGR0B,QAAQ,CAAC1B,IAAD,C,WAGR0B,QAAQ,CAAC1B,IAAD,C,WAGR0B,QAAQ,CAAC1B,IAAD,C,WAGR0B,QAAQ,CAAC1B,IAAD,C,WAGR0B,QAAQ,CAAC1B,IAAD,C,WAGR0B,QAAQ,CAAC1B,IAAD,C,2BA7EX,MACaiC,QADb,SAC8BrC,SAD9B,CACwC;AAAA;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA,eA+E9BuC,cA/E8B,GA+Eb,IAAI7B,IAAJ,EA/Ea;AAAA,eAiFtC8B,aAjFsC,GAiFd,EAjFc;AAAA,eAkFtCC,aAlFsC,GAkFtB,CAlFsB;AAAA,eAmFtCC,iBAnFsC,GAmFlB,CAnFkB;AAAA,eAqFtCC,cArFsC,GAqFrB;AACfC,YAAAA,QAAQ,EAAE,WADK;AAEfC,YAAAA,SAAS,EAAE;AAFI,WArFqB;AAAA,eA0FtCC,cA1FsC,GA0FrB;AACfF,YAAAA,QAAQ,EAAE,WADK;AAEfC,YAAAA,SAAS,EAAE;AAFI,WA1FqB;AAAA,eA+FtCE,cA/FsC,GA+FrB;AACfH,YAAAA,QAAQ,EAAE,WADK;AAEfC,YAAAA,SAAS,EAAE;AAFI,WA/FqB;AAAA,eAoGtCG,cApGsC,GAoGrB;AACfJ,YAAAA,QAAQ,EAAE,WADK;AAEfC,YAAAA,SAAS,EAAE;AAFI,WApGqB;AAyGtC;AAEA;AAEA;AA7GsC,eA+GtCI,cA/GsC,GA+GrB,CA/GqB;AAAA,eAgHtCC,cAhHsC,GAgHrB,CAhHqB;AAAA,eAkH9BC,WAlH8B,GAkHJ,IAlHI;AAAA;;AAmHhCC,QAAAA,KAAK,GAAG;AAAA;;AAAA;AACZ,gBAAIC,IAAI,GAAG,IAAI;AAAA;AAAA,oCAAQC,gBAAZ,EAAX;AACAD,YAAAA,IAAI,CAACE,OAAL,GAAe,KAAf;AACAF,YAAAA,IAAI,CAACf,IAAL,GAAY,CAAZ;AACA;AAAA;AAAA,kCAAOkB,mBAAP,CAA2BH,IAA3B;AAEA;AAAA;AAAA,sCAASI,SAAT,CAAmBC,eAAnB;AAEA;AAAA;AAAA,sCAASC,EAAT,CAAY;AAAA;AAAA,wCAAUC,kBAAtB,EAA0C,KAAI,CAACC,SAA/C,EAA0D,KAA1D;AACA;AAAA;AAAA,sCAASF,EAAT,CAAY;AAAA;AAAA,wCAAUG,kBAAtB,EAA0C,KAAI,CAACC,kBAA/C,EAAmE,KAAnE;AACA;AAAA;AAAA,sCAASJ,EAAT,CAAY;AAAA;AAAA,wCAAUK,mBAAtB,EAA2C,KAAI,CAACC,SAAhD,EAA2D,KAA3D,EAVY,CAWZ;;AACA;AAAA;AAAA,sCAASN,EAAT,CAAY;AAAA;AAAA,wCAAUO,iBAAtB,EAAyC,KAAI,CAACC,aAA9C,EAA6D,KAA7D;AAEA;AAAA;AAAA,sCAASR,EAAT,CACE;AAAA;AAAA,wCAAUS,wBADZ,EAEE,KAAI,CAACC,iBAFP,EAGE,KAHF;AAMA;AAAA;AAAA,sCAASV,EAAT,CACE;AAAA;AAAA,wCAAUW,iBADZ,EAEE,KAAI,CAACC,uBAFP,EAGE,KAHF;AAMA;AAAA;AAAA,sCAASZ,EAAT,CACE;AAAA;AAAA,wCAAUW,iBADZ,EAEE,KAAI,CAACC,uBAFP,EAGE,KAHF;AAMA,YAAA,KAAI,CAACpB,WAAL,GAAmB,KAAI,CAACqB,IAAL,CAAUC,YAAV,CAAuBnE,QAAvB,EAAiCoE,QAAjC,CAA0C,UAA1C,CAAnB,CAhCY,CAkCZ;AAEA;AAEA;AACA;;AACAC,YAAAA,MAAM,CAACC,SAAP,GAAmB,MAAM;AACvB,cAAA,KAAI,CAACT,aAAL,CAAmB;AACjBU,gBAAAA,IAAI,EAAE;AACJA,kBAAAA,IAAI,EAAE;AACJC,oBAAAA,GAAG,EAAE,EADD;AAEJC,oBAAAA,QAAQ,EAAE,GAFN;AAGJC,oBAAAA,KAAK,EAAE,KAHH;AAIJC,oBAAAA,MAAM,EAAE;AACNC,sBAAAA,GAAG,EAAE;AADC;AAJJ;AADF;AADW,eAAnB;AAYD,aAbD;;AAeAP,YAAAA,MAAM,CAACQ,QAAP,GAAkB,MAAM;AACtB,cAAA,KAAI,CAAChB,aAAL,CAAmB;AACjBU,gBAAAA,IAAI,EAAE;AACJA,kBAAAA,IAAI,EAAE;AACJC,oBAAAA,GAAG,EAAE,EADD;AAEJC,oBAAAA,QAAQ,EAAE,GAFN;AAGJC,oBAAAA,KAAK,EAAE,KAHH;AAIJC,oBAAAA,MAAM,EAAE;AACNC,sBAAAA,GAAG,EAAE,cADC;AAENE,sBAAAA,KAAK,EAAE,CACL;AACEC,wBAAAA,MAAM,EAAE,QADV;AAEEC,wBAAAA,KAAK,EAAE;AAFT,uBADK,EAKL;AACED,wBAAAA,MAAM,EAAE,QADV;AAEEC,wBAAAA,KAAK,EAAE;AAFT,uBALK,EASL;AACED,wBAAAA,MAAM,EAAE,QADV;AAEEC,wBAAAA,KAAK,EAAE;AAFT,uBATK;AAFD;AAJJ;AADF;AADW,eAAnB;AA0BD,aA3BD;;AA6BAX,YAAAA,MAAM,CAACY,WAAP,GAAqB,MAAM;AACzB,cAAA,KAAI,CAACpB,aAAL,CAAmB;AACjBW,gBAAAA,GAAG,EAAE,EADY;AAEjBC,gBAAAA,QAAQ,EAAE,GAFO;AAGjBC,gBAAAA,KAAK,EAAE,KAHU;AAIjBC,gBAAAA,MAAM,EAAE;AACNC,kBAAAA,GAAG,EAAE;AADC;AAJS,eAAnB;AAQD,aATD,CApFY,CA+FZ;;;AAEAP,YAAAA,MAAM,CAACa,IAAP,kCAAc,aAAY;AACxB,oBAAM,KAAI,CAACrB,aAAL,CAAmB;AACvBU,gBAAAA,IAAI,EAAE;AACJA,kBAAAA,IAAI,EAAE;AACJC,oBAAAA,GAAG,EAAE,EADD;AAEJC,oBAAAA,QAAQ,EAAE,GAFN;AAGJC,oBAAAA,KAAK,EAAE,KAHH;AAIJC,oBAAAA,MAAM,EAAE;AACNC,sBAAAA,GAAG,EAAE,WADC;AAENG,sBAAAA,MAAM,EAAE;AAFF;AAJJ;AADF;AADiB,eAAnB,CAAN;AAaD,aAdD;;AAgBAV,YAAAA,MAAM,CAACc,WAAP,GAAqB,MAAM;AACzB,cAAA,KAAI,CAACtB,aAAL,CAAmB;AACjBU,gBAAAA,IAAI,EAAE;AACJA,kBAAAA,IAAI,EAAE;AACJC,oBAAAA,GAAG,EAAE,EADD;AAEJC,oBAAAA,QAAQ,EAAE,GAFN;AAGJC,oBAAAA,KAAK,EAAE,KAHH;AAIJC,oBAAAA,MAAM,EAAE;AACNC,sBAAAA,GAAG,EAAE,WADC;AAENE,sBAAAA,KAAK,EAAE,CACL;AACEC,wBAAAA,MAAM,EAAE,QADV;AAEEC,wBAAAA,KAAK,EAAE;AAFT,uBADK;AAFD;AAJJ;AADF;AADW,eAAnB;AAkBD,aAnBD;;AAqBAX,YAAAA,MAAM,CAACe,WAAP,GAAqB,MAAM;AACzB,cAAA,KAAI,CAACvB,aAAL,CAAmB;AACjBU,gBAAAA,IAAI,EAAE;AACJA,kBAAAA,IAAI,EAAE;AACJC,oBAAAA,GAAG,EAAE,EADD;AAEJC,oBAAAA,QAAQ,EAAE,GAFN;AAGJC,oBAAAA,KAAK,EAAE,KAHH;AAIJC,oBAAAA,MAAM,EAAE;AACNC,sBAAAA,GAAG,EAAE;AADC;AAJJ;AADF;AADW,eAAnB;AAYD,aAbD;;AAeAP,YAAAA,MAAM,CAACgB,aAAP,GAAuB,MAAM;AAC3B,cAAA,KAAI,CAACxB,aAAL,CAAmB;AACjBU,gBAAAA,IAAI,EAAE;AACJA,kBAAAA,IAAI,EAAE;AACJC,oBAAAA,GAAG,EAAE,EADD;AAEJC,oBAAAA,QAAQ,EAAE,GAFN;AAGJC,oBAAAA,KAAK,EAAE,KAHH;AAIJC,oBAAAA,MAAM,EAAE;AACNC,sBAAAA,GAAG,EAAE;AADC;AAJJ;AADF;AADW,eAAnB;AAYD,aAbD;;AAeAP,YAAAA,MAAM,CAACiB,QAAP,GAAkB,MAAM;AACtB,cAAA,KAAI,CAACzB,aAAL,CAAmB;AACjBW,gBAAAA,GAAG,EAAE,EADY;AAEjBC,gBAAAA,QAAQ,EAAE,GAFO;AAGjBC,gBAAAA,KAAK,EAAE,KAHU;AAIjBC,gBAAAA,MAAM,EAAE;AACNC,kBAAAA,GAAG,EAAE,YADC;AAENE,kBAAAA,KAAK,EAAE,CACL;AACEC,oBAAAA,MAAM,EAAE,QADV;AAEEC,oBAAAA,KAAK,EAAE;AAFT,mBADK,EAKL;AACED,oBAAAA,MAAM,EAAE,QADV;AAEEC,oBAAAA,KAAK,EAAE;AAFT,mBALK,EASL;AACED,oBAAAA,MAAM,EAAE,QADV;AAEEC,oBAAAA,KAAK,EAAE;AAFT,mBATK;AAFD;AAJS,eAAnB;AAsBD,aAvBD;;AAyBAX,YAAAA,MAAM,CAACkB,OAAP,GAAiB,MAAM;AACrB,cAAA,KAAI,CAAC1B,aAAL,CAAmB;AACjBW,gBAAAA,GAAG,EAAE,EADY;AAEjBC,gBAAAA,QAAQ,EAAE,GAFO;AAGjBC,gBAAAA,KAAK,EAAE,KAHU;AAIjBC,gBAAAA,MAAM,EAAE;AACNC,kBAAAA,GAAG,EAAE;AADC;AAJS,eAAnB;AAQD,aATD;;AAWAP,YAAAA,MAAM,CAACmB,UAAP,GAAoB,MAAM;AACxB,cAAA,KAAI,CAACC,aAAL,CAAmB;AACjBjB,gBAAAA,GAAG,EAAE,EADY;AAEjBC,gBAAAA,QAAQ,EAAE,GAFO;AAGjBC,gBAAAA,KAAK,EAAE,KAHU;AAIjBC,gBAAAA,MAAM,EAAE;AACNC,kBAAAA,GAAG,EAAE;AADC;AAJS,eAAnB;AAQD,aATD,CAxMY,CAmNZ;;;AACAP,YAAAA,MAAM,CAACqB,UAAP,GAAoB,MAAM;AACxB,cAAA,KAAI,CAAC7B,aAAL,CAAmB;AACjBW,gBAAAA,GAAG,EAAE,EADY;AAEjBC,gBAAAA,QAAQ,EAAE,GAFO;AAGjBC,gBAAAA,KAAK,EAAE,KAHU;AAIjBC,gBAAAA,MAAM,EAAE;AACNC,kBAAAA,GAAG,EAAE;AADC;AAJS,eAAnB;AAQD,aATD;;AAWAP,YAAAA,MAAM,CAACsB,SAAP,GAAmB,MAAM;AACvB,cAAA,KAAI,CAAC9B,aAAL,CAAmB;AACjBW,gBAAAA,GAAG,EAAE,EADY;AAEjBC,gBAAAA,QAAQ,EAAE,GAFO;AAGjBC,gBAAAA,KAAK,EAAE,KAHU;AAIjBC,gBAAAA,MAAM,EAAE;AACNC,kBAAAA,GAAG,EAAE,WADC;AAENE,kBAAAA,KAAK,EAAE,CACL;AACEC,oBAAAA,MAAM,EAAE,QADV;AAEEC,oBAAAA,KAAK,EAAE;AAFT,mBADK,EAKL;AACED,oBAAAA,MAAM,EAAE,QADV;AAEEC,oBAAAA,KAAK,EAAE;AAFT,mBALK,EASL;AACED,oBAAAA,MAAM,EAAE,QADV;AAEEC,oBAAAA,KAAK,EAAE;AAFT,mBATK;AAFD;AAJS,eAAnB;AAsBD,aAvBD;;AAyBAX,YAAAA,MAAM,CAACuB,YAAP,GAAsB,MAAM;AAC1B,cAAA,KAAI,CAAC/B,aAAL,CAAmB;AACjBW,gBAAAA,GAAG,EAAE,EADY;AAEjBC,gBAAAA,QAAQ,EAAE,GAFO;AAGjBC,gBAAAA,KAAK,EAAE,KAHU;AAIjBC,gBAAAA,MAAM,EAAE;AACNC,kBAAAA,GAAG,EAAE;AADC;AAJS,eAAnB;AAQD,aATD,CAxPY,CAkQZ;;;AACAP,YAAAA,MAAM,CAACwB,WAAP,GAAqB,MAAM;AACzB,cAAA,KAAI,CAAChC,aAAL,CAAmB;AACjBW,gBAAAA,GAAG,EAAE,EADY;AAEjBC,gBAAAA,QAAQ,EAAE,GAFO;AAGjBC,gBAAAA,KAAK,EAAE,KAHU;AAIjBC,gBAAAA,MAAM,EAAE;AACNC,kBAAAA,GAAG,EAAE;AADC;AAJS,eAAnB;AAQD,aATD;;AAWAP,YAAAA,MAAM,CAACyB,UAAP,GAAoB,MAAM;AACxB,cAAA,KAAI,CAACjC,aAAL,CAAmB;AACjBW,gBAAAA,GAAG,EAAE,EADY;AAEjBC,gBAAAA,QAAQ,EAAE,GAFO;AAGjBC,gBAAAA,KAAK,EAAE,KAHU;AAIjBC,gBAAAA,MAAM,EAAE;AACNC,kBAAAA,GAAG,EAAE,WADC;AAENE,kBAAAA,KAAK,EAAE,CACL;AACEC,oBAAAA,MAAM,EAAE,QADV;AAEEC,oBAAAA,KAAK,EAAE;AAFT,mBADK,EAKL;AACED,oBAAAA,MAAM,EAAE,QADV;AAEEC,oBAAAA,KAAK,EAAE;AAFT,mBALK,EASL;AACED,oBAAAA,MAAM,EAAE,QADV;AAEEC,oBAAAA,KAAK,EAAE;AAFT,mBATK;AAFD;AAJS,eAAnB;AAsBD,aAvBD;;AAyBAX,YAAAA,MAAM,CAAC0B,aAAP,GAAuB,MAAM;AAC3B,cAAA,KAAI,CAAClC,aAAL,CAAmB;AACjBW,gBAAAA,GAAG,EAAE,EADY;AAEjBC,gBAAAA,QAAQ,EAAE,GAFO;AAGjBC,gBAAAA,KAAK,EAAE,KAHU;AAIjBC,gBAAAA,MAAM,EAAE;AACNC,kBAAAA,GAAG,EAAE;AADC;AAJS,eAAnB;AAQD,aATD,CAvSY,CAiTZ;AACA;AACA;;AAnTY;AAoTb;;AAEDrB,QAAAA,SAAS,CAACyC,IAAD,EAAY;AAAA;;AACnB,cAAI,CAACA,IAAL,EAAW;AACT;AACD;;AACD,eAAKC,aAAL,CAAmBD,IAAI,CAACzB,IAAL,CAAUA,IAAV,CAAe2B,KAAlC;AACA,WAAAF,IAAI,QAAJ,kBAAAA,IAAI,CAAEzB,IAAN,sCAAYA,IAAZ,gCAAkB4B,QAAlB,KAA8B,KAAKC,aAAL,CAAmBJ,IAAI,CAACzB,IAAL,CAAUA,IAAV,CAAe4B,QAAlC,CAA9B;AACD;;AAEKE,QAAAA,aAAa,CAACC,UAAD,EAAa;AAAA;AAAA;;AAC9B,gBAAMC,IAAI,GAAG;AAAA;AAAA,wBAAEC,IAAF,CAAOF,UAAU,CAACG,KAAlB,EAA0BF,IAAD,IAAU;AAC9C,qBAAOA,IAAI,KAAK;AAAA;AAAA,gDAAaG,QAAb,CAAsBC,SAAtB,CAAgCpC,IAAhC,CAAqCqC,MAArC,CAA4CC,QAA5D;AACD,aAFY,CAAb;;AAGA,gBAAIN,IAAI,IAAI,EAACD,UAAD,iCAACA,UAAU,CAAEG,KAAb,aAAC,kBAAmBK,MAApB,CAAZ,EAAwC;AACtC,qBAAO,IAAP;AACD,aAFD,MAEO;AACL,qBAAO,KAAP;AACD;AAR6B;AAS/B;;AAEDC,QAAAA,aAAa,CAACC,YAAD,EAAuB;AAClC,eAAKC,eAAL,CAAqBC,WAArB,CACEzF,cAAc,CAACuF,YAAD,CADhB,EAEE,KAAKC,eAAL,CAAqBE,WAArB,GAAmCC,CAFrC;AAIA,eAAKC,kBAAL,CAAwBH,WAAxB,CACEzF,cAAc,CAACuF,YAAD,CADhB,EAEE,KAAKK,kBAAL,CAAwBF,WAAxB,GAAsCC,CAFxC;AAIA,eAAKE,gBAAL,CAAsBJ,WAAtB,CACEzF,cAAc,CAACuF,YAAD,CADhB,EAEE,KAAKM,gBAAL,CAAsBH,WAAtB,GAAoCC,CAFtC;AAIA,eAAKG,iBAAL,CAAuBL,WAAvB,CACEzF,cAAc,CAACuF,YAAD,CADhB,EAEE,KAAKO,iBAAL,CAAuBJ,WAAvB,GAAqCC,CAFvC;AAID;;AAEDI,QAAAA,WAAW,CAACC,KAAD,EAAgBC,EAAhB,EAA4B;AAAA;;AACrC,0CAAO;AAAA;AAAA,wDAAmBD,KAAnB,CAAP,qBAAO,OAA2BjB,IAA3B,CAAiCmB,IAAD,IAAUA,IAAI,CAACD,EAAL,KAAYA,EAAtD,CAAP,0BAAoE,IAApE;AACD,SAjdqC,CAmdtC;;;AACAE,QAAAA,YAAY,CAAClD,KAAD,EAAgB;AAC1B,kBAAQA,KAAR;AACE,iBAAK,KAAL;AACE,qBAAO;AACLmD,gBAAAA,IAAI,EAAE,KAAKZ,eADN;AAELa,gBAAAA,MAAM,EAAE,KAAKC;AAFR,eAAP;;AAIF,iBAAK,KAAL;AACE,qBAAO;AACLF,gBAAAA,IAAI,EAAE,KAAKR,kBADN;AAELS,gBAAAA,MAAM,EAAE,KAAKE;AAFR,eAAP;;AAIF,iBAAK,KAAL;AACE,qBAAO;AACLH,gBAAAA,IAAI,EAAE,KAAKP,gBADN;AAELQ,gBAAAA,MAAM,EAAE,KAAKG;AAFR,eAAP;;AAIF,iBAAK,KAAL;AACE,qBAAO;AACLJ,gBAAAA,IAAI,EAAE,KAAKN,iBADN;AAELO,gBAAAA,MAAM,EAAE,KAAKI;AAFR,eAAP,CADF,CAKE;;AACA;;AACF;AACE,qBAAO;AACLL,gBAAAA,IAAI,EAAE,KAAKZ,eADN;AAELa,gBAAAA,MAAM,EAAE,KAAKC;AAFR,eAAP;AAIA;AA5BJ;AA8BD;;AAEDI,QAAAA,YAAY,CAACC,GAAD,EAAY9B,UAAZ,EAAoC+B,EAApC,EAAqD;AAC/D,kBAAQ/B,UAAU,CAAC5B,KAAnB;AACE,iBAAK,KAAL;AACE,mBAAKuC,eAAL,CAAqBqB,MAArB,GAA8B,KAA9B;AACA,mBAAKP,iBAAL,CAAuBO,MAAvB,GAAgC,KAAhC;AACAF,cAAAA,GAAG,CAACE,MAAJ,GAAa,IAAb;AACA;;AACF,iBAAK,KAAL;AACE,mBAAKjB,kBAAL,CAAwBiB,MAAxB,GAAiC,KAAjC;AACA,mBAAKN,gBAAL,CAAsBM,MAAtB,GAA+B,KAA/B;AACAF,cAAAA,GAAG,CAACE,MAAJ,GAAa,IAAb;AACA;;AACF,iBAAK,KAAL;AACE,mBAAKhB,gBAAL,CAAsBgB,MAAtB,GAA+B,KAA/B;AACA,mBAAKL,cAAL,CAAoBK,MAApB,GAA6B,KAA7B;AACAF,cAAAA,GAAG,CAACE,MAAJ,GAAa,IAAb;AACA;;AACF,iBAAK,KAAL;AACE,mBAAKf,iBAAL,CAAuBe,MAAvB,GAAgC,KAAhC;AACA,mBAAKJ,eAAL,CAAqBI,MAArB,GAA8B,KAA9B;AACAF,cAAAA,GAAG,CAACE,MAAJ,GAAa,IAAb;AACA,oBAJF,CAKE;;AACA;;AACF;AACE;AAxBJ;AA0BD;;AAEDC,QAAAA,QAAQ,CAACH,GAAD,EAAYP,IAAZ,EAAwBC,MAAxB,EAAsCO,EAAtC,EAAuD;AAC7D;AAAA;AAAA,oCAASG,aAAT,CACE;AAAA;AAAA,4CAAaC,KADf,EAEEL,GAAG,CAACM,cAAJ,CAAmB,QAAnB,CAFF,EAGE,MAAM;AACJN,YAAAA,GAAG,CAACM,cAAJ,CAAmB,QAAnB,EAA6BJ,MAA7B,GAAsC,IAAtC;AACD,WALH;AAOA,eAAKK,YAAL,CAAkB,MAAM;AACtBN,YAAAA,EAAE;AACFR,YAAAA,IAAI,CAACS,MAAL,GAAc,IAAd;AACAR,YAAAA,MAAM,CAACQ,MAAP,GAAgB,IAAhB;AACD,WAJD,EAIG3G,UAJH;AAKD;;AAEDiH,QAAAA,aAAa,CAACtC,UAAD,EAAyB8B,GAAzB,EAA8B;AACzC,cAAIrF,IAAI,GAAG,IAAI;AAAA;AAAA,kCAAQ8F,aAAZ,EAAX;AACA9F,UAAAA,IAAI,CAACE,OAAL,GAAe,KAAf;AACAF,UAAAA,IAAI,CAACf,IAAL,GAAY,CAAZ;AACAe,UAAAA,IAAI,CAACwB,IAAL,CAAUC,GAAV,GAAgB8B,UAAU,CAAC9B,GAA3B;AACAzB,UAAAA,IAAI,CAACwB,IAAL,CAAUG,KAAV,GAAkB4B,UAAU,CAAC5B,KAA7B;AACA3B,UAAAA,IAAI,CAACwB,IAAL,CAAUuE,KAAV,GAAkBxC,UAAU,CAAC3B,MAAX,CAAkBC,GAApC;AACA7B,UAAAA,IAAI,CAACwB,IAAL,CAAUwE,CAAV,GAAcX,GAAG,CAACjB,WAAJ,GAAkB4B,CAAhC;AACAhG,UAAAA,IAAI,CAACwB,IAAL,CAAU6C,CAAV,GAAcxF,KAAK,GAAGwG,GAAG,CAACjB,WAAJ,GAAkBC,CAAxC;AACArE,UAAAA,IAAI,CAACwB,IAAL,CAAUyE,QAAV,GAAqB,CAArB;AACAjG,UAAAA,IAAI,CAACwB,IAAL,CAAU0E,KAAV,GAAkB,CAAlB;AACAlG,UAAAA,IAAI,CAACwB,IAAL,CAAUI,MAAV,GAAmB;AACjBC,YAAAA,GAAG,EAAE0B,UAAU,CAAC3B,MAAX,CAAkBC,GADN;AAEjBG,YAAAA,MAAM,EAAEuB,UAAU,CAAC3B,MAAX,CAAkBI,MAFT;AAGjBC,YAAAA,KAAK,EAAE;AAHU,WAAnB;AAKA;AAAA;AAAA,gCAAO9B,mBAAP,CAA2BH,IAA3B;AACD,SAljBqC,CAojBtC;;;AACMmG,QAAAA,OAAO,CAACd,GAAD,EAAY9B,UAAZ,EAAoC+B,EAApC,EAAqD;AAAA;;AAAA;AAAA,kDAChB;AAC9C,kBAAMc,IAAI,GAAG;AAAA;AAAA,0BAAE3C,IAAF,CAAO;AAAA;AAAA,sDAAgB4C,OAAvB,EAAiC7C,IAAD,IAAU;AACrD,uBAAOA,IAAI,CAACmB,EAAL,KAAY2B,QAAQ,CAACtE,MAA5B;AACD,eAFY,CAAb;AAGA;AAAA;AAAA,wCAASyD,aAAT,CAAuBW,IAAI,CAACG,GAA5B,EAAiClB,GAAG,CAACM,cAAJ,CAAmB,QAAnB,CAAjC,EAA+D,MAAM;AACnEN,gBAAAA,GAAG,CAACM,cAAJ,CAAmB,QAAnB,EAA6BJ,MAA7B,GAAsC,IAAtC;AACD,eAFD;AAIA,oBAAM;AAAA;AAAA,gDAAaiB,IAAb,CAAkB5H,UAAU,GAAG,IAA/B,CAAN;AACA;AAAA;AAAA,wCAAS6G,aAAT,CAAuB;AAAA;AAAA,gDAAagB,IAApC,EAA0CpB,GAAG,CAACM,cAAJ,CAAmB,QAAnB,CAA1C;AAEA,kBAAMe,UAAU,SAAS,MAAI,CAACpD,aAAL,CAAmBC,UAAnB,CAAzB;;AAEA,kBAAImD,UAAJ,EAAgB;AACd,oBAAI1G,IAAI,GAAG,IAAI;AAAA;AAAA,wCAAQ8F,aAAZ,EAAX;AACA9F,gBAAAA,IAAI,CAACE,OAAL,GAAe,KAAf;AACAF,gBAAAA,IAAI,CAACf,IAAL,GAAY,CAAZ;AACAe,gBAAAA,IAAI,CAACwB,IAAL,CAAUC,GAAV,GAAgB8B,UAAU,CAAC9B,GAA3B;AACAzB,gBAAAA,IAAI,CAACwB,IAAL,CAAUG,KAAV,GAAkB4B,UAAU,CAAC5B,KAA7B;AACA3B,gBAAAA,IAAI,CAACwB,IAAL,CAAUuE,KAAV,GAAkBxC,UAAU,CAAC3B,MAAX,CAAkBC,GAApC;AACA7B,gBAAAA,IAAI,CAACwB,IAAL,CAAUwE,CAAV,GAAcX,GAAG,CAACjB,WAAJ,GAAkB4B,CAAhC;AACAhG,gBAAAA,IAAI,CAACwB,IAAL,CAAU6C,CAAV,GAAcxF,KAAK,GAAGwG,GAAG,CAACjB,WAAJ,GAAkBC,CAAxC;AACArE,gBAAAA,IAAI,CAACwB,IAAL,CAAUyE,QAAV,GAAqB,CAArB;AACAjG,gBAAAA,IAAI,CAACwB,IAAL,CAAU0E,KAAV,GAAkB,CAAlB;AACAlG,gBAAAA,IAAI,CAACwB,IAAL,CAAUI,MAAV,GAAmB;AACjBC,kBAAAA,GAAG,EAAE0B,UAAU,CAAC3B,MAAX,CAAkBC,GADN;AAEjBG,kBAAAA,MAAM,EAAEuB,UAAU,CAAC3B,MAAX,CAAkBI,MAFT;AAGjBC,kBAAAA,KAAK,EAAE;AAHU,iBAAnB;AAKA;AAAA;AAAA,sCAAO9B,mBAAP,CAA2BH,IAA3B;AACA,sBAAM;AAAA;AAAA,kDAAawG,IAAb,CAAkB5H,UAAU,GAAG,IAA/B,CAAN;AACD;AACF,aAjC+D;;AAChE,iBAAK,IAAM0H,QAAX,IAAuB/C,UAAU,CAAC3B,MAAX,CAAkBG,KAAzC;AAAA;AAAA;AADgE;AAkCjE;;AAED4E,QAAAA,QAAQ,CAACtB,GAAD,EAAYC,EAAZ,EAA6B;AACnCD,UAAAA,GAAG,CAACM,cAAJ,CAAmB,QAAnB,EAA6BJ,MAA7B,GAAsC,KAAtC;AACD,SA3lBqC,CA6lBtC;;;AACMqB,QAAAA,UAAU,CAACvB,GAAD,EAAY9B,UAAZ,EAAoC;AAAA;;AAAA;AAClD;AAAA;AAAA,sCAASkC,aAAT,CACE;AAAA;AAAA,8CAAaoB,MADf,EAEExB,GAAG,CAACM,cAAJ,CAAmB,QAAnB,CAFF,EAGE,MAAM;AACJN,cAAAA,GAAG,CAACM,cAAJ,CAAmB,QAAnB,EAA6BJ,MAA7B,GAAsC,IAAtC;AACD,aALH;;AAOA,gBAAMuB,OAAO,GAAG,MAAI,CAACC,UAAL,CAAgBxD,UAAU,CAAC5B,KAA3B,CAAhB;;AACA;AAAA;AAAA,sCAAS8D,aAAT,CAAuB;AAAA;AAAA,8CAAaqB,OAApC,EAA6CA,OAAO,CAACA,OAArD,EAA8D,MAAM;AAClEA,cAAAA,OAAO,CAACA,OAAR,CAAgBvB,MAAhB,GAAyB,IAAzB;AACD,aAFD;AAIA,kBAAM;AAAA;AAAA,8CAAaiB,IAAb,CAAkB5H,UAAU,GAAG,IAA/B,CAAN;AACA;AAAA;AAAA,sCAAS6G,aAAT,CAAuB;AAAA;AAAA,8CAAauB,WAApC,EAAiDF,OAAO,CAACA,OAAzD,EAAkE,MAAM;AACtE;AAAA;AAAA,wCAASrB,aAAT,CACE;AAAA;AAAA,gDAAawB,GADf,EAEE5B,GAAG,CAACM,cAAJ,CAAmB,QAAnB,CAFF,EAGE,MAAM,CAAE,CAHV;AAKD,aAND;AAOA,kBAAM;AAAA;AAAA,8CAAaa,IAAb,CAAkB5H,UAAU,GAAG,IAA/B,CAAN;AArBkD;AAsBnD;;AAEDmI,QAAAA,UAAU,CAACpF,KAAD,EAAgB;AACxB,kBAAQA,KAAR;AACE,iBAAK,KAAL;AACE,qBAAO;AACLmF,gBAAAA,OAAO,EAAE,KAAKI;AADT,eAAP;;AAGF,iBAAK,KAAL;AACE,qBAAO;AACLJ,gBAAAA,OAAO,EAAE,KAAK5E;AADT,eAAP;;AAGF,iBAAK,KAAL;AACE,qBAAO;AACL4E,gBAAAA,OAAO,EAAE,KAAKjE;AADT,eAAP;;AAGF,iBAAK,KAAL;AACE,qBAAO;AACLiE,gBAAAA,OAAO,EAAE,KAAKK;AADT,eAAP,CADF,CAIE;;AACA;;AACF;AACE,qBAAO;AACLL,gBAAAA,OAAO,EAAE,KAAKI;AADT,eAAP;AAGA;AAvBJ;AAyBD;;AAEDE,QAAAA,WAAW,CAAC/B,GAAD,EAAYC,EAAZ,EAA6B;AACtCD,UAAAA,GAAG,CAACM,cAAJ,CAAmB,QAAnB,EAA6BJ,MAA7B,GAAsC,KAAtC;AACD;;AAED8B,QAAAA,gBAAgB,CAAChC,GAAD,EAAY9B,UAAZ,EAAoC+B,EAApC,EAAqD;AACnE,eAAKF,YAAL,CAAkBC,GAAlB,EAAuB9B,UAAvB,EAAmC+B,EAAnC;AACAD,UAAAA,GAAG,CAACM,cAAJ,CAAmB,QAAnB,EAA6BJ,MAA7B,GAAsC,KAAtC;AACD;;AAED+B,QAAAA,kBAAkB,GAAG,CAAE,CA3pBe,CA6pBtC;;;AACMC,QAAAA,UAAU,CAAClC,GAAD,EAAY9B,UAAZ,EAAoC;AAAA;;AAAA;AAClD,gBAAI,CAAC,MAAI,CAACA,UAAU,CAAC3B,MAAX,CAAkBC,GAAnB,CAAT,EAAkC;AAChC;AACD;;AAED,gBAAM2F,QAAQ,GAAG;AAAA;AAAA,wBAAE/D,IAAF,CAAO;AAAA;AAAA,oDAAgB4C,OAAvB,EAAiC7C,IAAD,IAAU;AACzD,qBAAOA,IAAI,CAACmB,EAAL,KAAYpB,UAAU,CAAC3B,MAAX,CAAkBI,MAArC;AACD,aAFgB,CAAjB;AAIA,gBAAMwB,IAAI,GAAG5G,WAAW,CAAC,MAAI,CAAC4K,QAAQ,CAACC,SAAV,CAAL,CAAxB;AACAjE,YAAAA,IAAI,CAACkE,SAAL,CAAe,MAAI,CAACnE,UAAU,CAAC3B,MAAX,CAAkBC,GAAnB,CAAnB;AACA,YAAA,MAAI,WAAS0B,UAAU,CAAC3B,MAAX,CAAkBC,GAA3B,CAAJ,CAAsCrC,SAAtC,GAAkDgE,IAAlD;AACAA,YAAAA,IAAI,CAACW,WAAL,CAAiB,IAAI7G,IAAJ,CAAS,CAAT,EAAY,CAAZ,EAAe,CAAf,CAAjB;AACA,gBAAMqK,QAAgB,GAAG,CAAC,GAAGnE,IAAI,CAACoE,QAAT,CAAzB;AACArE,YAAAA,UAAU,CAAC3B,MAAX,CAAkBI,MAAlB;AAEA,gBAAI6F,WAAW,GAAG,CAAlB;AACA,gBAAIC,MAAJ;AACA,gBAAIC,MAAJ;;AACA,iBAAK,IAAMC,KAAX,IAAoBL,QAApB,EAA8B;AAC5B,kBAAIE,WAAW,GAAG,CAAd,KAAoB,CAAxB,EAA2B;AACzBC,gBAAAA,MAAM,GAAG,CAAC,CAAV;AACAC,gBAAAA,MAAM,GAAG,CAAT;AACD,eAHD,MAGO;AACLD,gBAAAA,MAAM,GAAG,CAAT;AACAC,gBAAAA,MAAM,GAAGF,WAAW,KAAK,CAAhB,IAAqBA,WAAW,KAAK,CAArC,GAAyC,CAAC,CAA1C,GAA8C,CAAvD;AACD,eAP2B,CAQ5B;;;AACA;AAAA;AAAA,wCAASpC,aAAT,CACE;AAAA;AAAA,gDAAawC,SADf,EAEE5C,GAAG,CAACM,cAAJ,CAAmB,QAAnB,CAFF,EAGE,MAAM;AACJN,gBAAAA,GAAG,CAACM,cAAJ,CAAmB,QAAnB,EAA6BJ,MAA7B,GAAsC,IAAtC;AACD,eALH;AAQA,oBAAM;AAAA;AAAA,gDAAaiB,IAAb,CAAkB5H,UAAU,GAAG,IAA/B,CAAN,CAjB4B,CAkB5B;;AACAoJ,cAAAA,KAAK,CAACzC,MAAN,GAAe,IAAf;AACA,oBAAM;AAAA;AAAA,gDAAaiB,IAAb,CAAkB5H,UAAU,GAAG,IAA/B,CAAN,CApB4B,CAqB5B;;AACA;AAAA;AAAA,wCAAS6G,aAAT,CACE;AAAA;AAAA,gDAAayC,WADf,EAEE7C,GAAG,CAACM,cAAJ,CAAmB,QAAnB,CAFF;AAIA,oBAAM;AAAA;AAAA,gDAAaa,IAAb,CAAkB5H,UAAU,GAAG,IAA/B,CAAN;;AAEA,kBAAMuJ,SAAS,GAAG,MAAI,CAACC,WAAL,CAChB,IAAI/K,IAAJ,CAASgI,GAAG,CAACjB,WAAJ,GAAkB4B,CAA3B,EAA8BX,GAAG,CAACjB,WAAJ,GAAkBC,CAAhD,CADgB,CAAlB;;AAGA,kBAAMgE,UAAU,GAAG,MAAI,CAACD,WAAL,CACjB,IAAI/K,IAAJ,CACEgI,GAAG,CAACjB,WAAJ,GAAkB4B,CAAlB,GAAsB8B,MAAM,GAAG,EADjC,EAEEzC,GAAG,CAACjB,WAAJ,GAAkBC,CAAlB,GAAsB0D,MAAM,GAAG,EAFjC,CADiB,CAAnB;;AAMA1C,cAAAA,GAAG,CACAM,cADH,CACkB,gBADlB,EAEGvE,YAFH;AAAA;AAAA,4CAGGkH,UAHH,CAII,IAAIjL,IAAJ,CAAS8K,SAAS,CAACnC,CAAnB,EAAsBmC,SAAS,CAAC9D,CAAhC,CAJJ,EAKI,IAAIhH,IAAJ,CAASgL,UAAU,CAACrC,CAApB,EAAuBqC,UAAU,CAAChE,CAAlC,CALJ,EAMI,MAAM;AACJgB,gBAAAA,GAAG,CACAM,cADH,CACkB,gBADlB,EAEGvE,YAFH;AAAA;AAAA,8CAGGmH,gBAHH,CAGoB1L,OAAO,CAAC2L,KAH5B;AAID,eAXL;AAcAX,cAAAA,WAAW,GAAGA,WAAW,GAAG,CAA5B;AACA,oBAAM;AAAA;AAAA,gDAAarB,IAAb,CAAkB5H,UAAU,GAAG,IAA/B,CAAN;AACD;AAxEiD;AAyEnD,SAvuBqC,CAyuBtC;;;AACM6J,QAAAA,UAAU,CAACpD,GAAD,EAAY9B,UAAZ,EAAoC;AAAA;;AAAA;AAClD,gBAAMiE,QAAQ,GAAG;AAAA;AAAA,wBAAE/D,IAAF,CAAO;AAAA;AAAA,oDAAgB4C,OAAvB,EAAiC7C,IAAD,IAAU;AACzD,qBAAOA,IAAI,CAACmB,EAAL,KAAYpB,UAAU,CAAC3B,MAAX,CAAkBI,MAArC;AACD,aAFgB,CAAjB;AAGA,gBAAMwB,IAAI,GAAG,MAAI,WAASD,UAAU,CAAC3B,MAAX,CAAkBC,GAA3B,CAAJ,CAAsCrC,SAAnD;AACA,gBAAMmI,QAAgB,GAAG,CAAC,GAAGnE,IAAI,CAACoE,QAAT,CAAzB;AACA,gBAAIC,WAAW,GAAG,CAAlB;AACA,gBAAIC,MAAJ;AACA,gBAAIC,MAAJ;;AACA,iBAAK,IAAMC,KAAX,IAAoBL,QAApB,EAA8B;AAC5B,kBAAIE,WAAW,GAAG,CAAd,KAAoB,CAAxB,EAA2B;AACzBC,gBAAAA,MAAM,GAAG,CAAC,CAAV;AACAC,gBAAAA,MAAM,GAAG,CAAT;AACD,eAHD,MAGO;AACLD,gBAAAA,MAAM,GAAG,CAAT;AACAC,gBAAAA,MAAM,GAAGF,WAAW,KAAK,CAAhB,IAAqBA,WAAW,KAAK,CAArC,GAAyC,CAAC,CAA1C,GAA8C,CAAvD;AACD,eAP2B,CAQ5B;;;AACA;AAAA;AAAA,wCAASpC,aAAT,CACE;AAAA;AAAA,gDAAaiD,YADf,EAEErD,GAAG,CAACM,cAAJ,CAAmB,QAAnB,CAFF,EAGE,MAAM;AACJN,gBAAAA,GAAG,CAACM,cAAJ,CAAmB,QAAnB,EAA6BJ,MAA7B,GAAsC,IAAtC;AACD,eALH;AAQA,oBAAM;AAAA;AAAA,gDAAaiB,IAAb,CAAkB5H,UAAU,GAAG,IAA/B,CAAN,CAjB4B,CAkB5B;;AACAoJ,cAAAA,KAAK,CAACzC,MAAN,GAAe,KAAf;AACAyC,cAAAA,KAAK,CAACrC,cAAN,CAAqB,cAArB,EAAqCJ,MAArC,GAA8C,KAA9C;AACA,oBAAM;AAAA;AAAA,gDAAaiB,IAAb,CAAkB5H,UAAU,GAAG,IAA/B,CAAN,CArB4B,CAsB5B;;AACA,kBAAMwH,IAAI,GAAG;AAAA;AAAA,0BAAE3C,IAAF,CAAO;AAAA;AAAA,sDAAgB4C,OAAvB,EAAiC7C,IAAD,IAAU;AACrD,uBAAOA,IAAI,CAACmB,EAAL,KAAYpB,UAAU,CAAC3B,MAAX,CAAkBI,MAArC;AACD,eAFY,CAAb;AAGA;AAAA;AAAA,wCAASyD,aAAT,CAAuBW,IAAI,CAACG,GAA5B,EAAiClB,GAAG,CAACM,cAAJ,CAAmB,QAAnB,CAAjC;AACAN,cAAAA,GAAG,CAACM,cAAJ,CAAmB,OAAnB,EAA4BJ,MAA5B,GAAqC,IAArC;AACA,oBAAM;AAAA;AAAA,gDAAaiB,IAAb,CAAkB5H,UAAU,GAAG,IAA/B,CAAN;AACAyG,cAAAA,GAAG,CAACM,cAAJ,CAAmB,OAAnB,EAA4BJ,MAA5B,GAAqC,KAArC;AACAF,cAAAA,GAAG,CAACM,cAAJ,CAAmB,QAAnB,EAA6BJ,MAA7B,GAAsC,KAAtC;;AACA,kBAAM4C,SAAS,GAAG,MAAI,CAACC,WAAL,CAChB,IAAI/K,IAAJ,CAASgI,GAAG,CAACjB,WAAJ,GAAkB4B,CAA3B,EAA8BX,GAAG,CAACjB,WAAJ,GAAkBC,CAAhD,CADgB,CAAlB;;AAGA,kBAAMgE,UAAU,GAAG,MAAI,CAACD,WAAL,CACjB,IAAI/K,IAAJ,CACEgI,GAAG,CAACjB,WAAJ,GAAkB4B,CAAlB,GAAsB8B,MAAM,GAAG,EADjC,EAEEzC,GAAG,CAACjB,WAAJ,GAAkBC,CAAlB,GAAsB0D,MAAM,GAAG,EAFjC,CADiB,CAAnB;;AAMA1C,cAAAA,GAAG,CACAM,cADH,CACkB,gBADlB,EAEGvE,YAFH;AAAA;AAAA,4CAGGkH,UAHH,CAII,IAAIjL,IAAJ,CAAS8K,SAAS,CAACnC,CAAnB,EAAsBmC,SAAS,CAAC9D,CAAhC,CAJJ,EAKI,IAAIhH,IAAJ,CAASgL,UAAU,CAACrC,CAApB,EAAuBqC,UAAU,CAAChE,CAAlC,CALJ,EAMI,MAAM;AACJgB,gBAAAA,GAAG,CACAM,cADH,CACkB,gBADlB,EAEGvE,YAFH;AAAA;AAAA,8CAGGmH,gBAHH,CAGoB1L,OAAO,CAAC2L,KAH5B;AAID,eAXL;AAcAX,cAAAA,WAAW,GAAGA,WAAW,GAAG,CAA5B;;AACA,kBAAIA,WAAW,IAAI,CAAnB,EAAsB,CACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACD;;AACD,oBAAM;AAAA;AAAA,gDAAarB,IAAb,CAAkB5H,UAAU,GAAG,IAA/B,CAAN;AACD;;AAED4E,YAAAA,IAAI,CAACmF,gBAAL;AACA,YAAA,MAAI,WAASpF,UAAU,CAAC3B,MAAX,CAAkBC,GAA3B,CAAJ,CAAsCrC,SAAtC,GAAkD,IAAlD;AA7EkD;AA8EnD,SAxzBqC,CA0zBtC;;;AACMoJ,QAAAA,cAAc,CAACvD,GAAD,EAAY9B,UAAZ,EAAoC;AAAA;AACtD,gBAAMsF,GAAG,GAAG,0BAAZ;AACA;AAAA;AAAA,sCAASpD,aAAT,CAAuBoD,GAAvB,EAA4BxD,GAAG,CAACM,cAAJ,CAAmB,QAAnB,CAA5B,EAA0D,MAAM;AAC9DN,cAAAA,GAAG,CAACM,cAAJ,CAAmB,QAAnB,EAA6BJ,MAA7B,GAAsC,IAAtC;AACD,aAFD;AAGAF,YAAAA,GAAG,CACAM,cADH,CACkB,OADlB,EAEGvE,YAFH,CAEgBtE,KAFhB,EAEuBgM,MAFvB,SAEoCvF,UAAU,CAAC3B,MAAX,CAAkBK,KAFtD;AAGAoD,YAAAA,GAAG,CAACM,cAAJ,CAAmB,OAAnB,EAA4BJ,MAA5B,GAAqC,IAArC;AACA,kBAAM;AAAA;AAAA,8CAAaiB,IAAb,CAAkB5H,UAAU,GAAG,IAA/B,CAAN;AACAyG,YAAAA,GAAG,CAACM,cAAJ,CAAmB,OAAnB,EAA4BJ,MAA5B,GAAqC,KAArC;AAEA;AAAA;AAAA,sCAASE,aAAT,CACE;AAAA;AAAA,8CAAasD,KADf,EAEE1D,GAAG,CAACM,cAAJ,CAAmB,QAAnB,CAFF,EAGE,MAAM;AACJN,cAAAA,GAAG,CAACM,cAAJ,CAAmB,QAAnB,EAA6BJ,MAA7B,GAAsC,IAAtC;AACD,aALH,EAZsD,CAmBtD;;AACA,kBAAM;AAAA;AAAA,8CAAaiB,IAAb,CAAkB5H,UAAU,GAAG,IAA/B,CAAN,CApBsD,CAqBtD;;AAEAyG,YAAAA,GAAG,CAACM,cAAJ,CAAmB,QAAnB,EAA6BJ,MAA7B,GAAsC,KAAtC;AAvBsD;AAwBvD;;AAEKyD,QAAAA,YAAY,CAAC3D,GAAD,EAAY9B,UAAZ,EAAoC;AAAA;AACpD,gBAAMsF,GAAG,GAAG,0BAAZ;AACA;AAAA;AAAA,sCAASpD,aAAT,CACE;AAAA;AAAA,8CAAawD,KADf,EAEE5D,GAAG,CAACM,cAAJ,CAAmB,QAAnB,CAFF,EAGE,MAAM;AACJN,cAAAA,GAAG,CAACM,cAAJ,CAAmB,QAAnB,EAA6BJ,MAA7B,GAAsC,IAAtC;AACD,aALH;AAOA,kBAAM;AAAA;AAAA,8CAAaiB,IAAb,CAAkB5H,UAAU,GAAG,IAA/B,CAAN;AAEA;AAAA;AAAA,sCAAS6G,aAAT,CACE,yBADF,EAEEJ,GAAG,CAACM,cAAJ,CAAmB,QAAnB,CAFF,EAGE,MAAM;AACJN,cAAAA,GAAG,CAACM,cAAJ,CAAmB,QAAnB,EAA6BJ,MAA7B,GAAsC,IAAtC;AACD,aALH;AAOAF,YAAAA,GAAG,CAACM,cAAJ,CAAmB,OAAnB,EAA4BJ,MAA5B,GAAqC,IAArC;AACAF,YAAAA,GAAG,CACAM,cADH,CACkB,OADlB,EAEGvE,YAFH,CAEgBtE,KAFhB,EAEuBgM,MAFvB,SAEoCvF,UAAU,CAAC3B,MAAX,CAAkBK,KAFtD;AAGA,kBAAM;AAAA;AAAA,8CAAauE,IAAb,CAAkB5H,UAAU,GAAG,IAA/B,CAAN;AACAyG,YAAAA,GAAG,CAACM,cAAJ,CAAmB,OAAnB,EAA4BJ,MAA5B,GAAqC,KAArC;AACAF,YAAAA,GAAG,CAACM,cAAJ,CAAmB,QAAnB,EAA6BJ,MAA7B,GAAsC,KAAtC;AAxBoD;AAyBrD;;AAEK2D,QAAAA,SAAS,CAAC7D,GAAD,EAAY9B,UAAZ,EAAoC;AAAA;AACjD,gBAAMsF,GAAG,GAAG,0BAAZ;AACA;AAAA;AAAA,sCAASpD,aAAT,CACE,0BADF,EAEEJ,GAAG,CAACM,cAAJ,CAAmB,QAAnB,CAFF,EAGE,MAAM;AACJN,cAAAA,GAAG,CAACM,cAAJ,CAAmB,QAAnB,EAA6BJ,MAA7B,GAAsC,IAAtC;AACD,aALH;AAOAF,YAAAA,GAAG,CACAM,cADH,CACkB,OADlB,EAEGvE,YAFH,CAEgBtE,KAFhB,EAEuBgM,MAFvB,SAEoCvF,UAAU,CAAC3B,MAAX,CAAkBG,KAAlB,CAAwB,CAAxB,EAA2BE,KAF/D;AAGAoD,YAAAA,GAAG,CAACM,cAAJ,CAAmB,OAAnB,EAA4BJ,MAA5B,GAAqC,IAArC;AACA,kBAAM;AAAA;AAAA,8CAAaiB,IAAb,CAAkB5H,UAAU,GAAG,IAA/B,CAAN;AACAyG,YAAAA,GAAG,CAACM,cAAJ,CAAmB,OAAnB,EAA4BJ,MAA5B,GAAqC,KAArC;AAEA;AAAA;AAAA,sCAASE,aAAT,CACE,0BADF,EAEEJ,GAAG,CAACM,cAAJ,CAAmB,QAAnB,CAFF,EAGE,MAAM;AACJN,cAAAA,GAAG,CAACM,cAAJ,CAAmB,QAAnB,EAA6BJ,MAA7B,GAAsC,IAAtC;AACD,aALH;AAOAF,YAAAA,GAAG,CACAM,cADH,CACkB,OADlB,EAEGvE,YAFH,CAEgBtE,KAFhB,EAEuBgM,MAFvB,SAEoCvF,UAAU,CAAC3B,MAAX,CAAkBG,KAAlB,CAAwB,CAAxB,EAA2BE,KAF/D;AAGAoD,YAAAA,GAAG,CAACM,cAAJ,CAAmB,OAAnB,EAA4BJ,MAA5B,GAAqC,IAArC;AACA,kBAAM;AAAA;AAAA,8CAAaiB,IAAb,CAAkB5H,UAAU,GAAG,IAA/B,CAAN;AACAyG,YAAAA,GAAG,CAACM,cAAJ,CAAmB,OAAnB,EAA4BJ,MAA5B,GAAqC,KAArC;AACAF,YAAAA,GAAG,CAACM,cAAJ,CAAmB,QAAnB,EAA6BJ,MAA7B,GAAsC,KAAtC;AA7BiD;AA8BlD,SA94BqC,CAg5BtC;;;AACM4D,QAAAA,IAAI,CAAC9D,GAAD,EAAY9B,UAAZ,EAAoC;AAAA;AAC5C,gBAAMC,IAAI,GAAG;AAAA;AAAA,wBAAEC,IAAF,CAAO;AAAA;AAAA,oDAAgB4C,OAAvB,EAAiC7C,IAAD,IAAU;AACrD,qBAAOA,IAAI,CAACmB,EAAL,KAAYpB,UAAU,CAAC3B,MAAX,CAAkBI,MAArC;AACD,aAFY,CAAb;AAGA;AAAA;AAAA,sCAASyD,aAAT,CAAuBjC,IAAI,CAAC+C,GAA5B,EAAiClB,GAAG,CAACM,cAAJ,CAAmB,QAAnB,CAAjC,EAA+D,MAAM;AACnEN,cAAAA,GAAG,CAACM,cAAJ,CAAmB,QAAnB,EAA6BJ,MAA7B,GAAsC,IAAtC;AACD,aAFD;AAGAF,YAAAA,GAAG,CACAM,cADH,CACkB,OADlB,EAEGvE,YAFH,CAEgBtE,KAFhB,EAEuBgM,MAFvB,SAEoCvF,UAAU,CAAC3B,MAAX,CAAkBK,KAFtD;AAGAoD,YAAAA,GAAG,CAACM,cAAJ,CAAmB,OAAnB,EAA4BJ,MAA5B,GAAqC,IAArC;AACA,kBAAM;AAAA;AAAA,8CAAaiB,IAAb,CAAkB5H,UAAU,GAAG,IAA/B,CAAN;AACAyG,YAAAA,GAAG,CAACM,cAAJ,CAAmB,OAAnB,EAA4BJ,MAA5B,GAAqC,KAArC;AAEA;AAAA;AAAA,sCAASE,aAAT,CACE,0BADF,EAEEJ,GAAG,CAACM,cAAJ,CAAmB,QAAnB,CAFF,EAGE,MAAM;AACJN,cAAAA,GAAG,CAACM,cAAJ,CAAmB,QAAnB,EAA6BJ,MAA7B,GAAsC,IAAtC;AACD,aALH;AAQAF,YAAAA,GAAG,CAACM,cAAJ,CAAmB,OAAnB,EAA4BvE,YAA5B,CAAyCtE,KAAzC,EAAgDgM,MAAhD,SACEvF,UAAU,CAAC3B,MAAX,CAAkBK,KAAlB,GAA0BsB,UAAU,CAAC3B,MAAX,CAAkBwH,KAD9C;AAGA/D,YAAAA,GAAG,CAACM,cAAJ,CAAmB,OAAnB,EAA4BJ,MAA5B,GAAqC,IAArC;AACA,kBAAM;AAAA;AAAA,8CAAaiB,IAAb,CAAkB5H,UAAU,GAAG,IAA/B,CAAN;AACAyG,YAAAA,GAAG,CAACM,cAAJ,CAAmB,OAAnB,EAA4BJ,MAA5B,GAAqC,KAArC;AACAF,YAAAA,GAAG,CAACM,cAAJ,CAAmB,QAAnB,EAA6BJ,MAA7B,GAAsC,KAAtC;AA5B4C;AA6B7C;;AAEK8D,QAAAA,GAAG,CAAChE,GAAD,EAAY9B,UAAZ,EAAoC;AAAA;AAC3C,gBAAMC,IAAI,GAAG;AAAA;AAAA,wBAAEC,IAAF,CAAO;AAAA;AAAA,oDAAgB4C,OAAvB,EAAiC7C,IAAD,IAAU;AACrD,qBAAOA,IAAI,CAACmB,EAAL,KAAYpB,UAAU,CAAC3B,MAAX,CAAkBI,MAArC;AACD,aAFY,CAAb;AAGA;AAAA;AAAA,sCAASyD,aAAT,CACE,0BADF,EAEEJ,GAAG,CAACM,cAAJ,CAAmB,QAAnB,CAFF,EAGE,MAAM;AACJN,cAAAA,GAAG,CAACM,cAAJ,CAAmB,QAAnB,EAA6BJ,MAA7B,GAAsC,IAAtC;AACD,aALH;AAOAF,YAAAA,GAAG,CAACM,cAAJ,CAAmB,OAAnB,EAA4BvE,YAA5B,CAAyCtE,KAAzC,EAAgDgM,MAAhD,SACEvF,UAAU,CAAC3B,MAAX,CAAkBK,KAAlB,GAA0BsB,UAAU,CAAC3B,MAAX,CAAkBwH,KAD9C;AAGA/D,YAAAA,GAAG,CAACM,cAAJ,CAAmB,OAAnB,EAA4BJ,MAA5B,GAAqC,IAArC;AACA,kBAAM;AAAA;AAAA,8CAAaiB,IAAb,CAAkB5H,UAAU,GAAG,IAA/B,CAAN;AACAyG,YAAAA,GAAG,CAACM,cAAJ,CAAmB,OAAnB,EAA4BJ,MAA5B,GAAqC,KAArC;AAEA;AAAA;AAAA,sCAASE,aAAT,CAAuBjC,IAAI,CAAC+C,GAA5B,EAAiClB,GAAG,CAACM,cAAJ,CAAmB,QAAnB,CAAjC,EAA+D,MAAM;AACnEN,cAAAA,GAAG,CAACM,cAAJ,CAAmB,QAAnB,EAA6BJ,MAA7B,GAAsC,IAAtC;AACD,aAFD;AAGAF,YAAAA,GAAG,CACAM,cADH,CACkB,OADlB,EAEGvE,YAFH,CAEgBtE,KAFhB,EAEuBgM,MAFvB,SAEoCvF,UAAU,CAAC3B,MAAX,CAAkBK,KAFtD;AAGAoD,YAAAA,GAAG,CAACM,cAAJ,CAAmB,OAAnB,EAA4BJ,MAA5B,GAAqC,IAArC;AACA,kBAAM;AAAA;AAAA,8CAAaiB,IAAb,CAAkB5H,UAAU,GAAG,IAA/B,CAAN;AACAyG,YAAAA,GAAG,CAACM,cAAJ,CAAmB,OAAnB,EAA4BJ,MAA5B,GAAqC,KAArC;AACAF,YAAAA,GAAG,CAACM,cAAJ,CAAmB,QAAnB,EAA6BJ,MAA7B,GAAsC,KAAtC;AA3B2C;AA4B5C;;AAED+D,QAAAA,KAAK,CAACjE,GAAD,EAAM9B,UAAN,EAAkB;AACrB8B,UAAAA,GAAG,CAACM,cAAJ,CAAmB,gBAAnB,EAAqCA,cAArC,CAAoD,OAApD,EAA6DvE,YAA7D,CAA0EtE,KAA1E,EAAiFgM,MAAjF,GACEvF,UAAU,CAAC3B,MAAX,CAAkB2H,OADpB;AAEAlE,UAAAA,GAAG,CAACM,cAAJ,CAAmB,gBAAnB,EAAqCJ,MAArC,GAA8C,IAA9C;AACA,eAAKK,YAAL,CAAkB,MAAI;AACpBP,YAAAA,GAAG,CAACM,cAAJ,CAAmB,gBAAnB,EAAqCJ,MAArC,GAA8C,KAA9C;AACD,WAFD,EAEG,CAFH;AAID;;AAEDiE,QAAAA,WAAW,CAACnE,GAAD,EAAYC,EAAZ,EAA6B;AACtCD,UAAAA,GAAG,CAACM,cAAJ,CAAmB,QAAnB,EAA6BJ,MAA7B,GAAsC,KAAtC;AACD,SA19BqC,CA49BtC;;;AACMzE,QAAAA,aAAa,CAAC2I,OAAD,EAAe;AAAA;;AAAA;AAChC;AACA,gBAAMlG,UAAsB,GAAGkG,OAAO,CAACjI,IAAR,CAAaA,IAA5C;AACA,gBAAM6D,GAAG,GAAG;AAAA;AAAA,wBAAE5B,IAAF,CAAO,MAAI,CAACiG,WAAZ,EAA0BlG,IAAD,IAAU;AAC7C,qBACEA,IAAI,CAACmC,cAAL,CAAoB,gBAApB,EAAsCvE,YAAtC;AAAA;AAAA,4CAA+DuI,KAA/D,KACApG,UAAU,CAAC5B,KAFb;AAID,aALW,CAAZ;AAMA,gBAAIiI,QAAJ;AACA,gBAAIvB,UAAJ;;AAEA,gBAAMF,SAAS,GAAG,MAAI,CAACC,WAAL,CAChB,IAAI/K,IAAJ,CAASgI,GAAG,CAACjB,WAAJ,GAAkB4B,CAA3B,EAA8BX,GAAG,CAACjB,WAAJ,GAAkBC,CAAhD,CADgB,CAAlB;;AAGA,gBAAI;AACF,kBAAId,UAAU,CAAC7B,QAAX,KAAwB;AAAA;AAAA,gDAAa4H,KAAzC,EAAgD;AAAA;;AAC9C,oBAAMO,KAAK,GAAG;AAAA;AAAA,4BAAEpG,IAAF,CAAO,MAAI,CAACiG,WAAZ,EAA0BlG,IAAD,IAAU;AAC/C,yBACEA,IAAI,CAACmC,cAAL,CAAoB,gBAApB,EAAsCvE,YAAtC;AAAA;AAAA,gDACGuI,KADH,KACapG,UAAU,CAAC3B,MAAX,CAAkBD,KAFjC;AAID,iBALa,CAAd;;AAMA,oBAAImI,KAAK,GAAG,MAAI,CAAC1B,WAAL,CACV,IAAI/K,IAAJ,CAASwM,KAAK,CAACzF,WAAN,GAAoB4B,CAA7B,EAAgC6D,KAAK,CAACzF,WAAN,GAAoBC,CAApD,CADU,CAAZ;;AAIA,oBAAI0F,SAAJ;;AAEE,oBACE,wBAAC,MAAI,CAACjK,WAAN,mCAAC,mBACGsB,YADH,CACgBpE,UADhB,CAAD,aAAC,mBAEGgN,YAFH,CAEgBF,KAAK,CAAC9D,CAAN,GAAU,CAF1B,EAE6B8D,KAAK,CAACzF,CAAN,GAAU,CAFvC,CAAD,CADF,EAIE;AACA0F,kBAAAA,SAAS,GAAG,IAAI1M,IAAJ,CAASyM,KAAK,CAAC9D,CAAN,GAAU,CAAnB,EAAsB8D,KAAK,CAACzF,CAAN,GAAU,CAAhC,CAAZ;AACD;;AACD,oBACE,yBAAC,MAAI,CAACvE,WAAN,oCAAC,oBACGsB,YADH,CACgBpE,UADhB,CAAD,aAAC,oBAEGgN,YAFH,CAEgBF,KAAK,CAAC9D,CAAN,GAAU,CAF1B,EAE6B8D,KAAK,CAACzF,CAAN,GAAU,CAFvC,CAAD,CADF,EAIE;AACA0F,kBAAAA,SAAS,GAAG,IAAI1M,IAAJ,CAASyM,KAAK,CAAC9D,CAAN,GAAU,CAAnB,EAAsB8D,KAAK,CAACzF,CAAN,GAAU,CAAhC,CAAZ;AACD;;AACD,oBACE,yBAAC,MAAI,CAACvE,WAAN,oCAAC,oBACGsB,YADH,CACgBpE,UADhB,CAAD,aAAC,oBAEGgN,YAFH,CAEgBF,KAAK,CAAC9D,CAAN,GAAU,CAF1B,EAE6B8D,KAAK,CAACzF,CAAN,GAAU,CAFvC,CAAD,CADF,EAIE;AACA0F,kBAAAA,SAAS,GAAG,IAAI1M,IAAJ,CAASyM,KAAK,CAAC9D,CAAN,GAAU,CAAnB,EAAsB8D,KAAK,CAACzF,CAAN,GAAU,CAAhC,CAAZ;AACD;;AACD,oBACE,yBAAC,MAAI,CAACvE,WAAN,oCAAC,oBACGsB,YADH,CACgBpE,UADhB,CAAD,aAAC,oBAEGgN,YAFH,CAEgBF,KAAK,CAAC9D,CAAN,GAAU,CAF1B,EAE6B8D,KAAK,CAACzF,CAAN,GAAU,CAFvC,CAAD,CADF,EAIE;AACA0F,kBAAAA,SAAS,GAAG,IAAI1M,IAAJ,CAASyM,KAAK,CAAC9D,CAAN,GAAU,CAAnB,EAAsB8D,KAAK,CAACzF,CAAN,GAAU,CAAhC,CAAZ;AACD;;AAEHuF,gBAAAA,QAAQ,GAAGC,KAAK,CAACzF,WAAN,EAAX;AACAiE,gBAAAA,UAAU,GAAG0B,SAAb;AACD,eA5CD,MA4CO;AACLH,gBAAAA,QAAQ,GAAG,IAAIvM,IAAJ,CACT,MAAI,CAAC4M,UAAL,CAAgBC,SAAhB,CAA0B3G,UAAU,CAAC3B,MAAX,CAAkBC,GAA5C,EAAiDmE,CADxC,EAET,MAAI,CAACiE,UAAL,CAAgBC,SAAhB,CAA0B3G,UAAU,CAAC3B,MAAX,CAAkBC,GAA5C,EAAiDwC,CAFxC,CAAX;AAIAgE,gBAAAA,UAAU,GAAG,MAAI,CAACD,WAAL,CACX,IAAI/K,IAAJ,CACE,MAAI,CAAC4M,UAAL,CAAgBC,SAAhB,CAA0B3G,UAAU,CAAC3B,MAAX,CAAkBC,GAA5C,EAAiDmE,CADnD,EAEE,MAAI,CAACiE,UAAL,CAAgBC,SAAhB,CAA0B3G,UAAU,CAAC3B,MAAX,CAAkBC,GAA5C,EAAiDwC,CAFnD,CADW,CAAb;AAMD;AACF,aAzDD,CAyDE,OAAO8F,KAAP,EAAc,CAAE;;AAElB,gBAAI7E,EAAJ,CA1EgC,CA4EhC;;AACA,gBAAI/B,UAAU,CAAC7B,QAAX,KAAwB;AAAA;AAAA,8CAAagE,KAAzC,EAAgD;AAC9CJ,cAAAA,EAAE,GAAG,MAAM;AACT,oBAAM8E,KAAK,GAAG,MAAI,CAACvF,YAAL,CAAkBtB,UAAU,CAAC5B,KAA7B,CAAd;;AACA,gBAAA,MAAI,CAAC0I,YAAL,CAAkBhF,GAAlB,EAAuB9B,UAAvB,EAAmC,iBAAnC;;AACA,gBAAA,MAAI,CAACiC,QAAL,CAAcH,GAAd,EAAmB+E,KAAK,CAACtF,IAAzB,EAA+BsF,KAAK,CAACrF,MAArC,iCAA6C,aAAY;AACvDM,kBAAAA,GAAG,CAACM,cAAJ,CAAmB,QAAnB,EAA6BJ,MAA7B,GAAsC,KAAtC;AACAF,kBAAAA,GAAG,CAACE,MAAJ,GAAa,KAAb;AACA,sBAAMmB,UAAU,SAAS,MAAI,CAACpD,aAAL,CAAmBC,UAAnB,CAAzB;;AACA,sBAAI,CAACmD,UAAL,EAAiB;AACf;AACD;;AACD,sBAAI1G,IAAI,GAAG,IAAI;AAAA;AAAA,0CAAQ8F,aAAZ,EAAX;AACA9F,kBAAAA,IAAI,CAACE,OAAL,GAAe,KAAf;AACAF,kBAAAA,IAAI,CAACf,IAAL,GAAY,CAAZ;AACAe,kBAAAA,IAAI,CAACwB,IAAL,CAAUC,GAAV,GAAgB8B,UAAU,CAAC9B,GAA3B;AACAzB,kBAAAA,IAAI,CAACwB,IAAL,CAAUG,KAAV,GAAkB4B,UAAU,CAAC5B,KAA7B;AACA3B,kBAAAA,IAAI,CAACwB,IAAL,CAAUuE,KAAV,GAAkBxC,UAAU,CAAC3B,MAAX,CAAkBC,GAApC;AACA7B,kBAAAA,IAAI,CAACwB,IAAL,CAAUwE,CAAV,GAAc4D,QAAQ,CAAC5D,CAAvB;AACAhG,kBAAAA,IAAI,CAACwB,IAAL,CAAU6C,CAAV,GAAcxF,KAAK,GAAG+K,QAAQ,CAACvF,CAA/B;AACArE,kBAAAA,IAAI,CAACwB,IAAL,CAAUyE,QAAV,GAAqB,CAArB;AACAjG,kBAAAA,IAAI,CAACwB,IAAL,CAAU0E,KAAV,GAAkB,CAAlB;AACAlG,kBAAAA,IAAI,CAACwB,IAAL,CAAUI,MAAV,GAAmB;AACjBC,oBAAAA,GAAG,EAAE0B,UAAU,CAAC3B,MAAX,CAAkBC;AADN,mBAAnB;AAGA;AAAA;AAAA,wCAAO1B,mBAAP,CAA2BH,IAA3B;AACD,iBArBD;AAsBD,eAzBD;AA0BD,aA3BD,MA2BO,IAAIuD,UAAU,CAAC7B,QAAX,KAAwB;AAAA;AAAA,8CAAa+E,IAAzC,EAA+C;AACpDnB,cAAAA,EAAE;AAAA,8CAAG,aAAY;AACf,kBAAA,MAAI,CAAC+E,YAAL,CAAkBhF,GAAlB,EAAuB9B,UAAvB,EAAmC,gBAAnC;;AACA,wBAAM,MAAI,CAAC4C,OAAL,CAAad,GAAb,EAAkB9B,UAAlB,CAAN;AACD,iBAHC;;AAAA;AAAA;AAAA;AAAA,iBAAF;AAID,aALM,MAKA,IAAIA,UAAU,CAAC7B,QAAX,KAAwB;AAAA;AAAA,8CAAaoF,OAAzC,EAAkD;AACvDxB,cAAAA,EAAE;AAAA,8CAAG,aAAY;AACf,kBAAA,MAAI,CAAC+E,YAAL,CAAkBhF,GAAlB,EAAuB9B,UAAvB,EAAmC,kBAAnC;;AACA,wBAAM,MAAI,CAACqD,UAAL,CAAgBvB,GAAhB,EAAqB9B,UAArB,CAAN;AACA,sBAAMmD,UAAU,SAAS,MAAI,CAACpD,aAAL,CAAmBC,UAAnB,CAAzB;;AACA,sBAAI,CAACmD,UAAL,EAAiB;AACf;AACD;;AACD,sBAAI1G,IAAI,GAAG,IAAI;AAAA;AAAA,0CAAQ8F,aAAZ,EAAX;AACA9F,kBAAAA,IAAI,CAACE,OAAL,GAAe,KAAf;AACAF,kBAAAA,IAAI,CAACf,IAAL,GAAY,CAAZ;AACAe,kBAAAA,IAAI,CAACwB,IAAL,CAAUC,GAAV,GAAgB8B,UAAU,CAAC9B,GAA3B;AACAzB,kBAAAA,IAAI,CAACwB,IAAL,CAAUG,KAAV,GAAkB4B,UAAU,CAAC5B,KAA7B;AACA3B,kBAAAA,IAAI,CAACwB,IAAL,CAAUuE,KAAV,GAAkBxC,UAAU,CAAC3B,MAAX,CAAkBC,GAApC;AACA7B,kBAAAA,IAAI,CAACwB,IAAL,CAAUwE,CAAV,GAAc4D,QAAQ,CAAC5D,CAAvB;AACAhG,kBAAAA,IAAI,CAACwB,IAAL,CAAU6C,CAAV,GAAcxF,KAAK,GAAG+K,QAAQ,CAACvF,CAA/B;AACArE,kBAAAA,IAAI,CAACwB,IAAL,CAAUyE,QAAV,GAAqB,CAArB;AACAjG,kBAAAA,IAAI,CAACwB,IAAL,CAAU0E,KAAV,GAAkB,CAAlB;AACAlG,kBAAAA,IAAI,CAACwB,IAAL,CAAUI,MAAV,GAAmB;AACjBC,oBAAAA,GAAG,EAAE0B,UAAU,CAAC3B,MAAX,CAAkBC,GADN;AAEjBG,oBAAAA,MAAM,EAAEuB,UAAU,CAAC3B,MAAX,CAAkBI,MAFT;AAGjBC,oBAAAA,KAAK,EAAE;AAHU,mBAAnB;AAKA;AAAA;AAAA,wCAAO9B,mBAAP,CAA2BH,IAA3B;AACD,iBAvBC;;AAAA;AAAA;AAAA;AAAA,iBAAF;AAwBD,aAzBM,MAyBA,IAAIuD,UAAU,CAAC7B,QAAX,KAAwB;AAAA;AAAA,8CAAa4I,OAAzC,EAAkD;AACvDhF,cAAAA,EAAE;AAAA,8CAAG,aAAY;AACfD,kBAAAA,GAAG,CACAM,cADH,CACkB,gBADlB,EAEGvE,YAFH;AAAA;AAAA,gDAGGmH,gBAHH,CAGoB1L,OAAO,CAAC2L,KAH5B;AAIA,wBAAM;AAAA;AAAA,oDAAahC,IAAb,CAAkB5H,UAAU,GAAG,IAA/B,CAAN;AACA,wBAAM,MAAI,CAAC2I,UAAL,CAAgBlC,GAAhB,EAAqB9B,UAArB,CAAN;AACA,sBAAMmD,UAAU,SAAS,MAAI,CAACpD,aAAL,CAAmBC,UAAnB,CAAzB;;AACA,sBAAI,CAACmD,UAAL,EAAiB;AACf;AACD;;AACD,sBAAI1G,IAAI,GAAG,IAAI;AAAA;AAAA,0CAAQ8F,aAAZ,EAAX;AACA9F,kBAAAA,IAAI,CAACE,OAAL,GAAe,KAAf;AACAF,kBAAAA,IAAI,CAACf,IAAL,GAAY,CAAZ;AACAe,kBAAAA,IAAI,CAACwB,IAAL,CAAUC,GAAV,GAAgB8B,UAAU,CAAC9B,GAA3B;AACAzB,kBAAAA,IAAI,CAACwB,IAAL,CAAUG,KAAV,GAAkB4B,UAAU,CAAC5B,KAA7B;AACA3B,kBAAAA,IAAI,CAACwB,IAAL,CAAUuE,KAAV,GAAkBxC,UAAU,CAAC3B,MAAX,CAAkBC,GAApC;AACA7B,kBAAAA,IAAI,CAACwB,IAAL,CAAUwE,CAAV,GAAc4D,QAAQ,CAAC5D,CAAvB;AACAhG,kBAAAA,IAAI,CAACwB,IAAL,CAAU6C,CAAV,GAAcxF,KAAK,GAAG+K,QAAQ,CAACvF,CAA/B;AACArE,kBAAAA,IAAI,CAACwB,IAAL,CAAUyE,QAAV,GAAqB,CAArB;AACAjG,kBAAAA,IAAI,CAACwB,IAAL,CAAU0E,KAAV,GAAkB,CAAlB;AACAlG,kBAAAA,IAAI,CAACwB,IAAL,CAAUI,MAAV,GAAmB;AACjBC,oBAAAA,GAAG,EAAE0B,UAAU,CAAC3B,MAAX,CAAkBC,GADN;AAEjBG,oBAAAA,MAAM,EAAEuB,UAAU,CAAC3B,MAAX,CAAkBI,MAFT;AAGjBC,oBAAAA,KAAK,EAAE;AAHU,mBAAnB;AAKA;AAAA;AAAA,wCAAO9B,mBAAP,CAA2BH,IAA3B;AACD,iBA3BC;;AAAA;AAAA;AAAA;AAAA,iBAAF;AA4BD,aA7BM,MA6BA,IAAIuD,UAAU,CAAC7B,QAAX,KAAwB;AAAA;AAAA,8CAAa6I,OAAzC,EAAkD;AACvDjF,cAAAA,EAAE;AAAA,8CAAG,aAAY;AACfD,kBAAAA,GAAG,CACAM,cADH,CACkB,gBADlB,EAEGvE,YAFH;AAAA;AAAA,gDAGGmH,gBAHH,CAGoB1L,OAAO,CAAC2L,KAH5B;AAIA,wBAAM;AAAA;AAAA,oDAAahC,IAAb,CAAkB5H,UAAU,GAAG,IAA/B,CAAN;AACA,wBAAM,MAAI,CAAC6J,UAAL,CAAgBpD,GAAhB,EAAqB9B,UAArB,CAAN;AACA,sBAAMmD,UAAU,SAAS,MAAI,CAACpD,aAAL,CAAmBC,UAAnB,CAAzB;;AACA,sBAAI,CAACmD,UAAL,EAAiB;AACf;AACD;;AACD,sBAAI1G,IAAI,GAAG,IAAI;AAAA;AAAA,0CAAQ8F,aAAZ,EAAX;AACA9F,kBAAAA,IAAI,CAACE,OAAL,GAAe,KAAf;AACAF,kBAAAA,IAAI,CAACf,IAAL,GAAY,CAAZ;AACAe,kBAAAA,IAAI,CAACwB,IAAL,CAAUC,GAAV,GAAgB8B,UAAU,CAAC9B,GAA3B;AACAzB,kBAAAA,IAAI,CAACwB,IAAL,CAAUG,KAAV,GAAkB4B,UAAU,CAAC5B,KAA7B;AACA3B,kBAAAA,IAAI,CAACwB,IAAL,CAAUuE,KAAV,GAAkBxC,UAAU,CAAC3B,MAAX,CAAkBC,GAApC;AACA7B,kBAAAA,IAAI,CAACwB,IAAL,CAAUwE,CAAV,GAAc4D,QAAQ,CAAC5D,CAAvB;AACAhG,kBAAAA,IAAI,CAACwB,IAAL,CAAU6C,CAAV,GAAcxF,KAAK,GAAG+K,QAAQ,CAACvF,CAA/B;AACArE,kBAAAA,IAAI,CAACwB,IAAL,CAAUyE,QAAV,GAAqB,CAArB;AACAjG,kBAAAA,IAAI,CAACwB,IAAL,CAAU0E,KAAV,GAAkB,CAAlB;AACAlG,kBAAAA,IAAI,CAACwB,IAAL,CAAUI,MAAV,GAAmB;AACjBC,oBAAAA,GAAG,EAAE0B,UAAU,CAAC3B,MAAX,CAAkBC;AADN,mBAAnB;AAGA;AAAA;AAAA,wCAAO1B,mBAAP,CAA2BH,IAA3B;AACD,iBAzBC;;AAAA;AAAA;AAAA;AAAA,iBAAF;AA0BD,aA3BM,MA2BA,IAAIuD,UAAU,CAAC7B,QAAX,KAAwB;AAAA;AAAA,8CAAa8I,KAAzC,EAAgD;AACrDlF,cAAAA,EAAE;AAAA,8CAAG,aAAY;AACf,sBAAMoB,UAAU,SAAS,MAAI,CAACpD,aAAL,CAAmBC,UAAnB,CAAzB;;AACA,sBAAI,CAACmD,UAAL,EAAiB;AACf;AACD;;AACD,sBAAI1G,IAAI,GAAG,IAAI;AAAA;AAAA,0CAAQ8F,aAAZ,EAAX;AACA9F,kBAAAA,IAAI,CAACE,OAAL,GAAe,KAAf;AACAF,kBAAAA,IAAI,CAACf,IAAL,GAAY,CAAZ;AACAe,kBAAAA,IAAI,CAACwB,IAAL,CAAUC,GAAV,GAAgB8B,UAAU,CAAC9B,GAA3B;AACAzB,kBAAAA,IAAI,CAACwB,IAAL,CAAUG,KAAV,GAAkB4B,UAAU,CAAC5B,KAA7B;AACA3B,kBAAAA,IAAI,CAACwB,IAAL,CAAUuE,KAAV,GAAkBxC,UAAU,CAAC3B,MAAX,CAAkBC,GAApC;AACA7B,kBAAAA,IAAI,CAACwB,IAAL,CAAUwE,CAAV,GAAc4D,QAAQ,CAAC5D,CAAvB;AACAhG,kBAAAA,IAAI,CAACwB,IAAL,CAAU6C,CAAV,GAAcxF,KAAK,GAAG+K,QAAQ,CAACvF,CAA/B;AACArE,kBAAAA,IAAI,CAACwB,IAAL,CAAUyE,QAAV,GAAqB,CAArB;AACAjG,kBAAAA,IAAI,CAACwB,IAAL,CAAU0E,KAAV,GAAkB,CAAlB;AACAlG,kBAAAA,IAAI,CAACwB,IAAL,CAAUI,MAAV,GAAmB;AACjBC,oBAAAA,GAAG,EAAE0B,UAAU,CAAC3B,MAAX,CAAkBC;AADN,mBAAnB;AAGA;AAAA;AAAA,wCAAO1B,mBAAP,CAA2BH,IAA3B;AACD,iBAnBC;;AAAA;AAAA;AAAA;AAAA,iBAAF;AAoBD,aArBM,MAqBA,IAAIuD,UAAU,CAAC7B,QAAX,KAAwB;AAAA;AAAA,8CAAa+I,IAAzC,EAA+C;AACpDnF,cAAAA,EAAE;AAAA,8CAAG,aAAY;AACf,sBAAMoB,UAAU,SAAS,MAAI,CAACpD,aAAL,CAAmBC,UAAnB,CAAzB;;AACA,sBAAI,CAACmD,UAAL,EAAiB;AACf;AACD;;AACD,sBAAI1G,IAAI,GAAG,IAAI;AAAA;AAAA,0CAAQ8F,aAAZ,EAAX;AACA9F,kBAAAA,IAAI,CAACE,OAAL,GAAe,KAAf;AACAF,kBAAAA,IAAI,CAACf,IAAL,GAAY,CAAZ;AACAe,kBAAAA,IAAI,CAACwB,IAAL,CAAUG,KAAV,GAAkB4B,UAAU,CAAC5B,KAA7B;AACA3B,kBAAAA,IAAI,CAACwB,IAAL,CAAUE,QAAV,GAAqB,GAArB;AACA1B,kBAAAA,IAAI,CAACwB,IAAL,CAAUwE,CAAV,GAAc4D,QAAQ,CAAC5D,CAAvB;AACAhG,kBAAAA,IAAI,CAACwB,IAAL,CAAU6C,CAAV,GAAcxF,KAAK,GAAG+K,QAAQ,CAACvF,CAA/B;AACArE,kBAAAA,IAAI,CAACwB,IAAL,CAAUyE,QAAV,GAAqB,CAArB;AACAjG,kBAAAA,IAAI,CAACwB,IAAL,CAAU0E,KAAV,GAAkB,CAAlB;AACAlG,kBAAAA,IAAI,CAACwB,IAAL,CAAUC,GAAV,GAAgB8B,UAAU,CAAC9B,GAA3B;AACA;AAAA;AAAA,wCAAOtB,mBAAP,CAA2BH,IAA3B;AACD,iBAhBC;;AAAA;AAAA;AAAA;AAAA,iBAAF;AAiBD,aAlBM,MAkBA,IAAIuD,UAAU,CAAC7B,QAAX,KAAwB;AAAA;AAAA,8CAAa+I,IAAzC,EAA+C;AACpDnF,cAAAA,EAAE;AAAA,8CAAG,aAAY;AACf,sBAAMoB,UAAU,SAAS,MAAI,CAACpD,aAAL,CAAmBC,UAAnB,CAAzB;;AACA,sBAAI,CAACmD,UAAL,EAAiB;AACf;AACD;;AACD,sBAAI1G,IAAI,GAAG,IAAI;AAAA;AAAA,0CAAQ8F,aAAZ,EAAX;AACA9F,kBAAAA,IAAI,CAACE,OAAL,GAAe,KAAf;AACAF,kBAAAA,IAAI,CAACf,IAAL,GAAY,CAAZ;AACAe,kBAAAA,IAAI,CAACwB,IAAL,CAAUG,KAAV,GAAkB4B,UAAU,CAAC5B,KAA7B;AACA3B,kBAAAA,IAAI,CAACwB,IAAL,CAAUE,QAAV,GAAqB,GAArB;AACA1B,kBAAAA,IAAI,CAACwB,IAAL,CAAUwE,CAAV,GAAc4D,QAAQ,CAAC5D,CAAvB;AACAhG,kBAAAA,IAAI,CAACwB,IAAL,CAAU6C,CAAV,GAAcxF,KAAK,GAAG+K,QAAQ,CAACvF,CAA/B;AACArE,kBAAAA,IAAI,CAACwB,IAAL,CAAUyE,QAAV,GAAqB,CAArB;AACAjG,kBAAAA,IAAI,CAACwB,IAAL,CAAU0E,KAAV,GAAkB,CAAlB;AACAlG,kBAAAA,IAAI,CAACwB,IAAL,CAAUC,GAAV,GAAgB8B,UAAU,CAAC9B,GAA3B;AACA;AAAA;AAAA,wCAAOtB,mBAAP,CAA2BH,IAA3B;AACD,iBAhBC;;AAAA;AAAA;AAAA;AAAA,iBAAF;AAiBD,aAlBM,MAkBA,IAAIuD,UAAU,CAAC7B,QAAX,KAAwB;AAAA;AAAA,8CAAa4H,KAAzC,EAAgD;AACrDhE,cAAAA,EAAE;AAAA,+CAAG,aAAY;AACf,kBAAA,MAAI,CAACgE,KAAL,CAAWjE,GAAX,EAAgB9B,UAAhB;;AACA,sBAAMmD,UAAU,SAAS,MAAI,CAACpD,aAAL,CAAmBC,UAAnB,CAAzB;;AACA,sBAAI,CAACmD,UAAL,EAAiB;AACf;AACD;;AACD,sBAAI1G,IAAI,GAAG,IAAI;AAAA;AAAA,0CAAQ8F,aAAZ,EAAX;AAEA9F,kBAAAA,IAAI,CAACE,OAAL,GAAe,KAAf;AACAF,kBAAAA,IAAI,CAACf,IAAL,GAAY,CAAZ;AACAe,kBAAAA,IAAI,CAACwB,IAAL,CAAUC,GAAV,GAAgB8B,UAAU,CAAC9B,GAA3B;AACAzB,kBAAAA,IAAI,CAACwB,IAAL,CAAUG,KAAV,GAAkB4B,UAAU,CAAC5B,KAA7B;AACA3B,kBAAAA,IAAI,CAACwB,IAAL,CAAUuE,KAAV,GAAkBxC,UAAU,CAAC3B,MAAX,CAAkBC,GAApC;AACA7B,kBAAAA,IAAI,CAACwB,IAAL,CAAUwE,CAAV,GAAc4D,QAAQ,CAAC5D,CAAvB;AACAhG,kBAAAA,IAAI,CAACwB,IAAL,CAAU6C,CAAV,GAAcxF,KAAK,GAAG+K,QAAQ,CAACvF,CAA/B;AACArE,kBAAAA,IAAI,CAACwB,IAAL,CAAUyE,QAAV,GAAqB,CAArB;AACAjG,kBAAAA,IAAI,CAACwB,IAAL,CAAU0E,KAAV,GAAkB,CAAlB;AACA;AAAA;AAAA,wCAAO/F,mBAAP,CAA2BH,IAA3B;AACD,iBAlBC;;AAAA;AAAA;AAAA;AAAA,iBAAF;AAmBD,aApBM,MAoBA,IAAIuD,UAAU,CAAC7B,QAAX,KAAwB;AAAA;AAAA,8CAAa2H,GAAzC,EAA8C;AACnD/D,cAAAA,EAAE;AAAA,+CAAG,aAAY;AACf,wBAAM,MAAI,CAAC+D,GAAL,CAAShE,GAAT,EAAc9B,UAAd,CAAN;AACA,sBAAMmD,UAAU,SAAS,MAAI,CAACpD,aAAL,CAAmBC,UAAnB,CAAzB;;AACA,sBAAI,CAACmD,UAAL,EAAiB;AACf;AACD;;AACD,sBAAI1G,IAAI,GAAG,IAAI;AAAA;AAAA,0CAAQ8F,aAAZ,EAAX;AACA9F,kBAAAA,IAAI,CAACE,OAAL,GAAe,KAAf;AACAF,kBAAAA,IAAI,CAACf,IAAL,GAAY,CAAZ;AACAe,kBAAAA,IAAI,CAACwB,IAAL,CAAUC,GAAV,GAAgB8B,UAAU,CAAC9B,GAA3B;AACAzB,kBAAAA,IAAI,CAACwB,IAAL,CAAUG,KAAV,GAAkB4B,UAAU,CAAC5B,KAA7B;AACA3B,kBAAAA,IAAI,CAACwB,IAAL,CAAUuE,KAAV,GAAkBxC,UAAU,CAAC3B,MAAX,CAAkBC,GAApC;AACA7B,kBAAAA,IAAI,CAACwB,IAAL,CAAUwE,CAAV,GAAc4D,QAAQ,CAAC5D,CAAvB;AACAhG,kBAAAA,IAAI,CAACwB,IAAL,CAAU6C,CAAV,GAAcxF,KAAK,GAAG+K,QAAQ,CAACvF,CAA/B;AACArE,kBAAAA,IAAI,CAACwB,IAAL,CAAUyE,QAAV,GAAqB,CAArB;AACAjG,kBAAAA,IAAI,CAACwB,IAAL,CAAU0E,KAAV,GAAkB,CAAlB;AACA;AAAA;AAAA,wCAAO/F,mBAAP,CAA2BH,IAA3B;AACD,iBAjBC;;AAAA;AAAA;AAAA;AAAA,iBAAF;AAkBD,aAnBM,MAmBA,IAAIuD,UAAU,CAAC7B,QAAX,KAAwB;AAAA;AAAA,8CAAayH,IAAzC,EAA+C;AACpD7D,cAAAA,EAAE;AAAA,+CAAG,aAAY;AACf,wBAAM,MAAI,CAAC6D,IAAL,CAAU9D,GAAV,EAAe9B,UAAf,CAAN;AACA,sBAAMmD,UAAU,SAAS,MAAI,CAACpD,aAAL,CAAmBC,UAAnB,CAAzB;;AACA,sBAAI,CAACmD,UAAL,EAAiB;AACf;AACD;;AACD,sBAAI1G,IAAI,GAAG,IAAI;AAAA;AAAA,0CAAQ8F,aAAZ,EAAX;AACA9F,kBAAAA,IAAI,CAACE,OAAL,GAAe,KAAf;AACAF,kBAAAA,IAAI,CAACf,IAAL,GAAY,CAAZ;AACAe,kBAAAA,IAAI,CAACwB,IAAL,CAAUC,GAAV,GAAgB8B,UAAU,CAAC9B,GAA3B;AACAzB,kBAAAA,IAAI,CAACwB,IAAL,CAAUG,KAAV,GAAkB4B,UAAU,CAAC5B,KAA7B;AACA3B,kBAAAA,IAAI,CAACwB,IAAL,CAAUuE,KAAV,GAAkBxC,UAAU,CAAC3B,MAAX,CAAkBC,GAApC;AACA7B,kBAAAA,IAAI,CAACwB,IAAL,CAAUwE,CAAV,GAAc4D,QAAQ,CAAC5D,CAAvB;AACAhG,kBAAAA,IAAI,CAACwB,IAAL,CAAU6C,CAAV,GAAcxF,KAAK,GAAG+K,QAAQ,CAACvF,CAA/B;AACArE,kBAAAA,IAAI,CAACwB,IAAL,CAAUyE,QAAV,GAAqB,CAArB;AACAjG,kBAAAA,IAAI,CAACwB,IAAL,CAAU0E,KAAV,GAAkB,CAAlB;AACA;AAAA;AAAA,wCAAO/F,mBAAP,CAA2BH,IAA3B;AACD,iBAjBC;;AAAA;AAAA;AAAA;AAAA,iBAAF;AAkBD,aAnBM,MAmBA,IAAIuD,UAAU,CAAC7B,QAAX,KAAwB;AAAA;AAAA,8CAAagJ,SAAzC,EAAoD;AACzDpF,cAAAA,EAAE;AAAA,+CAAG,aAAY;AACf,wBAAM,MAAI,CAAC0D,YAAL,CAAkB3D,GAAlB,EAAuB9B,UAAvB,CAAN;AACA,sBAAMmD,UAAU,SAAS,MAAI,CAACpD,aAAL,CAAmBC,UAAnB,CAAzB;;AACA,sBAAI,CAACmD,UAAL,EAAiB;AACf;AACD;;AACD,sBAAI1G,IAAI,GAAG,IAAI;AAAA;AAAA,0CAAQ8F,aAAZ,EAAX;AACA9F,kBAAAA,IAAI,CAACE,OAAL,GAAe,KAAf;AACAF,kBAAAA,IAAI,CAACf,IAAL,GAAY,CAAZ;AACAe,kBAAAA,IAAI,CAACwB,IAAL,CAAUC,GAAV,GAAgB8B,UAAU,CAAC9B,GAA3B;AACAzB,kBAAAA,IAAI,CAACwB,IAAL,CAAUG,KAAV,GAAkB4B,UAAU,CAAC5B,KAA7B;AACA3B,kBAAAA,IAAI,CAACwB,IAAL,CAAUuE,KAAV,GAAkBxC,UAAU,CAAC3B,MAAX,CAAkBC,GAApC;AACA7B,kBAAAA,IAAI,CAACwB,IAAL,CAAUwE,CAAV,GAAc4D,QAAQ,CAAC5D,CAAvB;AACAhG,kBAAAA,IAAI,CAACwB,IAAL,CAAU6C,CAAV,GAAcxF,KAAK,GAAG+K,QAAQ,CAACvF,CAA/B;AACArE,kBAAAA,IAAI,CAACwB,IAAL,CAAUyE,QAAV,GAAqB,CAArB;AACAjG,kBAAAA,IAAI,CAACwB,IAAL,CAAU0E,KAAV,GAAkB,CAAlB;AACA;AAAA;AAAA,wCAAO/F,mBAAP,CAA2BH,IAA3B;AACD,iBAjBC;;AAAA;AAAA;AAAA;AAAA,iBAAF;AAkBD,aAnBM,MAmBA,IAAIuD,UAAU,CAAC7B,QAAX,KAAwB;AAAA;AAAA,8CAAaiJ,IAAzC,EAA+C;AACpDrF,cAAAA,EAAE;AAAA,+CAAG,aAAY;AACf,wBAAM,MAAI,CAAC4D,SAAL,CAAe7D,GAAf,EAAoB9B,UAApB,CAAN;AACA,sBAAMmD,UAAU,SAAS,MAAI,CAACpD,aAAL,CAAmBC,UAAnB,CAAzB;;AACA,sBAAI,CAACmD,UAAL,EAAiB;AACf;AACD;;AACD,sBAAI1G,IAAI,GAAG,IAAI;AAAA;AAAA,0CAAQ8F,aAAZ,EAAX;AACA9F,kBAAAA,IAAI,CAACE,OAAL,GAAe,KAAf;AACAF,kBAAAA,IAAI,CAACf,IAAL,GAAY,CAAZ;AACAe,kBAAAA,IAAI,CAACwB,IAAL,CAAUC,GAAV,GAAgB8B,UAAU,CAAC9B,GAA3B;AACAzB,kBAAAA,IAAI,CAACwB,IAAL,CAAUG,KAAV,GAAkB4B,UAAU,CAAC5B,KAA7B;AACA3B,kBAAAA,IAAI,CAACwB,IAAL,CAAUuE,KAAV,GAAkBxC,UAAU,CAAC3B,MAAX,CAAkBC,GAApC;AACA7B,kBAAAA,IAAI,CAACwB,IAAL,CAAUwE,CAAV,GAAc4D,QAAQ,CAAC5D,CAAvB;AACAhG,kBAAAA,IAAI,CAACwB,IAAL,CAAU6C,CAAV,GAAcxF,KAAK,GAAG+K,QAAQ,CAACvF,CAA/B;AACArE,kBAAAA,IAAI,CAACwB,IAAL,CAAUyE,QAAV,GAAqB,CAArB;AACAjG,kBAAAA,IAAI,CAACwB,IAAL,CAAU0E,KAAV,GAAkB,CAAlB;AACA;AAAA;AAAA,wCAAO/F,mBAAP,CAA2BH,IAA3B;AACD,iBAjBC;;AAAA;AAAA;AAAA;AAAA,iBAAF;AAkBD,aAnBM,MAmBA,IAAIuD,UAAU,CAAC7B,QAAX,KAAwB;AAAA;AAAA,8CAAakJ,OAAzC,EAAkD;AACvDtF,cAAAA,EAAE;AAAA,+CAAG,aAAY;AACf,wBAAM,MAAI,CAACsD,cAAL,CAAoBvD,GAApB,EAAyB9B,UAAzB,CAAN;AACA,sBAAMmD,UAAU,SAAS,MAAI,CAACpD,aAAL,CAAmBC,UAAnB,CAAzB;;AACA,sBAAI,CAACmD,UAAL,EAAiB;AACf;AACD;;AACD,sBAAI1G,IAAI,GAAG,IAAI;AAAA;AAAA,0CAAQ8F,aAAZ,EAAX;AACA9F,kBAAAA,IAAI,CAACE,OAAL,GAAe,KAAf;AACAF,kBAAAA,IAAI,CAACf,IAAL,GAAY,CAAZ;AACAe,kBAAAA,IAAI,CAACwB,IAAL,CAAUC,GAAV,GAAgB8B,UAAU,CAAC9B,GAA3B;AACAzB,kBAAAA,IAAI,CAACwB,IAAL,CAAUG,KAAV,GAAkB4B,UAAU,CAAC5B,KAA7B;AACA3B,kBAAAA,IAAI,CAACwB,IAAL,CAAUuE,KAAV,GAAkBxC,UAAU,CAAC3B,MAAX,CAAkBC,GAApC;AACA7B,kBAAAA,IAAI,CAACwB,IAAL,CAAUwE,CAAV,GAAc4D,QAAQ,CAAC5D,CAAvB;AACAhG,kBAAAA,IAAI,CAACwB,IAAL,CAAU6C,CAAV,GAAcxF,KAAK,GAAG+K,QAAQ,CAACvF,CAA/B;AACArE,kBAAAA,IAAI,CAACwB,IAAL,CAAUyE,QAAV,GAAqB,CAArB;AACAjG,kBAAAA,IAAI,CAACwB,IAAL,CAAU0E,KAAV,GAAkB,CAAlB;AACA;AAAA;AAAA,wCAAO/F,mBAAP,CAA2BH,IAA3B;AACD,iBAjBC;;AAAA;AAAA;AAAA;AAAA,iBAAF;AAkBD,aA1W+B,CA4WhC;AACA;AACA;;;AAEA,YAAA,MAAI,CAACqH,gBAAL,CAAsBhC,GAAtB,EAA2B9B,UAA3B;;AACA8B,YAAAA,GAAG,CACAM,cADH,CACkB,gBADlB,EAEGvE,YAFH;AAAA;AAAA,0CAGGkH,UAHH,CAII,IAAIjL,IAAJ,CAAS8K,SAAS,CAACnC,CAAnB,EAAsBmC,SAAS,CAAC9D,CAAhC,CAJJ,EAKI,IAAIhH,IAAJ,CAASgL,UAAU,CAACrC,CAApB,EAAuBqC,UAAU,CAAChE,CAAlC,CALJ,EAMIiB,EANJ;AAjXgC;AAyXjC;;AAEK5C,QAAAA,aAAa,CAACa,UAAD,EAAkB;AAAA;;AAAA;AACnC,gBAAMiE,QAAQ,GAAG;AAAA;AAAA,wBAAE/D,IAAF,CAAO;AAAA;AAAA,oDAAgB4C,OAAvB,EAAiC7C,IAAD,IAAU;AACzD,qBAAOA,IAAI,CAACmB,EAAL,KAAYpB,UAAU,CAAC3B,MAAX,CAAkBI,MAArC;AACD,aAFgB,CAAjB;AAIA,gBAAMwB,IAAI,GAAG5G,WAAW,CAAC,MAAI,CAAC4K,QAAQ,CAACC,SAAV,CAAL,CAAxB;AACAjE,YAAAA,IAAI,CAACkE,SAAL,CAAe,MAAI,CAACnE,UAAU,CAAC3B,MAAX,CAAkBC,GAAnB,CAAnB;AACA,YAAA,MAAI,WAAS0B,UAAU,CAAC3B,MAAX,CAAkBC,GAA3B,CAAJ,CAAsCrC,SAAtC,GAAkDgE,IAAlD;AACAA,YAAAA,IAAI,CAACW,WAAL,CAAiB,IAAI7G,IAAJ,CAAS,CAAT,EAAY,CAAZ,EAAe,CAAf,CAAjB;AACA,gBAAMqK,QAAgB,GAAG,CAAC,GAAGnE,IAAI,CAACoE,QAAT,CAAzB;;AACA,gBAAI,CAACD,QAAL,EAAe;AACb;AACD;;AACD,gBAAIE,WAAW,GAAG,CAAlB;AACA,gBAAIC,MAAJ;AACA,gBAAIC,MAAJ;;AACA,iBAAK,IAAMC,KAAX,IAAoBL,QAApB,EAA8B;AAC5BK,cAAAA,KAAK,CAACzC,MAAN,GAAe,IAAf;AACA,oBAAM;AAAA;AAAA,gDAAaiB,IAAb,CAAkB5H,UAAU,GAAG,IAA/B,CAAN;AACAoJ,cAAAA,KAAK,CAACrC,cAAN,CAAqB,cAArB,EAAqCJ,MAArC,GAA8C,IAA9C;AACD;AApBkC;AAqBpC;;AAED8E,QAAAA,YAAY,CAAChF,GAAD,EAAY9B,UAAZ,EAAoCsH,UAApC,EAAwD;AAClE,cAAMC,MAAM,GAAG;AAAA;AAAA,kDAAgBvH,UAAU,CAAC5B,KAA3B,EAAkCkJ,UAAlC,CAAf;AACAxF,UAAAA,GAAG,CACAM,cADH,CACkB,gBADlB,EAEGvE,YAFH;AAAA;AAAA,wCAGGmH,gBAHH,CAGoBuC,MAHpB;AAID,SAr3CqC,CAu3CtC;;;AACAC,QAAAA,eAAe,CAACC,UAAD,EAA4B,CAAE;;AAE7C9H,QAAAA,aAAa,CAAC+H,KAAD,EAAoB;AAC/B,eAAK/L,cAAL,GAAsB,KAAKkJ,WAAL,CAAiB,IAAI/K,IAAJ,CAAS,CAAT,EAAY,EAAZ,CAAjB,CAAtB,CAD+B,CAE/B;;AACA,eAAKwG,MAAL,CAAYqH,MAAZ,CAAmB9J,YAAnB;AAAA;AAAA,wCAA4C+J,QAA5C,GAAuD,IAAI9N,IAAJ,CAAS,CAAT,EAAY,EAAZ,CAAvD;;AACA,cAAM+N,GAAG,GAAG,KAAKtL,WAAL,CAAiBuL,aAAjB,CAA+B,KAAKnM,cAApC,CAAZ;;AACA,eAAK2E,MAAL,CAAYqH,MAAZ,CAAmBA,MAAnB,CAA0B/G,WAA1B,CAAsC,GAAtC,EAA2C,IAA3C;;AACA,cAAI,KAAKN,MAAL,CAAYqH,MAAZ,CAAmB9J,YAAnB;AAAA;AAAA,wCAA4CkK,MAAhD,EAAwD;AACtD,gBAAMC,QAAQ,GAAGhO,IAAI,CAACiO,cAAL,EAAjB;AACA,gBAAIC,UAAU,GAAG,KAAK5H,MAAL,CAAYqH,MAAZ,CAAmB9J,YAAnB;AAAA;AAAA,0CAA4CkK,MAA5C,CAAmDnK,IAApE;AACAsK,YAAAA,UAAU,CAACtH,WAAX,CAAuBiH,GAAG,CAACpF,CAA3B,EAA8BoF,GAAG,CAAC/G,CAAlC,EAHsD,CAKtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACD,WAzB8B,CA0B/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,eAAKqH,OAAL,CAAanG,MAAb,GAAsB,KAAtB;AACD;;AAEDlC,QAAAA,aAAa,CAAC4H,KAAD,EAAsB;AACjCA,UAAAA,KAAK,CAACU,OAAN,CAAeC,GAAD,IAAqB;AACjC,iBAAKC,YAAL,CAAkBD,GAAlB;AACD,WAFD;AAGD;;AAEDC,QAAAA,YAAY,CAACD,GAAD,EAAkB;AAC5B,cAAIpI,IAAI,GAAG5G,WAAW,CAAC,KAAKkP,iBAAN,CAAtB;AACAtI,UAAAA,IAAI,CAAC+B,MAAL,GAAc,IAAd;AACA,eAAKwG,WAAL,CAAiBC,QAAjB,CAA0BxI,IAA1B,EAH4B,CAI5B;;AACAA,UAAAA,IAAI,CAACmC,cAAL,CAAoB,gBAApB,EAAsCvE,YAAtC;AAAA;AAAA,wCAA+DuI,KAA/D,GACEiC,GAAG,CAACjH,EADN;AAEA,eAAK+E,WAAL,CAAiBuC,IAAjB,CAAsBzI,IAAtB;AACA,cAAI0I,OAAO,GAAG,IAAI7O,IAAJ,EAAd;AACA,cAAM8O,eAAe,GAAG;AAAA;AAAA,sBAAEC,QAAF,CAAW,CAAC,KAAD,EAAQ,KAAR,EAAe,KAAf,EAAsB,KAAtB,CAAX,EAAyCR,GAAG,CAACjH,EAA7C,CAAxB;;AACA,cAAIwH,eAAJ,EAAqB;AACnBD,YAAAA,OAAO,GAAG,KAAK9D,WAAL,CACR,IAAI/K,IAAJ,CAASuO,GAAG,CAAC5F,CAAJ,GAAQjH,QAAjB,EAA2BF,KAAK,GAAG+M,GAAG,CAACvH,CAAJ,GAAQtF,QAA3C,CADQ,CAAV;AAGD;;AACD,cAAMqM,GAAG,GAAG,KAAKtL,WAAL,CAAiBuL,aAAjB,CAA+Ba,OAA/B,CAAZ;;AACA,eAAK/M,aAAL,CAAmB8M,IAAnB,CAAwBC,OAAxB;;AACA1I,UAAAA,IAAI,CAACmC,cAAL,CAAoB,gBAApB,EAAsCvE,YAAtC;AAAA;AAAA,wCAA+D+J,QAA/D,GACEe,OADF;AAEA1I,UAAAA,IAAI,CAACW,WAAL,CAAiBiH,GAAG,CAACpF,CAArB,EAAwBoF,GAAG,CAAC/G,CAA5B;;AACA,cAAIuH,GAAG,CAACjH,EAAJ,KAAW,KAAf,EAAsB;AACpB;AAAA;AAAA,8CAAahB,QAAb,CAAsB0I,WAAtB,GAAoCjB,GAAG,CAACpF,CAAxC;AACA;AAAA;AAAA,8CAAarC,QAAb,CAAsB2I,WAAtB,GAAoClB,GAAG,CAAC/G,CAAxC;AACD;;AACDb,UAAAA,IAAI,CAACmC,cAAL,CAAoB,gBAApB,EAAsCvE,YAAtC;AAAA;AAAA,wCAA+DmL,QAA/D,GACE;AAAA;AAAA,oCAASX,GAAG,CAACjH,EAAb,CADF;AAEA,eAAKiB,YAAL,CAAkB,MAAM;AAAA;;AACtB;AAAA;AAAA,sCAASH,aAAT,sBACE,KAAKhB,WAAL,CAAiB,MAAjB,EAAyBmH,GAAG,CAACY,KAA7B,CADF,qBACE,kBAAqCC,UADvC,EAEEjJ,IAAI,CACDmC,cADH,CACkB,gBADlB,EAEGA,cAFH,CAEkB,UAFlB,EAGGA,cAHH,CAGkB,MAHlB,CAFF;AAOA;AAAA;AAAA,sCAASF,aAAT,CACE,EADF,EAEEjC,IAAI,CACDmC,cADH,CACkB,gBADlB,EAEGA,cAFH,CAEkB,UAFlB,EAGGA,cAHH,CAGkB,MAHlB,CAFF;AAOA;AAAA;AAAA,sCAASF,aAAT,CACE,EADF,EAEEjC,IAAI,CACDmC,cADH,CACkB,gBADlB,EAEGA,cAFH,CAEkB,UAFlB,EAGGA,cAHH,CAGkB,OAHlB,CAFF;AAOA;AAAA;AAAA,sCAASF,aAAT,CACE,EADF,EAEEjC,IAAI,CACDmC,cADH,CACkB,gBADlB,EAEGA,cAFH,CAEkB,UAFlB,EAGGA,cAHH,CAGkB,OAHlB,CAFF;;AAOA,gBAAIiG,GAAG,CAACY,KAAJ,IAAa,KAAjB,EAAwB;AAAA;;AACtB,0CAAK/H,WAAL,CAAiB,MAAjB,EAAyBmH,GAAG,CAACc,IAA7B,yCAAoCD,UAApC,KACE;AAAA;AAAA,wCAAShH,aAAT,uBACE,KAAKhB,WAAL,CAAiB,MAAjB,EAAyBmH,GAAG,CAACc,IAA7B,CADF,qBACE,mBAAoCD,UADtC,EAEEjJ,IAAI,CACDmC,cADH,CACkB,gBADlB,EAEGA,cAFH,CAEkB,UAFlB,EAGGA,cAHH,CAGkB,MAHlB,CAFF,CADF;AAQA,0CAAKlB,WAAL,CAAiB,OAAjB,EAA0BmH,GAAG,CAACe,GAA9B,yCAAoCF,UAApC,KACE;AAAA;AAAA,wCAAShH,aAAT,uBACE,KAAKhB,WAAL,CAAiB,OAAjB,EAA0BmH,GAAG,CAACe,GAA9B,CADF,qBACE,mBAAoCF,UADtC,EAEEjJ,IAAI,CACDmC,cADH,CACkB,gBADlB,EAEGA,cAFH,CAEkB,UAFlB,EAGGA,cAHH,CAGkB,OAHlB,CAFF,CADF;AAQA,0CAAKlB,WAAL,CAAiB,OAAjB,EAA0BmH,GAAG,CAACgB,OAA9B,yCAAwCH,UAAxC,KACE;AAAA;AAAA,wCAAShH,aAAT,uBACE,KAAKhB,WAAL,CAAiB,OAAjB,EAA0BmH,GAAG,CAACgB,OAA9B,CADF,qBACE,mBAAwCH,UAD1C,EAEEjJ,IAAI,CACDmC,cADH,CACkB,gBADlB,EAEGA,cAFH,CAEkB,UAFlB,EAGGA,cAHH,CAGkB,OAHlB,CAFF,CADF;AAQD;AACF,WAvDD,EAuDG,CAvDH;AAwDD;;AAEDjF,QAAAA,kBAAkB,CAACc,IAAD,EAAY;AAC5B,eAAKqK,YAAL,CAAkBrK,IAAI,CAACA,IAAL,CAAU2B,KAA5B;AACD;;AAEDvC,QAAAA,SAAS,CAACY,IAAD,EAAY;AACnB,cAAMqL,UAAU,GAAG;AAAA;AAAA,sBAAEpJ,IAAF,CACjB,KAAKiG,WADY,EAEhBlG,IAAD;AAAA;;AAAA,mBAAU,CAAAA,IAAI,QAAJ,0BAAAA,IAAI,CAAEpC,YAAN;AAAA;AAAA,iFAAgCuI,KAAhC,OAA0CnI,IAA1C,0BAA0CA,IAAI,CAAEA,IAAhD,qBAA0C,WAAYsL,MAAZ,CAAmB,CAAnB,CAA1C,CAAV;AAAA,WAFiB,CAAnB;AAIAD,UAAAA,UAAU,QAAV,IAAAA,UAAU,CAAElE,gBAAZ;AACA,eAAKe,WAAL,GAAmB;AAAA;AAAA,sBAAEqD,MAAF,CACjB,KAAKrD,WADY,EAEhBlG,IAAD;AAAA;;AAAA,mBAAU,CAAAA,IAAI,QAAJ,2BAAAA,IAAI,CAAEpC,YAAN;AAAA;AAAA,kFAAgCuI,KAAhC,OAA0CnI,IAA1C,2BAA0CA,IAAI,CAAEA,IAAhD,qBAA0C,YAAYsL,MAAZ,CAAmB,CAAnB,CAA1C,CAAV;AAAA,WAFiB,CAAnB;AAID;;AAEDE,QAAAA,qBAAqB,CAACxL,IAAD,EAAY;AAC/B,cAAI,KAAKqC,MAAL,CAAYqH,MAAZ,CAAmB9J,YAAnB;AAAA;AAAA,wCAA4CuI,KAA5C,KAAsDnI,IAAI,CAACA,IAAL,CAAUG,KAApE,EAA2E;AACzE;AACD;;AACD,cAAMsL,OAAO,GAAG;AAAA;AAAA,sBAAExJ,IAAF,CACd,KAAKiG,WADS,EAEblG,IAAD,IACEA,IAAI,CAACmC,cAAL,CAAoB,gBAApB,EAAsCvE,YAAtC;AAAA;AAAA,wCAA+DuI,KAA/D,KACAnI,IAAI,CAACA,IAAL,CAAUG,KAJE,CAAhB;AAMA,cAAIuL,QAAJ;;AACA,cAAI1L,IAAI,CAACA,IAAL,CAAUwE,CAAV,GAAciH,OAAO,CAAC7I,WAAR,GAAsB4B,CAAxC,EAA2C;AACzCkH,YAAAA,QAAQ,GAAGrQ,OAAO,CAACsQ,KAAnB;AACD;;AACD,cAAI3L,IAAI,CAACA,IAAL,CAAUwE,CAAV,GAAciH,OAAO,CAAC7I,WAAR,GAAsB4B,CAAxC,EAA2C;AACzCkH,YAAAA,QAAQ,GAAGrQ,OAAO,CAAC2L,KAAnB;AACD;;AACD,cAAIhH,IAAI,CAACA,IAAL,CAAU6C,CAAV,GAAc4I,OAAO,CAAC7I,WAAR,GAAsBC,CAAxC,EAA2C;AACzC6I,YAAAA,QAAQ,GAAGrQ,OAAO,CAACuQ,KAAnB;AACD;;AACD,cAAI5L,IAAI,CAACA,IAAL,CAAU6C,CAAV,GAAc4I,OAAO,CAAC7I,WAAR,GAAsBC,CAAxC,EAA2C;AACzC6I,YAAAA,QAAQ,GAAGrQ,OAAO,CAACwQ,KAAnB;AACD;;AACDJ,UAAAA,OAAO,CACJtH,cADH,CACkB,gBADlB,EAEGvE,YAFH;AAAA;AAAA,wCAGGmH,gBAHH,CAGoB2E,QAHpB;AAKAD,UAAAA,OAAO,CACJtH,cADH,CACkB,gBADlB,EAEGvE,YAFH;AAAA;AAAA,wCAGGkM,aAHH,CAGiBJ,QAHjB;AAIAD,UAAAA,OAAO,CACJtH,cADH,CACkB,gBADlB,EAEGvE,YAFH;AAAA;AAAA,wCAGGmM,cAHH,CAGkBL,QAHlB;AAIA/P,UAAAA,KAAK,CAAC8P,OAAD,CAAL,CACGO,EADH,CAEI,IAFJ,EAGI;AAAEC,YAAAA,QAAQ,EAAE,IAAInQ,IAAJ,CAASkE,IAAI,CAACA,IAAL,CAAUwE,CAAnB,EAAsBxE,IAAI,CAACA,IAAL,CAAU6C,CAAhC,EAAmC,CAAnC;AAAZ,WAHJ,EAII;AACEqJ,YAAAA,UAAU,EAAE,MAAM,CAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACD;AAbH,WAJJ,EAoBG3N,KApBH;AAqBD;;AAEDqI,QAAAA,WAAW,CAACuF,UAAD,EAAuC;AAChD,cAAMC,OAAO,GAAG,KAAKzM,IAAL,CAAUC,YAAV,CAAuBhE,WAAvB,EAAoCyQ,WAApD;AACA,cAAMC,QAAQ,GAAG,KAAK1M,YAAL,CAAkBnE,QAAlB,EAA4B8Q,WAA5B,EAAjB;AACA,cAAM/H,CAAC,GAAGgI,IAAI,CAACC,KAAL,CAAWN,UAAU,CAAC3H,CAAX,GAAe8H,QAAQ,CAACI,KAAnC,CAAV;AACA,cAAM7J,CAAC,GAAG2J,IAAI,CAACC,KAAL,CAAW,CAACL,OAAO,CAACO,MAAR,GAAiBR,UAAU,CAACtJ,CAA7B,IAAkCyJ,QAAQ,CAACK,MAAtD,CAAV;AACA,iBAAO,IAAI9Q,IAAJ,CAAS2I,CAAT,EAAY3B,CAAC,GAAG,CAAhB,CAAP;AACD;;AAES+J,QAAAA,SAAS,GAAS;AAC1B;AAAA;AAAA,oCAASC,GAAT,CAAa;AAAA;AAAA,sCAAU9N,kBAAvB,EAA2C,KAAKC,SAAhD,EAA2D,IAA3D,EAD0B,CAE1B;AACA;AACD;;AAEK8N,QAAAA,aAAa,GAAG,CACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAdoB;AAerB;;AAEKC,QAAAA,cAAc,GAAG,CACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AARqB;AAStB;;AAEKrN,QAAAA,uBAAuB,CAACM,IAAD,EAAO;AAAA;;AAAA;AAClC,aAAAA,IAAI,QAAJ,YAAAA,IAAI,CAAEA,IAAN,KACEA,IAAI,CAACA,IAAL,CAAUmK,OAAV,iCAAkB,WAAO6C,MAAP,EAAkB;AAClC,kBACEA,MAAM,CAACzI,KAAP,KAAiB,WAAjB,IACAyI,MAAM,CAACzI,KAAP,KAAiB,WADjB,IAEAyI,MAAM,CAACzI,KAAP,KAAiB,WAFjB,IAGAyI,MAAM,CAACzI,KAAP,KAAiB,WAJnB,EAKE;AACA,oBAAIyI,MAAM,CAACtI,KAAP,KAAiB,GAArB,EAA0B;AACxB,wBAAM,MAAI,CAACxD,aAAL,CAAmB;AACvBd,oBAAAA,MAAM,EAAE;AACNC,sBAAAA,GAAG,EAAE2M,MAAM,CAACzI,KADN;AAEN/D,sBAAAA,MAAM,EAAEwM,MAAM,CAAC5M,MAAP,CAAcI;AAFhB;AADe,mBAAnB,CAAN;AAMD;AACF;AACF,aAhBD,EADF;AADkC;AAmBnC;;AAEKhB,QAAAA,iBAAiB,CAACQ,IAAD,EAAO;AAAA;;AAAA;AAC5B,gBACEA,IAAI,CAACA,IAAL,CAAUK,GAAV,KAAkB,WAAlB,IACAL,IAAI,CAACA,IAAL,CAAUK,GAAV,KAAkB,WADlB,IAEAL,IAAI,CAACA,IAAL,CAAUK,GAAV,KAAkB,WAHpB,EAIE;AACA,kBAAIL,IAAI,CAACA,IAAL,CAAU0E,KAAV,KAAoB,GAAxB,EAA6B;AAC3B,sBAAM,MAAI,CAACxD,aAAL,CAAmB;AACvBd,kBAAAA,MAAM,EAAE;AACNC,oBAAAA,GAAG,EAAEL,IAAI,CAACK,GADJ;AAENG,oBAAAA,MAAM,EAAER,IAAI,CAACI,MAAL,CAAYI;AAFd;AADe,iBAAnB,CAAN;AAMD;AACF;AAd2B;AAe7B;;AAEKyM,QAAAA,MAAM,CAACC,SAAD,EAAoB;AAAA;;AAAA;AAC9B,YAAA,OAAI,CAACtP,aAAL,GAAqB,OAAI,CAACA,aAAL,GAAqBsP,SAA1C;;AACA,gBAAI,OAAI,CAACtP,aAAL,GAAqBT,cAAzB,EAAyC;AACvC,cAAA,OAAI,CAACqF,aAAL,CAAmB,OAAI,CAAC3E,iBAAxB;;AACA,cAAA,OAAI,CAACA,iBAAL,GAAyB,EAAE,OAAI,CAACA,iBAAP,GAA2B,CAA3B,GAA+B,CAA/B,GAAmC,CAA5D;AACA,cAAA,OAAI,CAACD,aAAL,GAAqB,CAArB;AACD;;AAED,gBAAI,OAAI,CAACS,cAAL,KAAwB,CAA5B,EAA+B;AAC7B,cAAA,OAAI,CAACA,cAAL,GAAsB,OAAI,CAACA,cAAL,GAAsB6O,SAA5C;;AACA,cAAA,OAAI,CAACH,cAAL;AACD;;AACD,gBAAI,OAAI,CAAC3O,cAAL,KAAwB,CAA5B,EAA+B;AAC7B,cAAA,OAAI,CAACA,cAAL,GAAsB,OAAI,CAACA,cAAL,GAAsB8O,SAA5C;AACA,oBAAM,OAAI,CAACJ,aAAL,EAAN;AACD;AAf6B;AAgB/B;;AA3qDqC,O;;;;;iBAET,E;;;;;;;iBAGP,I;;;;;;;iBAGW,I;;;;;;;iBAGN,I;;;;;;;iBAGD,I;;;;;;;iBAGmB,I;;;;;;;iBAGtB,I;;;;;;;iBAGQ,I;;;;;;;iBAGE,I;;;;;;;iBAGN,I;;;;;;;iBAGD,I;;;;;;;iBAGD,I;;;;;;;iBAGG,I;;;;;;;iBAGH,I;;;;;;;iBAGA,I;;;;;;;iBAGA,I;;;;;;;iBAGA,I;;;;;;;iBAGS,I;;;;;;;iBAGF,I;;;;;;;iBAGL,I;;;;;;;iBAGK,I;;;;;;;iBAGF,I;;;;;;;iBAGF,I;;;;;;;iBAGK,I;;;;;;;iBAGF,I;;;;;;;iBAGF,I","sourcesContent":["import {\n  _decorator,\n  Component,\n  instantiate,\n  KeyCode,\n  Label,\n  Node,\n  TiledLayer,\n  TiledMap,\n  TiledObjectGroup,\n  tween,\n  UITransform,\n  Vec2,\n  Vec3,\n  view,\n} from \"cc\";\nimport { modelMgr, observer, socket } from \"../game/App\";\nimport { EventType } from \"../EventType\";\nimport { NPCServerD } from \"../game/config/DataStruct\";\nimport { network } from \"../model/RequestData\";\nimport WebUtils from \"../utils/WebUtils\";\nimport {\n  BubbleImgUrl,\n  EventNpcInfoMap,\n  NpcEventType,\n  NpcIndex,\n  NPCPartDisplayInfo,\n  ProductsItemUrl,\n} from \"../StaticUtils/NPCConfig\";\nimport { frameSpeed, NPCControl } from \"../NPC/NPCControl\";\nimport _, { lte } from \"lodash\";\nimport { DataEvents, DataFarmEvent } from \"../model/DataEvents\";\nimport { PromiseUtils } from \"../StaticUtils/PromiseUtils\";\nimport { GlobalConfig } from \"../game/config/GlobalConfig\";\nimport { NPCDirect } from \"../StaticUtils/KeyCodeUtils\";\nconst { ccclass, property } = _decorator;\nexport const sleepFramePosX = [40, -61];\nexport const sleepFrameTime = 0.45;\nexport const bubbleTime = 0.7;\n\nexport const hight = 6720;\n\nexport const wight = 640;\n// 434, 820\nconst PosAdapt = 1;\ndeclare global {\n  interface Window {\n    farmGoSleep: any;\n    farm: any;\n    farmcook: any;\n    farmeat: any;\n    fieldReady: any;\n\n    herdSleep: any;\n    herdCook: any;\n    herdDinning: any;\n\n    bakerSleep: any;\n    bakerCook: any;\n    bakerDinning: any;\n\n    GrocerSleep: any;\n    GrocerCook: any;\n    GrocerDinning: any;\n    farmHarvest: any;\n    farmStopSleep: any;\n  }\n}\n@ccclass(\"TownView\")\nexport class TownView extends Component {\n  @property({ type: [Node] })\n  public otherNPCarr: Node[] = [];\n\n  @property(Node)\n  public player: Node = null;\n\n  @property(Node)\n  public playerInstantiate: Node = null;\n\n  @property(Node)\n  public playerLayer: Node = null;\n\n  @property(Node)\n  public playerNode: Node = null;\n\n  @property({ type: TiledObjectGroup })\n  public tileObject: TiledObjectGroup | null = null;\n\n  @property(Node)\n  public loading: Node = null;\n\n  @property(Node)\n  public farmHomeBedHead: Node = null;\n\n  @property(Node)\n  public farmHomeBedBubble: Node = null;\n\n  @property(Node)\n  public farmDinning: Node = null;\n\n  @property(Node)\n  public fieldWheat: Node = null;\n\n  @property(Node)\n  public fieldCorn: Node = null;\n\n  @property(Node)\n  public fieldCabbage: Node = null;\n\n  @property(Node)\n  public farmland1: Node = null;\n\n  @property(Node)\n  public farmland2: Node = null;\n\n  @property(Node)\n  public farmland3: Node = null;\n\n  @property(Node)\n  public farmland4: Node = null;\n\n  @property(Node)\n  public herdmanHomeBedHead: Node = null;\n\n  @property(Node)\n  public herdmanBedBubble: Node = null;\n\n  @property(Node)\n  public herdDinning: Node = null;\n\n  @property(Node)\n  public bakerHomeBedHead: Node = null;\n\n  @property(Node)\n  public bakerBedBubble: Node = null;\n\n  @property(Node)\n  public bakerDinning: Node = null;\n\n  @property(Node)\n  public grocerHomeBedHead: Node = null;\n\n  @property(Node)\n  public grocerBedBubble: Node = null;\n\n  @property(Node)\n  public grocerDinning: Node = null;\n\n  private _curPlayerTile = new Vec2();\n\n  _npcTileArray: Vec2[] = [];\n  sleepFrameAdd = 0;\n  homeBedFrameIndex = 0;\n\n  info_farmland1 = {\n    farmland: \"farmland1\",\n    fieldNode: null,\n  };\n\n  info_farmland2 = {\n    farmland: \"farmland2\",\n    fieldNode: null,\n  };\n\n  info_farmland3 = {\n    farmland: \"farmland3\",\n    fieldNode: null,\n  };\n\n  info_farmland4 = {\n    farmland: \"farmland4\",\n    fieldNode: null,\n  };\n\n  // farmland4 = [];\n\n  // farmland3 = [];\n\n  // farmland1 = [];\n\n  testFrameIndex = 0;\n  testbakerIndex = 0;\n\n  private _layerFloor: TiledLayer = null!;\n  async start() {\n    let json = new network.GetAllNPCRequest();\n    json.command = 10002;\n    json.type = 1;\n    socket.sendWebSocketBinary(json);\n\n    modelMgr.townModel.refreshItemDate();\n\n    observer.on(EventType.SOCKET_GETALL_NPCS, this.setNPCPos, this);\n    observer.on(EventType.SOCKET_ONLINE_NPCS, this.initOtherNPCByData, this);\n    observer.on(EventType.SOCKET_OFFLINE_NPCS, this.removeNPC, this);\n    //observer.on(EventType.SOCKET_NPC_MOVE, this.updateOtherPlayerInfo, this);\n    observer.on(EventType.SOCKET_NPC_ACTION, this.playNPCAction, this);\n\n    observer.on(\n      EventType.SOCKET_ITEM_STATE_CHANGE,\n      this.objectStateChange,\n      this\n    );\n\n    observer.on(\n      EventType.SOCKET_ITEMUPDATE,\n      this.updateObjectStateChange,\n      this\n    );\n\n    observer.on(\n      EventType.SOCKET_ITEMUPDATE,\n      this.updateObjectStateChange,\n      this\n    );\n\n    this._layerFloor = this.node.getComponent(TiledMap).getLayer(\"building\")!;\n\n    // this.farmland4 = [...this.farmFieldWheat.children];\n\n    // this.farmland3 = [...this.farmFieldCorn.children];\n\n    // this.farmland1 = [...this.farmFieldCabbage.children];\n    //!herd\n    window.herdSleep = () => {\n      this.playNPCAction({\n        data: {\n          data: {\n            bid: 10,\n            actionId: 106,\n            npcId: 10004,\n            params: {\n              oid: \"breedingBed\",\n            },\n          },\n        },\n      });\n    };\n\n    window.herdCook = () => {\n      this.playNPCAction({\n        data: {\n          data: {\n            bid: 11,\n            actionId: 104,\n            npcId: 10004,\n            params: {\n              oid: \"breedingCook\",\n              items: [\n                {\n                  itemId: 10101006,\n                  count: 1,\n                },\n                {\n                  itemId: 10101003,\n                  count: 1,\n                },\n                {\n                  itemId: 10101005,\n                  count: 1,\n                },\n              ],\n            },\n          },\n        },\n      });\n    };\n\n    window.herdDinning = () => {\n      this.playNPCAction({\n        bid: 12,\n        actionId: 105,\n        npcId: 10004,\n        params: {\n          oid: \"breedingTable\",\n        },\n      });\n    };\n\n    //!farmer\n\n    window.farm = async () => {\n      await this.playNPCAction({\n        data: {\n          data: {\n            bid: 13,\n            actionId: 100,\n            npcId: 10002,\n            params: {\n              oid: \"farmland4\",\n              itemId: 10101001,\n            },\n          },\n        },\n      });\n    };\n\n    window.farmHarvest = () => {\n      this.playNPCAction({\n        data: {\n          data: {\n            bid: 14,\n            actionId: 101,\n            npcId: 10002,\n            params: {\n              oid: \"farmland4\",\n              items: [\n                {\n                  itemId: 10101001,\n                  count: 1,\n                },\n              ],\n            },\n          },\n        },\n      });\n    };\n\n    window.farmGoSleep = () => {\n      this.playNPCAction({\n        data: {\n          data: {\n            bid: 15,\n            actionId: 106,\n            npcId: 10002,\n            params: {\n              oid: \"farmerBed\",\n            },\n          },\n        },\n      });\n    };\n\n    window.farmStopSleep = () => {\n      this.playNPCAction({\n        data: {\n          data: {\n            bid: 15,\n            actionId: 111,\n            npcId: 10002,\n            params: {\n              oid: \"farmerBed\",\n            },\n          },\n        },\n      });\n    };\n\n    window.farmcook = () => {\n      this.playNPCAction({\n        bid: 16,\n        actionId: 104,\n        npcId: 10002,\n        params: {\n          oid: \"farmerCook\",\n          items: [\n            {\n              itemId: 10101006,\n              count: 1,\n            },\n            {\n              itemId: 10101003,\n              count: 1,\n            },\n            {\n              itemId: 10101005,\n              count: 1,\n            },\n          ],\n        },\n      });\n    };\n\n    window.farmeat = () => {\n      this.playNPCAction({\n        bid: 17,\n        actionId: 105,\n        npcId: 10002,\n        params: {\n          oid: \"farmerTable\",\n        },\n      });\n    };\n\n    window.fieldReady = () => {\n      this.setFieldReady({\n        bid: 18,\n        actionId: 105,\n        npcId: 10002,\n        params: {\n          oid: \"farmland4\",\n        },\n      });\n    };\n\n    //!baker\n    window.bakerSleep = () => {\n      this.playNPCAction({\n        bid: 18,\n        actionId: 106,\n        npcId: 10005,\n        params: {\n          oid: \"bakerBed\",\n        },\n      });\n    };\n\n    window.bakerCook = () => {\n      this.playNPCAction({\n        bid: 19,\n        actionId: 104,\n        npcId: 10005,\n        params: {\n          oid: \"bakerCook\",\n          items: [\n            {\n              itemId: 10101006,\n              count: 1,\n            },\n            {\n              itemId: 10101003,\n              count: 1,\n            },\n            {\n              itemId: 10101005,\n              count: 1,\n            },\n          ],\n        },\n      });\n    };\n\n    window.bakerDinning = () => {\n      this.playNPCAction({\n        bid: 20,\n        actionId: 105,\n        npcId: 10005,\n        params: {\n          oid: \"bakerTable\",\n        },\n      });\n    };\n    //!baker\n    window.GrocerSleep = () => {\n      this.playNPCAction({\n        bid: 21,\n        actionId: 106,\n        npcId: 10003,\n        params: {\n          oid: \"salerBed\",\n        },\n      });\n    };\n\n    window.GrocerCook = () => {\n      this.playNPCAction({\n        bid: 22,\n        actionId: 104,\n        npcId: 10003,\n        params: {\n          oid: \"salerCook\",\n          items: [\n            {\n              itemId: 10101006,\n              count: 1,\n            },\n            {\n              itemId: 10101003,\n              count: 1,\n            },\n            {\n              itemId: 10101005,\n              count: 1,\n            },\n          ],\n        },\n      });\n    };\n\n    window.GrocerDinning = () => {\n      this.playNPCAction({\n        bid: 23,\n        actionId: 105,\n        npcId: 10003,\n        params: {\n          oid: \"salerTable\",\n        },\n      });\n    };\n    //await this.testFarmRound()\n    //await this.testBakerRound()\n    //this.tiledLayer.addUserNode(this.playerNode)\n  }\n\n  setNPCPos(NPCs: any) {\n    if (!NPCs) {\n      return;\n    }\n    this.initPlayerNPC(NPCs.data.data.myNpc);\n    NPCs?.data?.data?.otherNpc && this.initOtherNPCs(NPCs.data.data.otherNpc);\n  }\n\n  async checkPlayerId(actionData) {\n    const item = _.find(actionData.users, (item) => {\n      return item === GlobalConfig.instance.LoginData.data.player.playerId;\n    });\n    if (item || !actionData?.users?.length) {\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  setNpcHomeBed(currentIndex: number) {\n    this.farmHomeBedHead.setPosition(\n      sleepFramePosX[currentIndex],\n      this.farmHomeBedHead.getPosition().y\n    );\n    this.herdmanHomeBedHead.setPosition(\n      sleepFramePosX[currentIndex],\n      this.herdmanHomeBedHead.getPosition().y\n    );\n    this.bakerHomeBedHead.setPosition(\n      sleepFramePosX[currentIndex],\n      this.bakerHomeBedHead.getPosition().y\n    );\n    this.grocerHomeBedHead.setPosition(\n      sleepFramePosX[currentIndex],\n      this.grocerHomeBedHead.getPosition().y\n    );\n  }\n\n  getPartInfo(label: string, id: number) {\n    return NPCPartDisplayInfo[label]?.find((part) => part.id === id) ?? null;\n  }\n\n  //!npc睡觉相关\n  getSleepNode(npcId: number) {\n    switch (npcId) {\n      case 10002:\n        return {\n          head: this.farmHomeBedHead,\n          bubble: this.farmHomeBedBubble,\n        };\n      case 10004:\n        return {\n          head: this.herdmanHomeBedHead,\n          bubble: this.herdmanBedBubble,\n        };\n      case 10005:\n        return {\n          head: this.bakerHomeBedHead,\n          bubble: this.bakerBedBubble,\n        };\n      case 10003:\n        return {\n          head: this.grocerHomeBedHead,\n          bubble: this.grocerBedBubble,\n        };\n        //按照id分别返回对应的node\n        break;\n      default:\n        return {\n          head: this.farmHomeBedHead,\n          bubble: this.farmHomeBedBubble,\n        };\n        break;\n    }\n  }\n\n  stopNpcSleep(npc: Node, actionData: DataEvents, cb?: () => void) {\n    switch (actionData.npcId) {\n      case 10002:\n        this.farmHomeBedHead.active = false;\n        this.farmHomeBedBubble.active = false;\n        npc.active = true;\n        break;\n      case 10004:\n        this.herdmanHomeBedHead.active = false;\n        this.herdmanBedBubble.active = false;\n        npc.active = true;\n        break;\n      case 10005:\n        this.bakerHomeBedHead.active = false;\n        this.bakerBedBubble.active = false;\n        npc.active = true;\n        break;\n      case 10003:\n        this.grocerHomeBedHead.active = false;\n        this.grocerBedBubble.active = false;\n        npc.active = true;\n        break;\n        //按照id分别返回对应的node\n        break;\n      default:\n        break;\n    }\n  }\n\n  npcSleep(npc: Node, head: Node, bubble: Node, cb?: () => void) {\n    WebUtils.getResouceImg(\n      BubbleImgUrl.sleep,\n      npc.getChildByName(\"bubble\"),\n      () => {\n        npc.getChildByName(\"bubble\").active = true;\n      }\n    );\n    this.scheduleOnce(() => {\n      cb();\n      head.active = true;\n      bubble.active = true;\n    }, bubbleTime);\n  }\n\n  sendEventOver(actionData: DataEvents, npc) {\n    let json = new network.NpcActionDone();\n    json.command = 10008;\n    json.type = 1;\n    json.data.bid = actionData.bid;\n    json.data.npcId = actionData.npcId;\n    json.data.objId = actionData.params.oid;\n    json.data.x = npc.getPosition().x;\n    json.data.y = hight - npc.getPosition().y;\n    json.data.isFinish = 1;\n    json.data.state = 1;\n    json.data.params = {\n      oid: actionData.params.oid,\n      itemId: actionData.params.itemId,\n      count: 1,\n    };\n    socket.sendWebSocketBinary(json);\n  }\n\n  //!npc做饭相关\n  async npcCook(npc: Node, actionData: DataEvents, cb?: () => void) {\n    for (const foodItem of actionData.params.items) {\n      const food = _.find(ProductsItemUrl.ItemCfg, (item) => {\n        return item.id === foodItem.itemId;\n      });\n      WebUtils.getResouceImg(food.url, npc.getChildByName(\"bubble\"), () => {\n        npc.getChildByName(\"bubble\").active = true;\n      });\n\n      await PromiseUtils.wait(bubbleTime * 2000);\n      WebUtils.getResouceImg(BubbleImgUrl.cook, npc.getChildByName(\"bubble\"));\n\n      const shouldSend = await this.checkPlayerId(actionData);\n\n      if (shouldSend) {\n        let json = new network.NpcActionDone();\n        json.command = 10008;\n        json.type = 1;\n        json.data.bid = actionData.bid;\n        json.data.npcId = actionData.npcId;\n        json.data.objId = actionData.params.oid;\n        json.data.x = npc.getPosition().x;\n        json.data.y = hight - npc.getPosition().y;\n        json.data.isFinish = 1;\n        json.data.state = 1;\n        json.data.params = {\n          oid: actionData.params.oid,\n          itemId: actionData.params.itemId,\n          count: 1,\n        };\n        socket.sendWebSocketBinary(json);\n        await PromiseUtils.wait(bubbleTime * 2000);\n      }\n    }\n  }\n\n  stopCook(npc: Node, cb?: () => void) {\n    npc.getChildByName(\"bubble\").active = false;\n  }\n\n  //!吃饭相关\n  async npcDinning(npc: Node, actionData: DataEvents) {\n    WebUtils.getResouceImg(\n      BubbleImgUrl.eating,\n      npc.getChildByName(\"bubble\"),\n      () => {\n        npc.getChildByName(\"bubble\").active = true;\n      }\n    );\n    const dinning = this.getDinning(actionData.npcId);\n    WebUtils.getResouceImg(BubbleImgUrl.dinning, dinning.dinning, () => {\n      dinning.dinning.active = true;\n    });\n\n    await PromiseUtils.wait(bubbleTime * 4000);\n    WebUtils.getResouceImg(BubbleImgUrl.afterDinner, dinning.dinning, () => {\n      WebUtils.getResouceImg(\n        BubbleImgUrl.eat,\n        npc.getChildByName(\"bubble\"),\n        () => {}\n      );\n    });\n    await PromiseUtils.wait(bubbleTime * 2000);\n  }\n\n  getDinning(npcId: number) {\n    switch (npcId) {\n      case 10002:\n        return {\n          dinning: this.farmDinning,\n        };\n      case 10004:\n        return {\n          dinning: this.herdDinning,\n        };\n      case 10005:\n        return {\n          dinning: this.bakerDinning,\n        };\n      case 10003:\n        return {\n          dinning: this.grocerDinning,\n        };\n        //按照id分别返回对应的node\n        break;\n      default:\n        return {\n          dinning: this.farmDinning,\n        };\n        break;\n    }\n  }\n\n  stopDinning(npc: Node, cb?: () => void) {\n    npc.getChildByName(\"bubble\").active = false;\n  }\n\n  stopActionNormal(npc: Node, actionData: DataEvents, cb?: () => void) {\n    this.stopNpcSleep(npc, actionData, cb);\n    npc.getChildByName(\"bubble\").active = false;\n  }\n\n  setItemCountChange() {}\n\n  //!农夫种地\n  async npcFarming(npc: Node, actionData: DataEvents) {\n    if (!this[actionData.params.oid]) {\n      return;\n    }\n\n    const farmItem = _.find(ProductsItemUrl.ItemCfg, (item) => {\n      return item.id === actionData.params.itemId;\n    });\n\n    const item = instantiate(this[farmItem.fieldName]) as Node;\n    item.setParent(this[actionData.params.oid]);\n    this[`info_${actionData.params.oid}`].fieldNode = item;\n    item.setPosition(new Vec3(0, 0, 0));\n    const fieldArr: Node[] = [...item.children];\n    actionData.params.itemId;\n\n    let fieldIndexX = 1;\n    let adaptX;\n    let adaptY;\n    for (const field of fieldArr) {\n      if (fieldIndexX % 3 === 0) {\n        adaptX = -1;\n        adaptY = 0;\n      } else {\n        adaptX = 0;\n        adaptY = fieldIndexX === 4 || fieldIndexX === 5 ? -1 : 1;\n      }\n      //?锄头气泡\n      WebUtils.getResouceImg(\n        BubbleImgUrl.farmerHoe,\n        npc.getChildByName(\"bubble\"),\n        () => {\n          npc.getChildByName(\"bubble\").active = true;\n        }\n      );\n\n      await PromiseUtils.wait(bubbleTime * 2000);\n      //?幼苗🌱出现\n      field.active = true;\n      await PromiseUtils.wait(bubbleTime * 2000);\n      //?浇水气泡\n      WebUtils.getResouceImg(\n        BubbleImgUrl.farmerWater,\n        npc.getChildByName(\"bubble\")\n      );\n      await PromiseUtils.wait(bubbleTime * 2000);\n\n      const startTile = this._getTilePos(\n        new Vec2(npc.getPosition().x, npc.getPosition().y)\n      );\n      const finishTile = this._getTilePos(\n        new Vec2(\n          npc.getPosition().x + adaptX * 32,\n          npc.getPosition().y + adaptY * 32\n        )\n      );\n      npc\n        .getChildByName(\"NPCinstantiate\")\n        .getComponent(NPCControl)\n        .aStartMove(\n          new Vec2(startTile.x, startTile.y),\n          new Vec2(finishTile.x, finishTile.y),\n          () => {\n            npc\n              .getChildByName(\"NPCinstantiate\")\n              .getComponent(NPCControl)\n              .setNPCMoveDirect(KeyCode.KEY_A);\n          }\n        );\n\n      fieldIndexX = fieldIndexX + 1;\n      await PromiseUtils.wait(bubbleTime * 2000);\n    }\n  }\n\n  //!农夫收\n  async npcHarvest(npc: Node, actionData: DataEvents) {\n    const farmItem = _.find(ProductsItemUrl.ItemCfg, (item) => {\n      return item.id === actionData.params.itemId;\n    });\n    const item = this[`info_${actionData.params.oid}`].fieldNode;\n    const fieldArr: Node[] = [...item.children];\n    let fieldIndexX = 1;\n    let adaptX;\n    let adaptY;\n    for (const field of fieldArr) {\n      if (fieldIndexX % 3 === 0) {\n        adaptX = -2;\n        adaptY = 0;\n      } else {\n        adaptX = 0;\n        adaptY = fieldIndexX === 4 || fieldIndexX === 5 ? -2 : 2;\n      }\n      //?锄头气泡\n      WebUtils.getResouceImg(\n        BubbleImgUrl.farmerSickle,\n        npc.getChildByName(\"bubble\"),\n        () => {\n          npc.getChildByName(\"bubble\").active = true;\n        }\n      );\n\n      await PromiseUtils.wait(bubbleTime * 2000);\n      //作物\n      field.active = false;\n      field.getChildByName(\"farm_wheat_l\").active = false;\n      await PromiseUtils.wait(bubbleTime * 2000);\n      //出现作物收获图标\n      const food = _.find(ProductsItemUrl.ItemCfg, (item) => {\n        return item.id === actionData.params.itemId;\n      });\n      WebUtils.getResouceImg(food.url, npc.getChildByName(\"bubble\"));\n      npc.getChildByName(\"count\").active = true;\n      await PromiseUtils.wait(bubbleTime * 2000);\n      npc.getChildByName(\"count\").active = false;\n      npc.getChildByName(\"bubble\").active = false;\n      const startTile = this._getTilePos(\n        new Vec2(npc.getPosition().x, npc.getPosition().y)\n      );\n      const finishTile = this._getTilePos(\n        new Vec2(\n          npc.getPosition().x + adaptX * 32,\n          npc.getPosition().y + adaptY * 32\n        )\n      );\n      npc\n        .getChildByName(\"NPCinstantiate\")\n        .getComponent(NPCControl)\n        .aStartMove(\n          new Vec2(startTile.x, startTile.y),\n          new Vec2(finishTile.x, finishTile.y),\n          () => {\n            npc\n              .getChildByName(\"NPCinstantiate\")\n              .getComponent(NPCControl)\n              .setNPCMoveDirect(KeyCode.KEY_A);\n          }\n        );\n\n      fieldIndexX = fieldIndexX + 1;\n      if (fieldIndexX >= 9) {\n        // let json = new network.NpcActionDone();\n        // json.command = 10008;\n        // json.type = 1;\n        // json.data.bid = actionData.bid\n        // json.data.npcId = actionData.npcId\n        // json.data.objId = actionData.params.oid\n        // socket.sendWebSocketBinary(json);\n      }\n      await PromiseUtils.wait(bubbleTime * 2000);\n    }\n\n    item.removeFromParent();\n    this[`info_${actionData.params.oid}`].fieldNode = null;\n  }\n\n  //!牧民喂养\n  async butcherFeeding(npc: Node, actionData: DataEvents) {\n    const img = \"action/bubble/farm/wheat\";\n    WebUtils.getResouceImg(img, npc.getChildByName(\"bubble\"), () => {\n      npc.getChildByName(\"bubble\").active = true;\n    });\n    npc\n      .getChildByName(\"count\")\n      .getComponent(Label).string = `-${actionData.params.count}`;\n    npc.getChildByName(\"count\").active = true;\n    await PromiseUtils.wait(bubbleTime * 2000);\n    npc.getChildByName(\"count\").active = false;\n\n    WebUtils.getResouceImg(\n      BubbleImgUrl.clean,\n      npc.getChildByName(\"bubble\"),\n      () => {\n        npc.getChildByName(\"bubble\").active = true;\n      }\n    );\n    //npc.getChildByName('count').active = true\n    await PromiseUtils.wait(bubbleTime * 2000);\n    //npc.getChildByName('count').active = false\n\n    npc.getChildByName(\"bubble\").active = false;\n  }\n\n  async butcherSkill(npc: Node, actionData: DataEvents) {\n    const img = \"action/bubble/farm/wheat\";\n    WebUtils.getResouceImg(\n      BubbleImgUrl.knife,\n      npc.getChildByName(\"bubble\"),\n      () => {\n        npc.getChildByName(\"bubble\").active = true;\n      }\n    );\n    await PromiseUtils.wait(bubbleTime * 2000);\n\n    WebUtils.getResouceImg(\n      \"action/bubble/cook/hock\",\n      npc.getChildByName(\"bubble\"),\n      () => {\n        npc.getChildByName(\"bubble\").active = true;\n      }\n    );\n    npc.getChildByName(\"count\").active = true;\n    npc\n      .getChildByName(\"count\")\n      .getComponent(Label).string = `+${actionData.params.count}`;\n    await PromiseUtils.wait(bubbleTime * 2000);\n    npc.getChildByName(\"count\").active = false;\n    npc.getChildByName(\"bubble\").active = false;\n  }\n\n  async breadMake(npc: Node, actionData: DataEvents) {\n    const img = \"action/bubble/farm/wheat\";\n    WebUtils.getResouceImg(\n      \"action/bubble/farm/wheat\",\n      npc.getChildByName(\"bubble\"),\n      () => {\n        npc.getChildByName(\"bubble\").active = true;\n      }\n    );\n    npc\n      .getChildByName(\"count\")\n      .getComponent(Label).string = `-${actionData.params.items[0].count}`;\n    npc.getChildByName(\"count\").active = true;\n    await PromiseUtils.wait(bubbleTime * 2000);\n    npc.getChildByName(\"count\").active = false;\n\n    WebUtils.getResouceImg(\n      \"action/bubble/cook/bread\",\n      npc.getChildByName(\"bubble\"),\n      () => {\n        npc.getChildByName(\"bubble\").active = true;\n      }\n    );\n    npc\n      .getChildByName(\"count\")\n      .getComponent(Label).string = `+${actionData.params.items[0].count}`;\n    npc.getChildByName(\"count\").active = true;\n    await PromiseUtils.wait(bubbleTime * 2000);\n    npc.getChildByName(\"count\").active = false;\n    npc.getChildByName(\"bubble\").active = false;\n  }\n\n  //售货员\n  async sale(npc: Node, actionData: DataEvents) {\n    const item = _.find(ProductsItemUrl.ItemCfg, (item) => {\n      return item.id === actionData.params.itemId;\n    });\n    WebUtils.getResouceImg(item.url, npc.getChildByName(\"bubble\"), () => {\n      npc.getChildByName(\"bubble\").active = true;\n    });\n    npc\n      .getChildByName(\"count\")\n      .getComponent(Label).string = `-${actionData.params.count}`;\n    npc.getChildByName(\"count\").active = true;\n    await PromiseUtils.wait(bubbleTime * 2000);\n    npc.getChildByName(\"count\").active = false;\n\n    WebUtils.getResouceImg(\n      \"action/bubble/sale/money\",\n      npc.getChildByName(\"bubble\"),\n      () => {\n        npc.getChildByName(\"bubble\").active = true;\n      }\n    );\n\n    npc.getChildByName(\"count\").getComponent(Label).string = `+${\n      actionData.params.count * actionData.params.price\n    }`;\n    npc.getChildByName(\"count\").active = true;\n    await PromiseUtils.wait(bubbleTime * 2000);\n    npc.getChildByName(\"count\").active = false;\n    npc.getChildByName(\"bubble\").active = false;\n  }\n\n  async buy(npc: Node, actionData: DataEvents) {\n    const item = _.find(ProductsItemUrl.ItemCfg, (item) => {\n      return item.id === actionData.params.itemId;\n    });\n    WebUtils.getResouceImg(\n      \"action/bubble/sale/money\",\n      npc.getChildByName(\"bubble\"),\n      () => {\n        npc.getChildByName(\"bubble\").active = true;\n      }\n    );\n    npc.getChildByName(\"count\").getComponent(Label).string = `-${\n      actionData.params.count * actionData.params.price\n    }`;\n    npc.getChildByName(\"count\").active = true;\n    await PromiseUtils.wait(bubbleTime * 2000);\n    npc.getChildByName(\"count\").active = false;\n\n    WebUtils.getResouceImg(item.url, npc.getChildByName(\"bubble\"), () => {\n      npc.getChildByName(\"bubble\").active = true;\n    });\n    npc\n      .getChildByName(\"count\")\n      .getComponent(Label).string = `+${actionData.params.count}`;\n    npc.getChildByName(\"count\").active = true;\n    await PromiseUtils.wait(bubbleTime * 2000);\n    npc.getChildByName(\"count\").active = false;\n    npc.getChildByName(\"bubble\").active = false;\n  }\n\n  speak(npc, actionData) {\n    npc.getChildByName(\"speakContentUp\").getChildByName('Label').getComponent(Label).string =\n      actionData.params.content;\n    npc.getChildByName(\"speakContentUp\").active = true;\n    this.scheduleOnce(()=>{\n      npc.getChildByName(\"speakContentUp\").active = false;\n    }, 4)\n    \n  }\n\n  stopFarming(npc: Node, cb?: () => void) {\n    npc.getChildByName(\"bubble\").active = false;\n  }\n\n  //?接收行为数据\n  async playNPCAction(actions: any) {\n    //!先移动到位置\n    const actionData: DataEvents = actions.data.data;\n    const npc = _.find(this.otherNPCarr, (item) => {\n      return (\n        item.getChildByName(\"NPCinstantiate\").getComponent(NPCControl).NpcID ===\n        actionData.npcId\n      );\n    });\n    let eventPox;\n    let finishTile;\n\n    const startTile = this._getTilePos(\n      new Vec2(npc.getPosition().x, npc.getPosition().y)\n    );\n    try {\n      if (actionData.actionId === NpcEventType.speak) {\n        const toNpc = _.find(this.otherNPCarr, (item) => {\n          return (\n            item.getChildByName(\"NPCinstantiate\").getComponent(NPCControl)\n              .NpcID === actionData.params.npcId\n          );\n        });\n        let toPos = this._getTilePos(\n          new Vec2(toNpc.getPosition().x, toNpc.getPosition().y)\n        );\n\n        let moveToPos;\n\n          if (\n            !this._layerFloor\n              ?.getComponent(TiledLayer)\n              ?.getTileGIDAt(toPos.x + 1, toPos.y + 1)\n          ) {\n            moveToPos = new Vec2(toPos.x + 1, toPos.y + 1);\n          }\n          if (\n            !this._layerFloor\n              ?.getComponent(TiledLayer)\n              ?.getTileGIDAt(toPos.x - 1, toPos.y - 1)\n          ) {\n            moveToPos = new Vec2(toPos.x - 1, toPos.y - 1);\n          }\n          if (\n            !this._layerFloor\n              ?.getComponent(TiledLayer)\n              ?.getTileGIDAt(toPos.x + 1, toPos.y - 1)\n          ) {\n            moveToPos = new Vec2(toPos.x + 1, toPos.y - 1);\n          }\n          if (\n            !this._layerFloor\n              ?.getComponent(TiledLayer)\n              ?.getTileGIDAt(toPos.x - 1, toPos.y + 1)\n          ) {\n            moveToPos = new Vec2(toPos.x - 1, toPos.y + 1);\n          }\n\n        eventPox = toNpc.getPosition();\n        finishTile = moveToPos;\n      } else {\n        eventPox = new Vec2(\n          this.tileObject.getObject(actionData.params.oid).x,\n          this.tileObject.getObject(actionData.params.oid).y\n        );\n        finishTile = this._getTilePos(\n          new Vec2(\n            this.tileObject.getObject(actionData.params.oid).x,\n            this.tileObject.getObject(actionData.params.oid).y\n          )\n        );\n      }\n    } catch (error) {}\n\n    let cb: any;\n\n    //!然后出发事件气泡\n    if (actionData.actionId === NpcEventType.sleep) {\n      cb = () => {\n        const nodes = this.getSleepNode(actionData.npcId);\n        this.setNpcDirect(npc, actionData, \"sleepHeadDirect\");\n        this.npcSleep(npc, nodes.head, nodes.bubble, async () => {\n          npc.getChildByName(\"bubble\").active = false;\n          npc.active = false;\n          const shouldSend = await this.checkPlayerId(actionData);\n          if (!shouldSend) {\n            return;\n          }\n          let json = new network.NpcActionDone();\n          json.command = 10008;\n          json.type = 1;\n          json.data.bid = actionData.bid;\n          json.data.npcId = actionData.npcId;\n          json.data.objId = actionData.params.oid;\n          json.data.x = eventPox.x;\n          json.data.y = hight - eventPox.y;\n          json.data.isFinish = 1;\n          json.data.state = 1;\n          json.data.params = {\n            oid: actionData.params.oid,\n          };\n          socket.sendWebSocketBinary(json);\n        });\n      };\n    } else if (actionData.actionId === NpcEventType.cook) {\n      cb = async () => {\n        this.setNpcDirect(npc, actionData, \"cookHeadDirect\");\n        await this.npcCook(npc, actionData);\n      };\n    } else if (actionData.actionId === NpcEventType.dinning) {\n      cb = async () => {\n        this.setNpcDirect(npc, actionData, \"diningHeadDirect\");\n        await this.npcDinning(npc, actionData);\n        const shouldSend = await this.checkPlayerId(actionData);\n        if (!shouldSend) {\n          return;\n        }\n        let json = new network.NpcActionDone();\n        json.command = 10008;\n        json.type = 1;\n        json.data.bid = actionData.bid;\n        json.data.npcId = actionData.npcId;\n        json.data.objId = actionData.params.oid;\n        json.data.x = eventPox.x;\n        json.data.y = hight - eventPox.y;\n        json.data.isFinish = 1;\n        json.data.state = 1;\n        json.data.params = {\n          oid: actionData.params.oid,\n          itemId: actionData.params.itemId,\n          count: 1,\n        };\n        socket.sendWebSocketBinary(json);\n      };\n    } else if (actionData.actionId === NpcEventType.farming) {\n      cb = async () => {\n        npc\n          .getChildByName(\"NPCinstantiate\")\n          .getComponent(NPCControl)\n          .setNPCMoveDirect(KeyCode.KEY_A);\n        await PromiseUtils.wait(bubbleTime * 2000);\n        await this.npcFarming(npc, actionData);\n        const shouldSend = await this.checkPlayerId(actionData);\n        if (!shouldSend) {\n          return;\n        }\n        let json = new network.NpcActionDone();\n        json.command = 10008;\n        json.type = 1;\n        json.data.bid = actionData.bid;\n        json.data.npcId = actionData.npcId;\n        json.data.objId = actionData.params.oid;\n        json.data.x = eventPox.x;\n        json.data.y = hight - eventPox.y;\n        json.data.isFinish = 1;\n        json.data.state = 1;\n        json.data.params = {\n          oid: actionData.params.oid,\n          itemId: actionData.params.itemId,\n          count: 9,\n        };\n        socket.sendWebSocketBinary(json);\n      };\n    } else if (actionData.actionId === NpcEventType.harvest) {\n      cb = async () => {\n        npc\n          .getChildByName(\"NPCinstantiate\")\n          .getComponent(NPCControl)\n          .setNPCMoveDirect(KeyCode.KEY_A);\n        await PromiseUtils.wait(bubbleTime * 2000);\n        await this.npcHarvest(npc, actionData);\n        const shouldSend = await this.checkPlayerId(actionData);\n        if (!shouldSend) {\n          return;\n        }\n        let json = new network.NpcActionDone();\n        json.command = 10008;\n        json.type = 1;\n        json.data.bid = actionData.bid;\n        json.data.npcId = actionData.npcId;\n        json.data.objId = actionData.params.oid;\n        json.data.x = eventPox.x;\n        json.data.y = hight - eventPox.y;\n        json.data.isFinish = 1;\n        json.data.state = 1;\n        json.data.params = {\n          oid: actionData.params.oid,\n        };\n        socket.sendWebSocketBinary(json);\n      };\n    } else if (actionData.actionId === NpcEventType.getup) {\n      cb = async () => {\n        const shouldSend = await this.checkPlayerId(actionData);\n        if (!shouldSend) {\n          return;\n        }\n        let json = new network.NpcActionDone();\n        json.command = 10008;\n        json.type = 1;\n        json.data.bid = actionData.bid;\n        json.data.npcId = actionData.npcId;\n        json.data.objId = actionData.params.oid;\n        json.data.x = eventPox.x;\n        json.data.y = hight - eventPox.y;\n        json.data.isFinish = 1;\n        json.data.state = 1;\n        json.data.params = {\n          oid: actionData.params.oid,\n        };\n        socket.sendWebSocketBinary(json);\n      };\n    } else if (actionData.actionId === NpcEventType.move) {\n      cb = async () => {\n        const shouldSend = await this.checkPlayerId(actionData);\n        if (!shouldSend) {\n          return;\n        }\n        let json = new network.NpcActionDone();\n        json.command = 10008;\n        json.type = 1;\n        json.data.npcId = actionData.npcId;\n        json.data.actionId = 112;\n        json.data.x = eventPox.x;\n        json.data.y = hight - eventPox.y;\n        json.data.isFinish = 1;\n        json.data.state = 1;\n        json.data.bid = actionData.bid;\n        socket.sendWebSocketBinary(json);\n      };\n    } else if (actionData.actionId === NpcEventType.move) {\n      cb = async () => {\n        const shouldSend = await this.checkPlayerId(actionData);\n        if (!shouldSend) {\n          return;\n        }\n        let json = new network.NpcActionDone();\n        json.command = 10008;\n        json.type = 1;\n        json.data.npcId = actionData.npcId;\n        json.data.actionId = 112;\n        json.data.x = eventPox.x;\n        json.data.y = hight - eventPox.y;\n        json.data.isFinish = 1;\n        json.data.state = 1;\n        json.data.bid = actionData.bid;\n        socket.sendWebSocketBinary(json);\n      };\n    } else if (actionData.actionId === NpcEventType.speak) {\n      cb = async () => {\n        this.speak(npc, actionData);\n        const shouldSend = await this.checkPlayerId(actionData);\n        if (!shouldSend) {\n          return;\n        }\n        let json = new network.NpcActionDone();\n\n        json.command = 10008;\n        json.type = 1;\n        json.data.bid = actionData.bid;\n        json.data.npcId = actionData.npcId;\n        json.data.objId = actionData.params.oid;\n        json.data.x = eventPox.x;\n        json.data.y = hight - eventPox.y;\n        json.data.isFinish = 1;\n        json.data.state = 1;\n        socket.sendWebSocketBinary(json);\n      };\n    } else if (actionData.actionId === NpcEventType.buy) {\n      cb = async () => {\n        await this.buy(npc, actionData);\n        const shouldSend = await this.checkPlayerId(actionData);\n        if (!shouldSend) {\n          return;\n        }\n        let json = new network.NpcActionDone();\n        json.command = 10008;\n        json.type = 1;\n        json.data.bid = actionData.bid;\n        json.data.npcId = actionData.npcId;\n        json.data.objId = actionData.params.oid;\n        json.data.x = eventPox.x;\n        json.data.y = hight - eventPox.y;\n        json.data.isFinish = 1;\n        json.data.state = 1;\n        socket.sendWebSocketBinary(json);\n      };\n    } else if (actionData.actionId === NpcEventType.sale) {\n      cb = async () => {\n        await this.sale(npc, actionData);\n        const shouldSend = await this.checkPlayerId(actionData);\n        if (!shouldSend) {\n          return;\n        }\n        let json = new network.NpcActionDone();\n        json.command = 10008;\n        json.type = 1;\n        json.data.bid = actionData.bid;\n        json.data.npcId = actionData.npcId;\n        json.data.objId = actionData.params.oid;\n        json.data.x = eventPox.x;\n        json.data.y = hight - eventPox.y;\n        json.data.isFinish = 1;\n        json.data.state = 1;\n        socket.sendWebSocketBinary(json);\n      };\n    } else if (actionData.actionId === NpcEventType.slaughter) {\n      cb = async () => {\n        await this.butcherSkill(npc, actionData);\n        const shouldSend = await this.checkPlayerId(actionData);\n        if (!shouldSend) {\n          return;\n        }\n        let json = new network.NpcActionDone();\n        json.command = 10008;\n        json.type = 1;\n        json.data.bid = actionData.bid;\n        json.data.npcId = actionData.npcId;\n        json.data.objId = actionData.params.oid;\n        json.data.x = eventPox.x;\n        json.data.y = hight - eventPox.y;\n        json.data.isFinish = 1;\n        json.data.state = 1;\n        socket.sendWebSocketBinary(json);\n      };\n    } else if (actionData.actionId === NpcEventType.make) {\n      cb = async () => {\n        await this.breadMake(npc, actionData);\n        const shouldSend = await this.checkPlayerId(actionData);\n        if (!shouldSend) {\n          return;\n        }\n        let json = new network.NpcActionDone();\n        json.command = 10008;\n        json.type = 1;\n        json.data.bid = actionData.bid;\n        json.data.npcId = actionData.npcId;\n        json.data.objId = actionData.params.oid;\n        json.data.x = eventPox.x;\n        json.data.y = hight - eventPox.y;\n        json.data.isFinish = 1;\n        json.data.state = 1;\n        socket.sendWebSocketBinary(json);\n      };\n    } else if (actionData.actionId === NpcEventType.feeding) {\n      cb = async () => {\n        await this.butcherFeeding(npc, actionData);\n        const shouldSend = await this.checkPlayerId(actionData);\n        if (!shouldSend) {\n          return;\n        }\n        let json = new network.NpcActionDone();\n        json.command = 10008;\n        json.type = 1;\n        json.data.bid = actionData.bid;\n        json.data.npcId = actionData.npcId;\n        json.data.objId = actionData.params.oid;\n        json.data.x = eventPox.x;\n        json.data.y = hight - eventPox.y;\n        json.data.isFinish = 1;\n        json.data.state = 1;\n        socket.sendWebSocketBinary(json);\n      };\n    }\n\n    // if(startTile.x === finishTile.x && startTile.y === finishTile.y){\n    //     return\n    // }\n\n    this.stopActionNormal(npc, actionData);\n    npc\n      .getChildByName(\"NPCinstantiate\")\n      .getComponent(NPCControl)\n      .aStartMove(\n        new Vec2(startTile.x, startTile.y),\n        new Vec2(finishTile.x, finishTile.y),\n        cb\n      );\n  }\n\n  async setFieldReady(actionData: any) {\n    const farmItem = _.find(ProductsItemUrl.ItemCfg, (item) => {\n      return item.id === actionData.params.itemId;\n    });\n\n    const item = instantiate(this[farmItem.fieldName]) as Node;\n    item.setParent(this[actionData.params.oid]);\n    this[`info_${actionData.params.oid}`].fieldNode = item;\n    item.setPosition(new Vec3(0, 0, 0));\n    const fieldArr: Node[] = [...item.children];\n    if (!fieldArr) {\n      return;\n    }\n    let fieldIndexX = 1;\n    let adaptX;\n    let adaptY;\n    for (const field of fieldArr) {\n      field.active = true;\n      await PromiseUtils.wait(bubbleTime * 2000);\n      field.getChildByName(\"farm_wheat_l\").active = true;\n    }\n  }\n\n  setNpcDirect(npc: Node, actionData: DataEvents, directType: string) {\n    const direct = EventNpcInfoMap[actionData.npcId][directType];\n    npc\n      .getChildByName(\"NPCinstantiate\")\n      .getComponent(NPCControl)\n      .setNPCMoveDirect(direct);\n  }\n\n  //?完成行为\n  finishNPCAction(farmAction: DataFarmEvent) {}\n\n  initPlayerNPC(myNPC: NPCServerD) {\n    this._curPlayerTile = this._getTilePos(new Vec2(9, 11));\n    //this.player.parent.getComponent(NPCControl).NpcID = myNPC.id;\n    this.player.parent.getComponent(NPCControl)._curTile = new Vec2(9, 11);\n    const pos = this._layerFloor.getPositionAt(this._curPlayerTile)!;\n    this.player.parent.parent.setPosition(300, 1000);\n    if (this.player.parent.getComponent(NPCControl).camera) {\n      const gameView = view.getVisibleSize();\n      let mainCamera = this.player.parent.getComponent(NPCControl).camera.node;\n      mainCamera.setPosition(pos.x, pos.y);\n\n      // if (pos.x < gameView.x) {\n      //   mainCamera.setPosition(gameView.x, mainCamera.getPosition().y);\n      // } else if (pos.x > hight - gameView.x) {\n      //   mainCamera.setPosition(hight - gameView.x, mainCamera.getPosition().y);\n      // } else {\n      //   mainCamera.setPosition(pos.x, mainCamera.getPosition().y);\n      // }\n      // if (pos.y < gameView.y) {\n      //   mainCamera.setPosition(mainCamera.getPosition().x, gameView.y);\n      // } else if (pos.y > hight - gameView.y) {\n      //   mainCamera.setPosition(mainCamera.getPosition().x, hight - gameView.y);\n      // } else {\n      //   mainCamera.setPosition(mainCamera.getPosition().x, pos.y);\n      // }\n    }\n    //this.player.parent.getComponent(NPCControl).camera.node.setPosition(myNPC.x, myNPC.y)\n    // 使用函数获取标签为 'hair'，id 为 100 的对象信息\n    //const hairPartInfo = getPartInfo('hair', myNPC.hair);\n    // WebUtils.getResouceImg(\n    //   this.getPartInfo(\"hair\", myNPC.hair).frame_path,\n    //   this.player.getChildByName(\"hair\")\n    // );\n    // WebUtils.getResouceImg(\n    //   this.getPartInfo(\"shirt\", myNPC.top).frame_path,\n    //   this.player.getChildByName(\"shirt\")\n    // );\n    // WebUtils.getResouceImg(\n    //   this.getPartInfo(\"pants\", myNPC.bottoms).frame_path,\n    //   this.player.getChildByName(\"pants\")\n    // );\n    this.loading.active = false;\n  }\n\n  initOtherNPCs(myNPC: NPCServerD[]) {\n    myNPC.forEach((NPC: NPCServerD) => {\n      this.initOtherNPC(NPC);\n    });\n  }\n\n  initOtherNPC(NPC: NPCServerD) {\n    let item = instantiate(this.playerInstantiate) as Node;\n    item.active = true;\n    this.playerLayer.addChild(item);\n    //this.tiledLayer.addUserNode(item)\n    item.getChildByName(\"NPCinstantiate\").getComponent(NPCControl).NpcID =\n      NPC.id;\n    this.otherNPCarr.push(item);\n    let npcTile = new Vec2();\n    const isValueIncluded = _.includes([10002, 10003, 10004, 10005], NPC.id);\n    if (isValueIncluded) {\n      npcTile = this._getTilePos(\n        new Vec2(NPC.x * PosAdapt, hight - NPC.y * PosAdapt)\n      );\n    }\n    const pos = this._layerFloor.getPositionAt(npcTile)!;\n    this._npcTileArray.push(npcTile);\n    item.getChildByName(\"NPCinstantiate\").getComponent(NPCControl)._curTile =\n      npcTile;\n    item.setPosition(pos.x, pos.y);\n    if (NPC.id === 10002) {\n      GlobalConfig.instance.curViewNpcX = pos.x;\n      GlobalConfig.instance.curViewNpcY = pos.y;\n    }\n    item.getChildByName(\"NPCinstantiate\").getComponent(NPCControl).npcIndex =\n      NpcIndex[NPC.id];\n    this.scheduleOnce(() => {\n      WebUtils.getResouceImg(\n        this.getPartInfo(\"body\", NPC.model)?.frame_path,\n        item\n          .getChildByName(\"NPCinstantiate\")\n          .getChildByName(\"npc_root\")\n          .getChildByName(\"body\")\n      );\n      WebUtils.getResouceImg(\n        \"\",\n        item\n          .getChildByName(\"NPCinstantiate\")\n          .getChildByName(\"npc_root\")\n          .getChildByName(\"hair\")\n      );\n      WebUtils.getResouceImg(\n        \"\",\n        item\n          .getChildByName(\"NPCinstantiate\")\n          .getChildByName(\"npc_root\")\n          .getChildByName(\"shirt\")\n      );\n      WebUtils.getResouceImg(\n        \"\",\n        item\n          .getChildByName(\"NPCinstantiate\")\n          .getChildByName(\"npc_root\")\n          .getChildByName(\"pants\")\n      );\n      if (NPC.model <= 10001) {\n        this.getPartInfo(\"hair\", NPC.hair)?.frame_path &&\n          WebUtils.getResouceImg(\n            this.getPartInfo(\"hair\", NPC.hair)?.frame_path,\n            item\n              .getChildByName(\"NPCinstantiate\")\n              .getChildByName(\"npc_root\")\n              .getChildByName(\"hair\")\n          );\n        this.getPartInfo(\"shirt\", NPC.top)?.frame_path &&\n          WebUtils.getResouceImg(\n            this.getPartInfo(\"shirt\", NPC.top)?.frame_path,\n            item\n              .getChildByName(\"NPCinstantiate\")\n              .getChildByName(\"npc_root\")\n              .getChildByName(\"shirt\")\n          );\n        this.getPartInfo(\"pants\", NPC.bottoms)?.frame_path &&\n          WebUtils.getResouceImg(\n            this.getPartInfo(\"pants\", NPC.bottoms)?.frame_path,\n            item\n              .getChildByName(\"NPCinstantiate\")\n              .getChildByName(\"npc_root\")\n              .getChildByName(\"pants\")\n          );\n      }\n    }, 0);\n  }\n\n  initOtherNPCByData(data: any) {\n    this.initOtherNPC(data.data.myNpc);\n  }\n\n  removeNPC(data: any) {\n    const offLineNPC = _.find(\n      this.otherNPCarr,\n      (item) => item?.getComponent(NPCControl)?.NpcID === data?.data?.npcIds[0]\n    );\n    offLineNPC?.removeFromParent();\n    this.otherNPCarr = _.remove(\n      this.otherNPCarr,\n      (item) => item?.getComponent(NPCControl)?.NpcID !== data?.data?.npcIds[0]\n    );\n  }\n\n  updateOtherPlayerInfo(data: any) {\n    if (this.player.parent.getComponent(NPCControl).NpcID === data.data.npcId) {\n      return;\n    }\n    const moveNPC = _.find(\n      this.otherNPCarr,\n      (item) =>\n        item.getChildByName(\"NPCinstantiate\").getComponent(NPCControl).NpcID ===\n        data.data.npcId\n    );\n    let steepKey: KeyCode;\n    if (data.data.x > moveNPC.getPosition().x) {\n      steepKey = KeyCode.KEY_D;\n    }\n    if (data.data.x < moveNPC.getPosition().x) {\n      steepKey = KeyCode.KEY_A;\n    }\n    if (data.data.y < moveNPC.getPosition().y) {\n      steepKey = KeyCode.KEY_S;\n    }\n    if (data.data.y > moveNPC.getPosition().y) {\n      steepKey = KeyCode.KEY_W;\n    }\n    moveNPC\n      .getChildByName(\"NPCinstantiate\")\n      .getComponent(NPCControl)\n      .setNPCMoveDirect(steepKey);\n\n    moveNPC\n      .getChildByName(\"NPCinstantiate\")\n      .getComponent(NPCControl)\n      .setMoveSprite(steepKey);\n    moveNPC\n      .getChildByName(\"NPCinstantiate\")\n      .getComponent(NPCControl)\n      .setNPCPosition(steepKey);\n    tween(moveNPC)\n      .to(\n        0.05,\n        { position: new Vec3(data.data.x, data.data.y, 0) },\n        {\n          onComplete: () => {\n            //this.ClientPlayerMoveCallBack(tilePos, pid);\n            // let json = new network.NpcActionDone();\n            // json.command = 10008;\n            // json.type = 1;\n            // json.data.actionId = 112\n            // json.data.npcId = data.data.npcId\n            // json.data.x = moveNPC.getPosition().x\n            // json.data.y = hight - moveNPC.getPosition().y\n            // json.data.isFinish = 1\n            // json.data.state = 1\n            // socket.sendWebSocketBinary(json);\n          },\n        }\n      )\n      .start();\n  }\n\n  _getTilePos(posInPixel: { x: number; y: number }) {\n    const mapSize = this.node.getComponent(UITransform).contentSize;\n    const tileSize = this.getComponent(TiledMap).getTileSize();\n    const x = Math.floor(posInPixel.x / tileSize.width);\n    const y = Math.floor((mapSize.height - posInPixel.y) / tileSize.height);\n    return new Vec2(x, y - 1);\n  }\n\n  protected onDestroy(): void {\n    observer.off(EventType.SOCKET_GETALL_NPCS, this.setNPCPos, this);\n    // observer.off(EventType.SOCKET_ONLINE_NPCS, this.initOtherNPC, this)\n    // observer.off(EventType.SOCKET_OFFLINE_NPCS, this.removeNPC, this)\n  }\n\n  async testFarmRound() {\n    // await PromiseUtils.wait(bubbleTime * 1000);\n    // window.farmcook()\n    // await PromiseUtils.wait(bubbleTime * 20000);\n    // window.farmeat()\n    // await PromiseUtils.wait(bubbleTime * 10000);\n    // window.farm()\n    // await PromiseUtils.wait(bubbleTime * 80000);\n    // window.farmGoSleep()\n    // await PromiseUtils.wait(bubbleTime * 80000);\n    // window.fieldReady()\n    // await PromiseUtils.wait(bubbleTime * 10000);\n    // window.farmHarvest()\n    // await PromiseUtils.wait(bubbleTime * 80000);\n    // this.testFrameIndex = 0\n  }\n\n  async testBakerRound() {\n    // await PromiseUtils.wait(bubbleTime * 1000);\n    // window.bakerCook()\n    // await PromiseUtils.wait(bubbleTime * 60000);\n    // window.bakerDinning()\n    // await PromiseUtils.wait(bubbleTime * 10000);\n    // window.bakerSleep()\n    // await PromiseUtils.wait(bubbleTime * 40000);\n    // this.testbakerIndex = 0\n  }\n\n  async updateObjectStateChange(data) {\n    data?.data &&\n      data.data.forEach(async (object) => {\n        if (\n          object.objId === \"farmland1\" ||\n          object.objId === \"farmland2\" ||\n          object.objId === \"farmland3\" ||\n          object.objId === \"farmland4\"\n        ) {\n          if (object.state === \"2\") {\n            await this.setFieldReady({\n              params: {\n                oid: object.objId,\n                itemId: object.params.itemId,\n              },\n            });\n          }\n        }\n      });\n  }\n\n  async objectStateChange(data) {\n    if (\n      data.data.oid === \"farmland1\" ||\n      data.data.oid === \"farmland3\" ||\n      data.data.oid === \"farmland4\"\n    ) {\n      if (data.data.state === \"2\") {\n        await this.setFieldReady({\n          params: {\n            oid: data.oid,\n            itemId: data.params.itemId,\n          },\n        });\n      }\n    }\n  }\n\n  async update(deltaTime: number) {\n    this.sleepFrameAdd = this.sleepFrameAdd + deltaTime;\n    if (this.sleepFrameAdd > sleepFrameTime) {\n      this.setNpcHomeBed(this.homeBedFrameIndex);\n      this.homeBedFrameIndex = ++this.homeBedFrameIndex > 1 ? 0 : 1;\n      this.sleepFrameAdd = 0;\n    }\n\n    if (this.testbakerIndex === 0) {\n      this.testbakerIndex = this.testbakerIndex + deltaTime;\n      this.testBakerRound();\n    }\n    if (this.testFrameIndex === 0) {\n      this.testFrameIndex = this.testFrameIndex + deltaTime;\n      await this.testFarmRound();\n    }\n  }\n}\n"]}