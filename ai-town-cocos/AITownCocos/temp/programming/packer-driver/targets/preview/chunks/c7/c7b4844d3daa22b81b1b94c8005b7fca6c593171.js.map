{"version":3,"sources":["file:///Users/feiwang/workSpace/AITown/cutepet/assets/src/module/main/shop/CatEnjoyToolsComponent.ts"],"names":["_decorator","Component","Label","Node","ListViewCtrl2","modelMgr","observer","EventType","LoadingController","Log","ccclass","property","TAG","CatEnjoyToolsComponent","Number","_data","start","ins","hideLoading","on","SOCKET_SHOP_ITEM_LIST","updateEnjoyToolsHandler","UPDATE_SHOP_INDEX","setDataStoreId","mainModel","getShopList","onDestroy","off","index","current_storeId","data","current_storeId_arr","forEach","element","storeId","push","log","showZhongziList","onEnable","arr","length","nullTxt","node","active","len","Math","ceil","grpArr","i","temparr","j","pre_listView","ctrl","getChildByName","spawnCount","getComponent","initData","update","deltaTime"],"mappings":"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","sourcesContent":["import { _decorator, Component, Label, Node } from 'cc';\nimport { ListViewCtrl2 } from '../../../game/components/listViewCtrl2';\nimport { GlobalConfig } from '../../../game/config/GlobalConfig';\nimport { modelMgr, observer } from '../../../game/App';\nimport { EventType } from '../../../EventType';\nimport { LoadingController } from '../../../game/components/LoadingController';\nimport { CatEnjoyToolsData } from './CatEnjoyToolsDataType';\nimport Log from '../../../../../assets/src/utils/LogUtils'\nconst { ccclass, property } = _decorator;\n\nconst TAG = 'CatEnjoyToolsComponent'\n\n@ccclass('CatEnjoyToolsComponent')\nexport class CatEnjoyToolsComponent extends Component {\n    @property(Node)\n    pre_listView: Node = null;\n\n    @property(Number)\n    current_storeId: Number = 1\n\n    @property(Label)\n    nullTxt: Label = null\n\n    _data: any\n\n    start() {\n        LoadingController.ins.hideLoading();\n        // modelMgr.mainModel.checkcatReq();\n        observer.on(EventType.SOCKET_SHOP_ITEM_LIST, this.updateEnjoyToolsHandler, this);\n        observer.on(EventType.UPDATE_SHOP_INDEX, this.setDataStoreId, this);\n        // observer.on(EventType.SOCKET_SHOP_ITEM_LIST, (data)=>{\n        //     console.log(TAG, data)\n        // }, this);\n        modelMgr.mainModel.getShopList()\n        //this.updateEnjoyToolsHandler();\n\n    }\n\n    protected onDestroy(): void {\n        observer.off(EventType.SOCKET_SHOP_ITEM_LIST, this.updateEnjoyToolsHandler, this);\n        observer.off(EventType.UPDATE_SHOP_INDEX, this.setDataStoreId, this);\n    }\n\n    setDataStoreId(index: any){\n        this.current_storeId = index.data\n        this.updateEnjoyToolsHandler(this._data)\n    }\n\n    private updateEnjoyToolsHandler(data){\n        this._data = data\n        let current_storeId_arr = [];\n        (this._data.data.data as CatEnjoyToolsData[]).forEach(element => {\n            if(element.storeId === this.current_storeId){\n                current_storeId_arr.push(element)\n            }\n        });\n        Log.log(TAG, this._data)\n        this.showZhongziList(current_storeId_arr);\n    }\n    protected onEnable(): void {\n        //排序逻辑\n        // let arr: any[] = modelMgr.configModel.commonConfigJson.Cat;\n        // this.showZhongziList(arr);\n    }\n    /**\n* \n*/\n    public showZhongziList(arr) {\n        if(!arr.length){\n            this.nullTxt.node.active = true\n        }else{\n            this.nullTxt.node.active = false\n        }\n        let len = Math.ceil(arr.length / 3);\n        let grpArr = [];\n        for (let i = 0; i < len; i++) {\n            let temparr = [];\n            for (let j = 0; j < 3; j++) {\n                arr[(i) * 3 + j] && temparr.push(arr[(i) * 3 + j]);\n            }\n            grpArr.push(temparr);\n        }\n        if (this.pre_listView) {\n            let ctrl = this.pre_listView.getChildByName(\"listctrl\");\n            let spawnCount = grpArr.length;\n            ctrl.getComponent(ListViewCtrl2).initData(spawnCount, grpArr);\n        }\n    }\n\n    update(deltaTime: number) {\n\n    }\n}\n\n\n"]}