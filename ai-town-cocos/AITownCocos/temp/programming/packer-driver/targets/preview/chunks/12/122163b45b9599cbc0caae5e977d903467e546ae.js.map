{"version":3,"sources":["file:///Users/feiwang/cutepet/node_modules/aws-sdk/vendor/endpoint-cache/index.js"],"names":["_cjsLoader","_req","__cjsMetaURL","url","define","exports","require","module","__filename","__dirname","Object","defineProperty","value","LRU_1","CACHE_SIZE","EndpointCache","maxSize","cache","LRUCache","prototype","get","length","enumerable","configurable","put","key","keyString","getKeyString","endpointRecord","populateValue","now","Date","records","i","record","Expire","splice","remove","undefined","identifiers","identifierNames","keys","sort","identifierName","push","join","endpoints","map","endpoint","Address","CachePeriodInMinutes","empty","_cjsExports","___esModule","__esModule","_EndpointCache"],"mappings":"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","sourcesContent":["import _cjsLoader from 'cce:/internal/ml/cjs-loader.mjs';\nimport { __cjsMetaURL as _req} from './utils/LRU';\nlet _cjsExports;\nlet ___esModule;\nlet _EndpointCache;\nconst __cjsMetaURL = import.meta.url;\n_cjsLoader.define(__cjsMetaURL, function (exports, require, module, __filename, __dirname) {\n// #region ORIGINAL CODE\n\n\n \"use strict\";\n Object.defineProperty(exports, \"__esModule\", { value: true });\n var LRU_1 = require(\"./utils/LRU\");\n var CACHE_SIZE = 1000;\n /**\n  * Inspired node-lru-cache[https://github.com/isaacs/node-lru-cache]\n  */\n var EndpointCache = /** @class */ (function () {\n     function EndpointCache(maxSize) {\n         if (maxSize === void 0) { maxSize = CACHE_SIZE; }\n         this.maxSize = maxSize;\n         this.cache = new LRU_1.LRUCache(maxSize);\n     }\n     ;\n     Object.defineProperty(EndpointCache.prototype, \"size\", {\n         get: function () {\n             return this.cache.length;\n         },\n         enumerable: true,\n         configurable: true\n     });\n     EndpointCache.prototype.put = function (key, value) {\n       var keyString = typeof key !== 'string' ? EndpointCache.getKeyString(key) : key;\n         var endpointRecord = this.populateValue(value);\n         this.cache.put(keyString, endpointRecord);\n     };\n     EndpointCache.prototype.get = function (key) {\n       var keyString = typeof key !== 'string' ? EndpointCache.getKeyString(key) : key;\n         var now = Date.now();\n         var records = this.cache.get(keyString);\n         if (records) {\n             for (var i = records.length-1; i >= 0; i--) {\n                 var record = records[i];\n                 if (record.Expire < now) {\n                     records.splice(i, 1);\n                 }\n             }\n             if (records.length === 0) {\n                 this.cache.remove(keyString);\n                 return undefined;\n             }\n         }\n         return records;\n     };\n     EndpointCache.getKeyString = function (key) {\n         var identifiers = [];\n         var identifierNames = Object.keys(key).sort();\n         for (var i = 0; i < identifierNames.length; i++) {\n             var identifierName = identifierNames[i];\n             if (key[identifierName] === undefined)\n                 continue;\n             identifiers.push(key[identifierName]);\n         }\n         return identifiers.join(' ');\n     };\n     EndpointCache.prototype.populateValue = function (endpoints) {\n         var now = Date.now();\n         return endpoints.map(function (endpoint) { return ({\n             Address: endpoint.Address || '',\n             Expire: now + (endpoint.CachePeriodInMinutes || 1) * 60 * 1000\n         }); });\n     };\n     EndpointCache.prototype.empty = function () {\n         this.cache.empty();\n     };\n     EndpointCache.prototype.remove = function (key) {\n       var keyString = typeof key !== 'string' ? EndpointCache.getKeyString(key) : key;\n         this.cache.remove(keyString);\n     };\n     return EndpointCache;\n }());\n exports.EndpointCache = EndpointCache;\n\n// #endregion ORIGINAL CODE\n\n_cjsExports = module.exports;\n___esModule = module.exports.__esModule;\n_EndpointCache = module.exports.EndpointCache;\n\n}, () => ({\n  './utils/LRU': _req,\n}));\nexport { _cjsExports as default };\nexport { __cjsMetaURL }\n"]}