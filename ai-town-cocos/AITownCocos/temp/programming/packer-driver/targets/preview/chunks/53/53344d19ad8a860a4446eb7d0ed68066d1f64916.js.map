{"version":3,"sources":["file:///Users/feiwang/cutepet/assets/src/module/main/jishi/JishiGoumaiZZTK.ts"],"names":["_decorator","Component","Node","Label","showMsg2","modelMgr","uiMgr","LoadingController","SpinBoxComponent","DataEvents","ComponentsUtils","WebUtils","ccclass","property","JishiGoumaiZZTK","danjia","_totalnum","start","ins","hideLoading","jishiModel","on","UPDATE_JISHI_SHOP","updateData","sinbox","updateMoneyHandler","oprType","btnGoumai","active","btnchushou","DATA","buyPrice","getComponent","max","quota","salePrice","amount","chiyou","string","Label_name","rarity","Label_jieshao","profile","zongjia","initXiangou","getRemoteImg","icon","itempic","restrict","spr_xiangou","quanta","setGray","onDestroy","off","num","Number","isNaN","da","data","update","deltaTime","choushou","seedId","closeself","goumai","shopId","removeParent"],"mappings":"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","sourcesContent":["import { _decorator, Component, Node, Label } from 'cc';\nimport { showMsg2 } from '../../../core/message/MessageManager';\nimport { modelMgr, observer, uiMgr } from '../../../game/App';\nimport { LoadingController } from '../../../game/components/LoadingController';\nimport { SpinBoxComponent } from '../../../game/components/SpinBoxComponent';\nimport AxiosManager from '../../../manager/AxiosManager';\nimport { DataEvents } from '../../../model/DataEvents';\nimport ComponentsUtils from '../../../utils/ComponentsUtils';\nimport WebUtils from '../../../utils/WebUtils';\nconst { ccclass, property } = _decorator;\n\n/**\n * 购买/出售种子弹框\n */\n@ccclass('JishiGoumaiZZTK')\nexport class JishiGoumaiZZTK extends Component {\n    @property(Node)\n    public sinbox: Node = null;\n    @property(Label)\n    public zongjia: Label = null;\n    @property(Node)\n    public btnGoumai: Node = null;\n    @property(Node)\n    public btnchushou: Node = null;\n    @property(Node)\n    public itempic: Node = null;\n    @property(Label)\n    public Label_name: Label = null;\n    @property(Label)\n    public Label_jieshao: Label = null;\n    @property(Node)\n    public spr_xiangou: Node = null\n    @property(Label)\n    public chiyou: Label = null;\n\n    public static oprType: string = \"\";\n    static DATA: any;\n    public danjia: number = 0;\n    start() {\n        LoadingController.ins.hideLoading();\n        modelMgr.jishiModel.on(DataEvents.UPDATE_JISHI_SHOP, this.updateData, this);\n        this.sinbox.on(\"update_money\", this.updateMoneyHandler, this);\n        if (JishiGoumaiZZTK.oprType == \"goumai\") {\n            this.btnGoumai.active = true;\n            this.btnchushou.active = false;\n            this.danjia = JishiGoumaiZZTK.DATA.buyPrice;\n            this.sinbox.getComponent(SpinBoxComponent).max = JishiGoumaiZZTK.DATA.quota;\n\n        } else {\n            this.btnGoumai.active = false;\n            this.btnchushou.active = true;\n            this.danjia = JishiGoumaiZZTK.DATA.salePrice;\n            this.sinbox.getComponent(SpinBoxComponent).max = JishiGoumaiZZTK.DATA.amount;\n        }\n        this.chiyou.string = \"\" + JishiGoumaiZZTK.DATA.amount + \"\";\n        this.Label_name.string = JishiGoumaiZZTK.DATA.rarity + \"种子\";\n        this.Label_jieshao.string = JishiGoumaiZZTK.DATA.profile + \"\";\n        this.zongjia.string = this.danjia + \"\";\n\n\n        this.initXiangou();\n        WebUtils.getRemoteImg(JishiGoumaiZZTK.DATA.icon + \"?imageView&thumbnail=162x191\", this.itempic);\n\n    }\n\n    public initXiangou() {\n        switch (JishiGoumaiZZTK.DATA.restrict) {\n            case 0:\n                this.spr_xiangou.active = false;\n                break;\n            case 1:\n                this.spr_xiangou.active = true;\n                break;\n            case 2:\n                this.spr_xiangou.active = true;\n                break;\n            case 3:\n                this.spr_xiangou.active = true;\n                break;\n            case 4:\n                this.spr_xiangou.active = false;\n                break;\n            default:\n                this.spr_xiangou.active = false;\n                break;\n        }\n        if (this.spr_xiangou.active) {\n            this.spr_xiangou.getComponent(Label).string = \"本日剩余次数: (\" + JishiGoumaiZZTK.DATA.quanta + \"/\" + JishiGoumaiZZTK.DATA.quota + \")\";\n\n        } else {\n            this.spr_xiangou.getComponent(Label).string = \"\";\n\n        }\n        if (this.spr_xiangou.active && JishiGoumaiZZTK.DATA.quanta >= JishiGoumaiZZTK.DATA.quota) {\n            ComponentsUtils.setGray(this.btnGoumai, true);\n        }\n    }\n    onDestroy() {\n        modelMgr.jishiModel.off(DataEvents.UPDATE_JISHI_SHOP, this.updateData, this);\n\n    }\n    private _totalnum: number = 1;\n    /**\n     * \n     * @param evt \n     * @param num \n     */\n    public updateMoneyHandler(num: any) {\n        if (!Number.isNaN(Number(num))) {\n            this._totalnum = num;\n            this.zongjia.string = Number(num) * this.danjia + \"\";\n        }\n    }\n    public updateData(da) {\n        JishiGoumaiZZTK.DATA = da.data;\n        this.initXiangou();\n        this.chiyou.string = \"\" + JishiGoumaiZZTK.DATA.amount + \"\";\n\n    }\n    update(deltaTime: number) {\n\n    }\n\n    //按钮绑定\n    /**\n     * \n     */\n    public choushou() {\n        let data = {\n            \"seedId\": JishiGoumaiZZTK.DATA.seedId,\n            \"amount\": this._totalnum,\n        }\n        showMsg2(\"出售成功\");\n        this.closeself();\n    }\n\n    public goumai() {\n        if (Number(this.zongjia.string) > 10) {\n            showMsg2(\"余额不足\");\n            return;\n        }\n        let data = {\n            \"id\": JishiGoumaiZZTK.DATA.shopId,\n            \"amount\": this._totalnum,\n        }\n        showMsg2(\"购买成功\");\n\n    }\n    /**\n* 关闭自己\n*/\n    public closeself() {\n        uiMgr.removeParent(\"prefabs/jishi/pre_jishiGmZZ\");\n    }\n\n}\n\n"]}