{"version":3,"sources":["file:///Users/feiwang/cutepet/assets/src/module/main/jishi/GoumaiZZController.ts"],"names":["_decorator","Component","Node","modelMgr","observer","ListViewCtrl2","DataEvents","Log","ccclass","property","GoumaiZZController","String","showarr","_lasttime","_temparr","_currentTog","_curevt","start","onEnable","on","sortselectHandler","oprType","data","type","jishiModel","currentchushouTab","FRESH_SEEDS_SELL_NULL","nullfresh","onDisable","off","removeallItem","arr","storelist","seeds","update","deltaTime","s","evt","log","undefined","seedId","name","restrict","quanta","quota","dimension","subType","icon","salePrice","sell","amount","buyPrice","showZhongziList","hasSelectData","len","Math","ceil","length","grpArr","i","temparr","j","push","pre_listView","ctrl","getChildByName","spawnCount","getComponent","initData","reset","showChushouZhongziList"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,I,OAAAA,I;;AAEvBC,MAAAA,Q,iBAAAA,Q;AAAUC,MAAAA,Q,iBAAAA,Q;;AACVC,MAAAA,a,iBAAAA,a;;AAGAC,MAAAA,U,iBAAAA,U;;AAGFC,MAAAA,G;;;;;;;;;OACD;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBT,U;AAC9B;AACA;AACA;;oCAEaU,kB,WADZF,OAAO,CAAC,oBAAD,C,UAIHC,QAAQ,CAACP,IAAD,C,UAERO,QAAQ,CAACE,MAAD,C,2BANb,MACaD,kBADb,SACwCT,SADxC,CACkD;AAAA;AAAA;;AAAA;;AAAA;;AAAA,eAU9CW,OAV8C;AAAA,eAmDvCC,SAnDuC,GAmDnB,CAnDmB;AAAA,eA6DtCC,QA7DsC;AAAA,eA8DtCC,WA9DsC,GA8DhB,EA9DgB;AAAA,eA+DtCC,OA/DsC;AAAA;;AAW9CC,QAAAA,KAAK,GAAG,CACJ;AAEH;;AACDC,QAAAA,QAAQ,GAAG;AACP;AAAA;AAAA,oCAASC,EAAT,CAAY,QAAZ,EAAsB,KAAKC,iBAA3B,EAA8C,IAA9C;;AAEA,cAAI,KAAKC,OAAL,IAAgB,QAApB,EAA8B;AAC1B,gBAAI,CAAC,KAAKN,WAAV,EAAuB;AACnB,mBAAKA,WAAL,GAAmB,kBAAnB;AACH;;AACD,iBAAKK,iBAAL,CAAuB;AAAEE,cAAAA,IAAI,EAAE;AAAEC,gBAAAA,IAAI,EAAE,KAAKR;AAAb;AAAR,aAAvB;AACH,WALD,MAKO,IAAI,KAAKM,OAAL,IAAgB,SAApB,EAA+B;AAClC,gBAAI,CAAC,KAAKN,WAAV,EAAuB;AACnB,mBAAKA,WAAL,GAAmB,mBAAnB;AACH,aAHiC,CAIlC;;;AACA,iBAAKK,iBAAL,CAAuB;AAAEE,cAAAA,IAAI,EAAE;AAAEC,gBAAAA,IAAI,EAAE,KAAKR;AAAb;AAAR,aAAvB;AAEH;;AAID;AAAA;AAAA,oCAASS,UAAT,CAAoBC,iBAApB,GAAwC,OAAxC;AACA;AAAA;AAAA,oCAASD,UAAT,CAAoBL,EAApB,CAAuB;AAAA;AAAA,wCAAWO,qBAAlC,EAAyD,KAAKC,SAA9D,EAAyE,IAAzE;AACH;;AACDC,QAAAA,SAAS,GAAG;AACR;AAAA;AAAA,oCAASC,GAAT,CAAa,QAAb,EAAuB,KAAKT,iBAA5B,EAA+C,IAA/C;AACA;AAAA;AAAA,oCAASI,UAAT,CAAoBK,GAApB,CAAwB;AAAA;AAAA,wCAAWH,qBAAnC,EAA0D,KAAKC,SAA/D,EAA0E,IAA1E;AACA,eAAKG,aAAL;AAEH;;AAEDH,QAAAA,SAAS,GAAG;AACR,cAAII,GAAJ;;AACA,cAAI,KAAKV,OAAL,IAAgB,SAApB,EAA+B;AAC3BU,YAAAA,GAAG,GAAG;AAAA;AAAA,sCAASP,UAAT,CAAoBQ,SAApB,CAA8BC,KAApC;AACA,iBAAKb,iBAAL,CAAuB,KAAKJ,OAA5B;AACH;AACJ;;AAEDkB,QAAAA,MAAM,CAACC,SAAD,EAAoB;AACtB,cAAIC,CAAC,GAAG,IAAR;AACAA,UAAAA,CAAC,CAACvB,SAAF,IAAesB,SAAf;;AACA,cAAIC,CAAC,CAACvB,SAAF,IAAe,CAAnB,EAAsB;AAElBuB,YAAAA,CAAC,CAACvB,SAAF,GAAc,CAAd;AACH;AACJ;;AAKD;AACJ;AACA;AACA;AACYO,QAAAA,iBAAiB,CAACiB,GAAD,EAAM;AAC3B,eAAKrB,OAAL,GAAeqB,GAAf;AACA;AAAA;AAAA,0BAAIC,GAAJ,CAAQD,GAAG,CAACf,IAAZ;;AACA,cAAI,KAAKP,WAAL,IAAoBsB,GAAG,CAACf,IAAJ,CAASC,IAAjC,EAAuC,CACnC;AACH;;AACD,eAAKR,WAAL,GAAmBsB,GAAG,CAACf,IAAJ,CAASC,IAA5B;AAEA,cAAIA,IAAI,GAAG,CAAX,CAR2B,CAQd;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,cAAIA,IAAI,IAAIgB,SAAZ,EAAuB;AACnBhB,YAAAA,IAAI,GAAG,CAAP;AACH,WA7B0B,CA8B3B;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,cAAIQ,GAAU,GAAG,CAAC;AAAES,YAAAA,MAAM,EAAE,CAAV;AAAYC,YAAAA,IAAI,EAAC,OAAjB;AAA0BC,YAAAA,QAAQ,EAAE,CAApC;AAAuCC,YAAAA,MAAM,EAAE,EAA/C;AAAmDC,YAAAA,KAAK,EAAE,GAA1D;AAA+DC,YAAAA,SAAS,EAAE,CAA1E;AAA6EC,YAAAA,OAAO,EAAE,CAAtF;AAAyFC,YAAAA,IAAI,EAAE,EAA/F;AAAmGC,YAAAA,SAAS,EAAE,EAA9G;AAAkHC,YAAAA,IAAI,EAAE,CAAxH;AAA2HC,YAAAA,MAAM,EAAC,EAAlI;AAAqIC,YAAAA,QAAQ,EAAC;AAA9I,WAAD,EACjB;AAAEX,YAAAA,MAAM,EAAE,CAAV;AAAYC,YAAAA,IAAI,EAAC,OAAjB;AAA0BC,YAAAA,QAAQ,EAAE,CAApC;AAAuCC,YAAAA,MAAM,EAAE,EAA/C;AAAmDC,YAAAA,KAAK,EAAE,GAA1D;AAA+DC,YAAAA,SAAS,EAAE,CAA1E;AAA6EC,YAAAA,OAAO,EAAE,CAAtF;AAAyFC,YAAAA,IAAI,EAAE,EAA/F;AAAmGC,YAAAA,SAAS,EAAE,EAA9G;AAAkHC,YAAAA,IAAI,EAAE,CAAxH;AAA2HC,YAAAA,MAAM,EAAC,EAAlI;AAAqIC,YAAAA,QAAQ,EAAC;AAA9I,WADiB,EAEjB;AAAEX,YAAAA,MAAM,EAAE,CAAV;AAAYC,YAAAA,IAAI,EAAC,OAAjB;AAA0BC,YAAAA,QAAQ,EAAE,CAApC;AAAuCC,YAAAA,MAAM,EAAE,EAA/C;AAAmDC,YAAAA,KAAK,EAAE,GAA1D;AAA+DC,YAAAA,SAAS,EAAE,CAA1E;AAA6EC,YAAAA,OAAO,EAAE,CAAtF;AAAyFC,YAAAA,IAAI,EAAE,EAA/F;AAAmGC,YAAAA,SAAS,EAAE,EAA9G;AAAkHC,YAAAA,IAAI,EAAE,CAAxH;AAA2HC,YAAAA,MAAM,EAAC,EAAlI;AAAqIC,YAAAA,QAAQ,EAAC;AAA9I,WAFiB,EAGjB;AAAEX,YAAAA,MAAM,EAAE,CAAV;AAAYC,YAAAA,IAAI,EAAC,OAAjB;AAA0BC,YAAAA,QAAQ,EAAE,CAApC;AAAuCC,YAAAA,MAAM,EAAE,EAA/C;AAAmDC,YAAAA,KAAK,EAAE,GAA1D;AAA+DC,YAAAA,SAAS,EAAE,CAA1E;AAA6EC,YAAAA,OAAO,EAAE,CAAtF;AAAyFC,YAAAA,IAAI,EAAE,EAA/F;AAAmGC,YAAAA,SAAS,EAAE,EAA9G;AAAkHC,YAAAA,IAAI,EAAE,CAAxH;AAA2HC,YAAAA,MAAM,EAAC,EAAlI;AAAqIC,YAAAA,QAAQ,EAAC;AAA9I,WAHiB,EAIjB;AAAEX,YAAAA,MAAM,EAAE,CAAV;AAAYC,YAAAA,IAAI,EAAC,OAAjB;AAA0BC,YAAAA,QAAQ,EAAE,CAApC;AAAuCC,YAAAA,MAAM,EAAE,EAA/C;AAAmDC,YAAAA,KAAK,EAAE,GAA1D;AAA+DC,YAAAA,SAAS,EAAE,CAA1E;AAA6EC,YAAAA,OAAO,EAAE,CAAtF;AAAyFC,YAAAA,IAAI,EAAE,EAA/F;AAAmGC,YAAAA,SAAS,EAAE,EAA9G;AAAkHC,YAAAA,IAAI,EAAE,CAAxH;AAA2HC,YAAAA,MAAM,EAAC,EAAlI;AAAqIC,YAAAA,QAAQ,EAAC;AAA9I,WAJiB,EAKjB;AAAEX,YAAAA,MAAM,EAAE,CAAV;AAAYC,YAAAA,IAAI,EAAC,OAAjB;AAA0BC,YAAAA,QAAQ,EAAE,CAApC;AAAuCC,YAAAA,MAAM,EAAE,EAA/C;AAAmDC,YAAAA,KAAK,EAAE,GAA1D;AAA+DC,YAAAA,SAAS,EAAE,CAA1E;AAA6EC,YAAAA,OAAO,EAAE,CAAtF;AAAyFC,YAAAA,IAAI,EAAE,EAA/F;AAAmGC,YAAAA,SAAS,EAAE,EAA9G;AAAkHC,YAAAA,IAAI,EAAE,CAAxH;AAA2HC,YAAAA,MAAM,EAAC,EAAlI;AAAqIC,YAAAA,QAAQ,EAAC;AAA9I,WALiB,CAAjB;;AAOA,cAAI,KAAK9B,OAAL,IAAgB,QAApB,EAA8B;AAC1B,gBAAIC,IAAI,GAAG;AACP,2BAAa;AADN,aAAX;AAGA,iBAAKV,OAAL,GAAemB,GAAf;AACA,iBAAKqB,eAAL,CAAqB,KAAKxC,OAA1B;AACH,WAND,MAMO,IAAI,KAAKS,OAAL,IAAgB,SAApB,EAA+B;AAClC,gBAAIC,KAAI,GAAG;AACP,2BAAaC,IAAI,GAAG;AADb,aAAX;AAGA,iBAAKX,OAAL,GAAemB,GAAf;AACA,iBAAKqB,eAAL,CAAqB,KAAKxC,OAA1B;AACH;AAEJ;AAED;AACJ;AACA;;;AACWwC,QAAAA,eAAe,CAACrB,GAAD,EAAM;AACxB;AAAA;AAAA,oCAASP,UAAT,CAAoB6B,aAApB,GAAoC,EAApC,CADwB,CACe;;AACvC,cAAIC,GAAG,GAAGC,IAAI,CAACC,IAAL,CAAUzB,GAAG,CAAC0B,MAAJ,GAAa,CAAvB,CAAV;AACA,cAAIC,MAAM,GAAG,EAAb;;AACA,eAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGL,GAApB,EAAyBK,CAAC,EAA1B,EAA8B;AAC1B,gBAAIC,OAAO,GAAG,EAAd;;AACA,iBAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,CAApB,EAAuBA,CAAC,EAAxB,EAA4B;AACxBD,cAAAA,OAAO,CAACE,IAAR,CAAa/B,GAAG,CAAE4B,CAAD,GAAM,CAAN,GAAUE,CAAX,CAAhB;AACH;;AACDH,YAAAA,MAAM,CAACI,IAAP,CAAYF,OAAZ;AACH;;AACD,cAAI,KAAKG,YAAT,EAAuB;AACnB,gBAAIC,IAAI,GAAG,KAAKD,YAAL,CAAkBE,cAAlB,CAAiC,UAAjC,CAAX;AACA,gBAAIC,UAAU,GAAGR,MAAM,CAACD,MAAxB;AACAO,YAAAA,IAAI,CAACG,YAAL;AAAA;AAAA,gDAAiCC,QAAjC,CAA0CF,UAA1C,EAAsDR,MAAtD;AACH;AAEJ;AAED;AACJ;AACA;;;AACW5B,QAAAA,aAAa,GAAG;AACnB;AACA;AACA;AACA,cAAIkC,IAAI,GAAG,KAAKD,YAAL,CAAkBE,cAAlB,CAAiC,UAAjC,CAAX;AACAD,UAAAA,IAAI,CAACG,YAAL;AAAA;AAAA,8CAAiCE,KAAjC;AACH;AAED;AACJ;AACA;;;AACWC,QAAAA,sBAAsB,GAAG;AAC5B,cAAIvC,GAAU,GAAG;AAAA;AAAA,oCAASP,UAAT,CAAoBQ,SAApB,CAA8BC,KAA/C;AACA,cAAIqB,GAAG,GAAGC,IAAI,CAACC,IAAL,CAAUzB,GAAG,CAAC0B,MAAJ,GAAa,CAAvB,CAAV;AACA,cAAIC,MAAM,GAAG,EAAb;;AACA,eAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGL,GAApB,EAAyBK,CAAC,EAA1B,EAA8B;AAC1B,gBAAIC,OAAO,GAAG,EAAd;;AACA,iBAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,CAApB,EAAuBA,CAAC,EAAxB,EAA4B;AACxBD,cAAAA,OAAO,CAACE,IAAR,CAAa/B,GAAG,CAAE4B,CAAD,GAAM,CAAN,GAAUE,CAAX,CAAhB;AACH;;AACDH,YAAAA,MAAM,CAACI,IAAP,CAAYF,OAAZ;AACH;;AACD,cAAI,KAAKG,YAAT,EAAuB;AACnB,gBAAIC,IAAI,GAAG,KAAKD,YAAL,CAAkBE,cAAlB,CAAiC,UAAjC,CAAX;AACA,gBAAIC,UAAU,GAAGR,MAAM,CAACD,MAAxB;AACAO,YAAAA,IAAI,CAACG,YAAL;AAAA;AAAA,gDAAiCC,QAAjC,CAA0CF,UAA1C,EAAsDR,MAAtD;AACH;AACJ;;AApL6C,O;;;;;iBAIzB,I;;;;;;;iBAEI,E","sourcesContent":["import { _decorator, Component, Node, instantiate, Prefab, warn, Vec3 } from 'cc';\nimport { forEach } from 'lodash-es';\nimport { modelMgr, observer } from '../../../game/App';\nimport { ListViewCtrl2 } from '../../../game/components/listViewCtrl2';\nimport { PageViewCtrl } from '../../../game/components/PageViewCtrl';\nimport { PageViewItemCtrl } from '../../../game/components/PageViewItemCtrl';\nimport { DataEvents } from '../../../model/DataEvents';\nimport ArrUtils from '../../../utils/ArrUtils';\nimport WebUtils from '../../../utils/WebUtils';\nimport Log from '../../../../../assets/src/utils/LogUtils'\nconst { ccclass, property } = _decorator;\n/**\n * 购买种子 container controller\n */\n@ccclass('GoumaiZZController')\nexport class GoumaiZZController extends Component {\n\n\n    @property(Node)\n    pre_listView: Node = null;\n    @property(String)\n    public oprType: string = \"\";\n\n\n\n    showarr: any[];\n    start() {\n        // this.sortselectHandler({data:{type:\"Toggle_goumai\"}});\n\n    }\n    onEnable() {\n        observer.on(\"toggle\", this.sortselectHandler, this);\n\n        if (this.oprType == \"goumai\") {\n            if (!this._currentTog) {\n                this._currentTog = \"Toggle-goumai001\";\n            }\n            this.sortselectHandler({ data: { type: this._currentTog } });\n        } else if (this.oprType == \"chushou\") {\n            if (!this._currentTog) {\n                this._currentTog = \"Toggle-chushou001\";\n            }\n            //每次展示时,刷新数据;\n            this.sortselectHandler({ data: { type: this._currentTog } });\n\n        }\n\n\n\n        modelMgr.jishiModel.currentchushouTab = \"seeds\";\n        modelMgr.jishiModel.on(DataEvents.FRESH_SEEDS_SELL_NULL, this.nullfresh, this);\n    }\n    onDisable() {\n        observer.off(\"toggle\", this.sortselectHandler, this);\n        modelMgr.jishiModel.off(DataEvents.FRESH_SEEDS_SELL_NULL, this.nullfresh, this);\n        this.removeallItem();\n\n    }\n\n    nullfresh() {\n        let arr: any[];\n        if (this.oprType == \"chushou\") {\n            arr = modelMgr.jishiModel.storelist.seeds as any[];\n            this.sortselectHandler(this._curevt);\n        }\n    }\n    public _lasttime: number = 0;\n    update(deltaTime: number) {\n        let s = this;\n        s._lasttime += deltaTime;\n        if (s._lasttime >= 1) {\n\n            s._lasttime = 0;\n        }\n    }\n\n    private _temparr: any[];\n    private _currentTog: string = \"\";\n    private _curevt;\n    /**\n     * 物品类型筛选\n     * @param evt \n     */\n    private sortselectHandler(evt) {\n        this._curevt = evt;\n        Log.log(evt.data);\n        if (this._currentTog == evt.data.type) {\n            // return;//冲刷数据,不屏蔽\n        }\n        this._currentTog = evt.data.type;\n\n        let type = 0;//v0.8 改为默认全部显示\n        // switch (evt.data.type) {//  \"dimension\": 3,  //维度类型(1:稀有度|2:颜色|3:系列)\n        //     case \"Toggle_goumai\"://全部\n        //     case \"Toggle-chushou\"://全部\n        //         type = 0;\n        //         break;\n        //     case \"Toggle-goumai001\"://品级\n        //     case \"Toggle-chushou001\"://品级\n        //         type = 1;\n        //         break;\n        //     case \"Toggle-goumai002\"://颜色\n        //     case \"Toggle-chushou002\"://颜色\n        //         type = 2;\n        //         break;\n        //     case \"Toggle-goumai003\"://系列\n        //     case \"Toggle-chushou003\"://系列\n        //         type = 3;\n        //         break;\n        // }\n        if (type == undefined) {\n            type = 1;\n        }\n        //筛选逻辑\n        // if (type != 0) {\n        //     this.showarr = ArrUtils.pickElmsFromArrayByProp(arr, \"dimension\", type)\n        // } else {\n        //     this.showarr = arr;\n        // }\n        //排序逻辑\n        let arr: any[] = [{ seedId: 1,name:\"精品猫粮1\", restrict: 0, quanta: 10, quota: 100, dimension: 1, subType: 1, icon: \"\", salePrice: 10, sell: 1 ,amount:10,buyPrice:20},\n        { seedId: 2,name:\"精品猫粮1\", restrict: 0, quanta: 10, quota: 100, dimension: 1, subType: 1, icon: \"\", salePrice: 10, sell: 1 ,amount:10,buyPrice:20},\n        { seedId: 3,name:\"精品猫粮1\", restrict: 0, quanta: 10, quota: 100, dimension: 1, subType: 1, icon: \"\", salePrice: 10, sell: 1 ,amount:10,buyPrice:20},\n        { seedId: 4,name:\"精品猫粮3\", restrict: 0, quanta: 10, quota: 100, dimension: 1, subType: 1, icon: \"\", salePrice: 10, sell: 1 ,amount:10,buyPrice:20},\n        { seedId: 5,name:\"精品猫粮1\", restrict: 0, quanta: 10, quota: 100, dimension: 1, subType: 1, icon: \"\", salePrice: 10, sell: 1 ,amount:10,buyPrice:20},\n        { seedId: 6,name:\"精品猫粮1\", restrict: 0, quanta: 10, quota: 100, dimension: 1, subType: 1, icon: \"\", salePrice: 10, sell: 1 ,amount:10,buyPrice:20},\n    ];\n        if (this.oprType == \"goumai\") {\n            let data = {\n                \"dimension\": \"\",\n            }\n            this.showarr = arr;\n            this.showZhongziList(this.showarr);\n        } else if (this.oprType == \"chushou\") {\n            let data = {\n                \"dimension\": type + \"\",\n            }\n            this.showarr = arr;\n            this.showZhongziList(this.showarr);\n        }\n\n    }\n\n    /**\n     * \n     */\n    public showZhongziList(arr) {\n        modelMgr.jishiModel.hasSelectData = [];//清除已选物品；\n        let len = Math.ceil(arr.length / 3);\n        let grpArr = [];\n        for (let i = 0; i < len; i++) {\n            let temparr = [];\n            for (let j = 0; j < 3; j++) {\n                temparr.push(arr[(i) * 3 + j]);\n            }\n            grpArr.push(temparr);\n        }\n        if (this.pre_listView) {\n            let ctrl = this.pre_listView.getChildByName(\"listctrl\");\n            let spawnCount = grpArr.length;\n            ctrl.getComponent(ListViewCtrl2).initData(spawnCount, grpArr);\n        }\n\n    }\n\n    /**\n     * 清除所有的item\n     */\n    public removeallItem() {\n        // forEach( this._gmzhongziItemArr,(value)=>{\n        //     value.destroy();\n        // })\n        let ctrl = this.pre_listView.getChildByName(\"listctrl\");\n        ctrl.getComponent(ListViewCtrl2).reset();\n    }\n\n    /**\n     * \n     */\n    public showChushouZhongziList() {\n        let arr: any[] = modelMgr.jishiModel.storelist.seeds as any[];\n        let len = Math.ceil(arr.length / 3);\n        let grpArr = [];\n        for (let i = 0; i < len; i++) {\n            let temparr = [];\n            for (let j = 0; j < 3; j++) {\n                temparr.push(arr[(i) * 3 + j]);\n            }\n            grpArr.push(temparr);\n        }\n        if (this.pre_listView) {\n            let ctrl = this.pre_listView.getChildByName(\"listctrl\");\n            let spawnCount = grpArr.length;\n            ctrl.getComponent(ListViewCtrl2).initData(spawnCount, grpArr);\n        }\n    }\n}\n\n"]}