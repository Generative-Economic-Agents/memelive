{"version":3,"sources":["file:///Users/feiwang/cutepet/node_modules/aws-sign2/index.js"],"names":["_cjsLoader","_req","__cjsMetaURL","_req0","url","define","exports","require","module","__filename","__dirname","crypto","parse","keys","authorization","options","key","sign","hmacSha1","createHmac","secret","update","message","digest","stringToSign","signQuery","queryStringToSign","headers","amazonHeaders","r","verb","md5","contentType","date","toUTCString","resource","join","canonicalizeHeaders","buf","fields","Object","i","len","length","field","val","toLowerCase","indexOf","push","sort","canonicalizeResource","path","pathname","query","forEach","encodeURIComponent","_cjsExports","_authorization","_hmacSha1","_sign","_signQuery","_stringToSign","_queryStringToSign","_canonicalizeHeaders","_canonicalizeResource"],"mappings":"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","sourcesContent":["import _cjsLoader from 'cce:/internal/ml/cjs-loader.mjs';\nimport { __cjsMetaURL as _req} from 'crypto';\nimport { __cjsMetaURL as _req0} from 'url';\nlet _cjsExports;\nlet _authorization;\nlet _hmacSha1;\nlet _sign;\nlet _signQuery;\nlet _stringToSign;\nlet _queryStringToSign;\nlet _canonicalizeHeaders;\nlet _canonicalizeResource;\nconst __cjsMetaURL = import.meta.url;\n_cjsLoader.define(__cjsMetaURL, function (exports, require, module, __filename, __dirname) {\n// #region ORIGINAL CODE\n\n\n\n /*!\n  *  Copyright 2010 LearnBoost <dev@learnboost.com>\n  *\n  * Licensed under the Apache License, Version 2.0 (the \"License\");\n  * you may not use this file except in compliance with the License.\n  * You may obtain a copy of the License at\n  *\n  *     http://www.apache.org/licenses/LICENSE-2.0\n  *\n  * Unless required by applicable law or agreed to in writing, software\n  * distributed under the License is distributed on an \"AS IS\" BASIS,\n  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n  * See the License for the specific language governing permissions and\n  * limitations under the License.\n  */\n\n /**\n  * Module dependencies.\n  */\n\n var crypto = require('crypto')\n   , parse = require('url').parse\n   ;\n\n /**\n  * Valid keys.\n  */\n\n var keys = \n   [ 'acl'\n   , 'location'\n   , 'logging'\n   , 'notification'\n   , 'partNumber'\n   , 'policy'\n   , 'requestPayment'\n   , 'torrent'\n   , 'uploadId'\n   , 'uploads'\n   , 'versionId'\n   , 'versioning'\n   , 'versions'\n   , 'website'\n   ]\n\n /**\n  * Return an \"Authorization\" header value with the given `options`\n  * in the form of \"AWS <key>:<signature>\"\n  *\n  * @param {Object} options\n  * @return {String}\n  * @api private\n  */\n\n function authorization (options) {\n   return 'AWS ' + options.key + ':' + sign(options)\n }\n\n module.exports = authorization\n module.exports.authorization = authorization\n\n /**\n  * Simple HMAC-SHA1 Wrapper\n  *\n  * @param {Object} options\n  * @return {String}\n  * @api private\n  */ \n\n function hmacSha1 (options) {\n   return crypto.createHmac('sha1', options.secret).update(options.message).digest('base64')\n }\n\n module.exports.hmacSha1 = hmacSha1\n\n /**\n  * Create a base64 sha1 HMAC for `options`. \n  * \n  * @param {Object} options\n  * @return {String}\n  * @api private\n  */\n\n function sign (options) {\n   options.message = stringToSign(options)\n   return hmacSha1(options)\n }\n module.exports.sign = sign\n\n /**\n  * Create a base64 sha1 HMAC for `options`. \n  *\n  * Specifically to be used with S3 presigned URLs\n  * \n  * @param {Object} options\n  * @return {String}\n  * @api private\n  */\n\n function signQuery (options) {\n   options.message = queryStringToSign(options)\n   return hmacSha1(options)\n }\n module.exports.signQuery= signQuery\n\n /**\n  * Return a string for sign() with the given `options`.\n  *\n  * Spec:\n  * \n  *    <verb>\\n\n  *    <md5>\\n\n  *    <content-type>\\n\n  *    <date>\\n\n  *    [headers\\n]\n  *    <resource>\n  *\n  * @param {Object} options\n  * @return {String}\n  * @api private\n  */\n\n function stringToSign (options) {\n   var headers = options.amazonHeaders || ''\n   if (headers) headers += '\\n'\n   var r = \n     [ options.verb\n     , options.md5\n     , options.contentType\n     , options.date ? options.date.toUTCString() : ''\n     , headers + options.resource\n     ]\n   return r.join('\\n')\n }\n module.exports.stringToSign = stringToSign\n\n /**\n  * Return a string for sign() with the given `options`, but is meant exclusively\n  * for S3 presigned URLs\n  *\n  * Spec:\n  * \n  *    <date>\\n\n  *    <resource>\n  *\n  * @param {Object} options\n  * @return {String}\n  * @api private\n  */\n\n function queryStringToSign (options){\n   return 'GET\\n\\n\\n' + options.date + '\\n' + options.resource\n }\n module.exports.queryStringToSign = queryStringToSign\n\n /**\n  * Perform the following:\n  *\n  *  - ignore non-amazon headers\n  *  - lowercase fields\n  *  - sort lexicographically\n  *  - trim whitespace between \":\"\n  *  - join with newline\n  *\n  * @param {Object} headers\n  * @return {String}\n  * @api private\n  */\n\n function canonicalizeHeaders (headers) {\n   var buf = []\n     , fields = Object.keys(headers)\n     ;\n   for (var i = 0, len = fields.length; i < len; ++i) {\n     var field = fields[i]\n       , val = headers[field]\n       , field = field.toLowerCase()\n       ;\n     if (0 !== field.indexOf('x-amz')) continue\n     buf.push(field + ':' + val)\n   }\n   return buf.sort().join('\\n')\n }\n module.exports.canonicalizeHeaders = canonicalizeHeaders\n\n /**\n  * Perform the following:\n  *\n  *  - ignore non sub-resources\n  *  - sort lexicographically\n  *\n  * @param {String} resource\n  * @return {String}\n  * @api private\n  */\n\n function canonicalizeResource (resource) {\n   var url = parse(resource, true)\n     , path = url.pathname\n     , buf = []\n     ;\n\n   Object.keys(url.query).forEach(function(key){\n     if (!~keys.indexOf(key)) return\n     var val = '' == url.query[key] ? '' : '=' + encodeURIComponent(url.query[key])\n     buf.push(key + val)\n   })\n\n   return path + (buf.length ? '?' + buf.sort().join('&') : '')\n }\n module.exports.canonicalizeResource = canonicalizeResource\n\n\n// #endregion ORIGINAL CODE\n\n_cjsExports = module.exports;\n_authorization = module.exports.authorization;\n_hmacSha1 = module.exports.hmacSha1;\n_sign = module.exports.sign;\n_signQuery = module.exports.signQuery;\n_stringToSign = module.exports.stringToSign;\n_queryStringToSign = module.exports.queryStringToSign;\n_canonicalizeHeaders = module.exports.canonicalizeHeaders;\n_canonicalizeResource = module.exports.canonicalizeResource;\n\n}, () => ({\n  'crypto': _req,\n  'url': _req0,\n}));\nexport { _cjsExports as default };\nexport { __cjsMetaURL }\n"]}