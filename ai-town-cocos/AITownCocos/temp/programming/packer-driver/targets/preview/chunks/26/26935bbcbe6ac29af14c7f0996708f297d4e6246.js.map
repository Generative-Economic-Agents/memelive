{"version":3,"sources":["file:///Users/feiwang/cutepet/assets/src/module/main/jishi/GoumaiDaojuController.ts"],"names":["_decorator","Component","Node","modelMgr","ListViewCtrl2","DataEvents","ccclass","property","GoumaiDaojuController","type","String","start","onEnable","jishiModel","on","FRESH_SEEDS_SELL_NULL","nullfresh","oprType","showBuyDaojuList","showSellPlantList","currentchushouTab","onDisable","off","removeallItem","data","update","deltaTime","shoplist","arr","items","len","Math","ceil","length","grpArr","i","temparr","j","push","pre_listView","ctrl","getChildByName","spawnCount","getComponent","initData","reset","hasSelectData","storelist","plants"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,I,OAAAA,I;;AAEvBC,MAAAA,Q,iBAAAA,Q;;AACAC,MAAAA,a,iBAAAA,a;;AAEAC,MAAAA,U,iBAAAA,U;;;;;;;;;OAEH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBP,U;AAC9B;AACA;AACA;;uCAEaQ,qB,WADZF,OAAO,CAAC,uBAAD,C,UAEHC,QAAQ,CAAC;AAAEE,QAAAA,IAAI,EAAEP;AAAR,OAAD,C,UAIRK,QAAQ,CAACL,IAAD,C,UAERK,QAAQ,CAACG,MAAD,C,2BARb,MACaF,qBADb,SAC2CP,SAD3C,CACqD;AAAA;AAAA;;AAAA;;AAAA;;AAAA;AAAA;;AAUjDU,QAAAA,KAAK,GAAG,CAEP;;AACDC,QAAAA,QAAQ,GAAG;AACP;AAAA;AAAA,oCAASC,UAAT,CAAoBC,EAApB,CAAuB;AAAA;AAAA,wCAAWC,qBAAlC,EAAwD,KAAKC,SAA7D,EAAuE,IAAvE;;AAEA,cAAI,KAAKC,OAAL,IAAgB,QAApB,EAA8B;AAC1B,iBAAKC,gBAAL;AACH,WAFD,MAEO,IAAI,KAAKD,OAAL,IAAgB,SAApB,EAA+B;AAC9B,iBAAKE,iBAAL;AACP;;AAED;AAAA;AAAA,oCAASN,UAAT,CAAoBO,iBAApB,GAAwC,QAAxC;AAEH;AAGD;AACJ;AACA;;;AACIC,QAAAA,SAAS,GAAG;AACR;AAAA;AAAA,oCAASR,UAAT,CAAoBS,GAApB,CAAwB;AAAA;AAAA,wCAAWP,qBAAnC,EAAyD,KAAKC,SAA9D,EAAwE,IAAxE;AACA,eAAKO,aAAL;AACH;;AACDP,QAAAA,SAAS,GAAE;AACP,cAAI,KAAKC,OAAL,IAAgB,SAApB,EAA+B;AAC3B,gBAAIO,IAAI,GAAG;AACP,2BAAa,GADN,CACU;;AADV,aAAX;AAGE,iBAAKL,iBAAL;AACL;AACJ;;AACDM,QAAAA,MAAM,CAACC,SAAD,EAAoB,CAEzB;AACD;AACJ;AACA;;;AACWR,QAAAA,gBAAgB,GAAG;AACtB,eAAKK,aAAL;;AACA,cAAI,CAAC;AAAA;AAAA,oCAASV,UAAT,CAAoBc,QAAzB,EAAmC;AAC/B,mBAD+B,CACxB;AACV;;AACD,cAAIC,GAAU,GAAG;AAAA;AAAA,oCAASf,UAAT,CAAoBc,QAApB,CAA6BE,KAA9C;AACA,cAAIC,GAAG,GAAGC,IAAI,CAACC,IAAL,CAAUJ,GAAG,CAACK,MAAJ,GAAa,CAAvB,CAAV;AACA,cAAIC,MAAM,GAAG,EAAb;;AACA,eAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGL,GAApB,EAAyBK,CAAC,EAA1B,EAA8B;AAC1B,gBAAIC,OAAO,GAAG,EAAd;;AACA,iBAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,CAApB,EAAuBA,CAAC,EAAxB,EAA4B;AACxBD,cAAAA,OAAO,CAACE,IAAR,CAAaV,GAAG,CAAEO,CAAD,GAAM,CAAN,GAAUE,CAAX,CAAhB;AACH;;AACDH,YAAAA,MAAM,CAACI,IAAP,CAAYF,OAAZ;AACH;;AACD,cAAI,KAAKG,YAAT,EAAuB;AACnB,gBAAIC,IAAI,GAAG,KAAKD,YAAL,CAAkBE,cAAlB,CAAiC,UAAjC,CAAX;AACA,gBAAIC,UAAU,GAAGR,MAAM,CAACD,MAAxB;AACAO,YAAAA,IAAI,CAACG,YAAL;AAAA;AAAA,gDAAiCC,QAAjC,CAA0CF,UAA1C,EAAsDR,MAAtD;AACH;AACJ;AACD;AACJ;AACA;;;AACWX,QAAAA,aAAa,GAAG;AACnB,cAAIiB,IAAI,GAAG,KAAKD,YAAL,CAAkBE,cAAlB,CAAiC,UAAjC,CAAX;AACAD,UAAAA,IAAI,CAACG,YAAL;AAAA;AAAA,8CAAiCE,KAAjC;AACH;AACD;AACJ;AACA;;;AACW1B,QAAAA,iBAAiB,GAAG;AAEvB;AAAA;AAAA,oCAASN,UAAT,CAAoBiC,aAApB,GAAoC,EAApC,CAFuB,CAEgB;;AACvC,cAAIlB,GAAU,GAAG;AAAA;AAAA,oCAASf,UAAT,CAAoBkC,SAApB,CAA8BC,MAA/C;AACA,cAAIlB,GAAG,GAAGC,IAAI,CAACC,IAAL,CAAUJ,GAAG,CAACK,MAAJ,GAAa,CAAvB,CAAV;AACA,cAAIC,MAAM,GAAG,EAAb;;AACA,eAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGL,GAApB,EAAyBK,CAAC,EAA1B,EAA8B;AAC1B,gBAAIC,OAAO,GAAG,EAAd;;AACA,iBAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,CAApB,EAAuBA,CAAC,EAAxB,EAA4B;AACxBD,cAAAA,OAAO,CAACE,IAAR,CAAaV,GAAG,CAAEO,CAAD,GAAM,CAAN,GAAUE,CAAX,CAAhB;AACH;;AACDH,YAAAA,MAAM,CAACI,IAAP,CAAYF,OAAZ;AACH;;AACD,cAAI,KAAKG,YAAT,EAAuB;AACnB,gBAAIC,IAAI,GAAG,KAAKD,YAAL,CAAkBE,cAAlB,CAAiC,UAAjC,CAAX;AACA,gBAAIC,UAAU,GAAGR,MAAM,CAACD,MAAxB;AACAO,YAAAA,IAAI,CAACG,YAAL;AAAA;AAAA,gDAAiCC,QAAjC,CAA0CF,UAA1C,EAAsDR,MAAtD;AACH;AACJ;;AAjGgD,O;;;;;iBAEpB,I;;;;;;;iBAIR,I;;;;;;;iBAEI,E","sourcesContent":["import { _decorator, Component, Node, instantiate, Prefab, warn, Vec3 } from 'cc';\nimport { forEach } from 'lodash-es';\nimport { modelMgr, observer } from '../../../game/App';\nimport { ListViewCtrl2 } from '../../../game/components/listViewCtrl2';\nimport { PageViewCtrl } from '../../../game/components/PageViewCtrl';\nimport { DataEvents } from '../../../model/DataEvents';\nimport WebUtils from '../../../utils/WebUtils';\nconst { ccclass, property } = _decorator;\n/**\n * 购买道具 container controller\n */\n@ccclass('GoumaiDaojuController')\nexport class GoumaiDaojuController extends Component {\n    @property({ type: Node })\n    public itemcontainer: Node = null;\n\n\n    @property(Node)\n    pre_listView: Node = null;\n    @property(String)\n    public oprType: string = \"\";\n\n    start() {\n\n    }\n    onEnable() {\n        modelMgr.jishiModel.on(DataEvents.FRESH_SEEDS_SELL_NULL,this.nullfresh,this);\n\n        if (this.oprType == \"goumai\") {\n            this.showBuyDaojuList();\n        } else if (this.oprType == \"chushou\") {\n                this.showSellPlantList();\n        }\n\n        modelMgr.jishiModel.currentchushouTab = \"plants\";\n\n    }\n\n\n    /**\n     * \n     */\n    onDisable() {\n        modelMgr.jishiModel.off(DataEvents.FRESH_SEEDS_SELL_NULL,this.nullfresh,this);\n        this.removeallItem();\n    }\n    nullfresh(){\n        if (this.oprType == \"chushou\") {\n            let data = {\n                \"dimension\": \"0\",//种子和植物在一个接口\n              }\n              this.showSellPlantList();\n        }\n    }\n    update(deltaTime: number) {\n\n    }\n    /**\n     * \n     */\n    public showBuyDaojuList() {\n        this.removeallItem();\n        if (!modelMgr.jishiModel.shoplist) {\n            return;//无数据\n        }\n        let arr: any[] = modelMgr.jishiModel.shoplist.items as any[];\n        let len = Math.ceil(arr.length / 3);\n        let grpArr = [];\n        for (let i = 0; i < len; i++) {\n            let temparr = [];\n            for (let j = 0; j < 3; j++) {\n                temparr.push(arr[(i) * 3 + j]);\n            }\n            grpArr.push(temparr);\n        }\n        if (this.pre_listView) {\n            let ctrl = this.pre_listView.getChildByName(\"listctrl\");\n            let spawnCount = grpArr.length;\n            ctrl.getComponent(ListViewCtrl2).initData(spawnCount, grpArr);\n        }\n    }\n    /**\n     * 清除所有的item\n     */\n    public removeallItem() {\n        let ctrl = this.pre_listView.getChildByName(\"listctrl\");\n        ctrl.getComponent(ListViewCtrl2).reset();\n    }\n    /**\n     * 出售植物\n     */\n    public showSellPlantList() {\n\n        modelMgr.jishiModel.hasSelectData = [];//清除已选物品；\n        let arr: any[] = modelMgr.jishiModel.storelist.plants as any[];\n        let len = Math.ceil(arr.length / 3);\n        let grpArr = [];\n        for (let i = 0; i < len; i++) {\n            let temparr = [];\n            for (let j = 0; j < 3; j++) {\n                temparr.push(arr[(i) * 3 + j]);\n            }\n            grpArr.push(temparr);\n        }\n        if (this.pre_listView) {\n            let ctrl = this.pre_listView.getChildByName(\"listctrl\");\n            let spawnCount = grpArr.length;\n            ctrl.getComponent(ListViewCtrl2).initData(spawnCount, grpArr);\n        }\n    }\n}\n\n"]}