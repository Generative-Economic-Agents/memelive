{"version":3,"sources":["file:///Users/feiwang/cutepet/node_modules/sshpk/lib/formats/x509-pem.js"],"names":["_cjsLoader","_req","__cjsMetaURL","_req0","_req1","_req2","_req3","_req4","_req5","_req6","_req7","_req8","_req9","_req10","url","define","exports","require","module","__filename","__dirname","x509","read","verify","sign","write","assert","asn1","Buffer","algs","utils","Key","PrivateKey","pem","Identity","Signature","Certificate","buf","options","buffer","toString","lines","trim","split","m","si","length","match","ok","m2","ei","slice","headers","toLowerCase","join","from","cert","dbuf","header","tmp","len","alloc","o","i","limit","_cjsExports","_read","_verify"],"mappings":"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","sourcesContent":["import _cjsLoader from 'cce:/internal/ml/cjs-loader.mjs';\nimport { __cjsMetaURL as _req} from './x509';\nimport { __cjsMetaURL as _req0} from 'assert-plus';\nimport { __cjsMetaURL as _req1} from 'asn1';\nimport { __cjsMetaURL as _req2} from 'safer-buffer';\nimport { __cjsMetaURL as _req3} from '../algs';\nimport { __cjsMetaURL as _req4} from '../utils';\nimport { __cjsMetaURL as _req5} from '../key';\nimport { __cjsMetaURL as _req6} from '../private-key';\nimport { __cjsMetaURL as _req7} from './pem';\nimport { __cjsMetaURL as _req8} from '../identity';\nimport { __cjsMetaURL as _req9} from '../signature';\nimport { __cjsMetaURL as _req10} from '../certificate';\nlet _cjsExports;\nlet _read;\nlet _verify;\nconst __cjsMetaURL = import.meta.url;\n_cjsLoader.define(__cjsMetaURL, function (exports, require, module, __filename, __dirname) {\n// #region ORIGINAL CODE\n\n\n // Copyright 2016 Joyent, Inc.\n\n var x509 = require('./x509');\n\n module.exports = {\n \tread: read,\n \tverify: x509.verify,\n \tsign: x509.sign,\n \twrite: write\n };\n\n var assert = require('assert-plus');\n var asn1 = require('asn1');\n var Buffer = require('safer-buffer').Buffer;\n var algs = require('../algs');\n var utils = require('../utils');\n var Key = require('../key');\n var PrivateKey = require('../private-key');\n var pem = require('./pem');\n var Identity = require('../identity');\n var Signature = require('../signature');\n var Certificate = require('../certificate');\n\n function read(buf, options) {\n \tif (typeof (buf) !== 'string') {\n \t\tassert.buffer(buf, 'buf');\n \t\tbuf = buf.toString('ascii');\n \t}\n\n \tvar lines = buf.trim().split(/[\\r\\n]+/g);\n\n \tvar m;\n \tvar si = -1;\n \twhile (!m && si < lines.length) {\n \t\tm = lines[++si].match(/*JSSTYLED*/\n \t\t    /[-]+[ ]*BEGIN CERTIFICATE[ ]*[-]+/);\n \t}\n \tassert.ok(m, 'invalid PEM header');\n\n \tvar m2;\n \tvar ei = lines.length;\n \twhile (!m2 && ei > 0) {\n \t\tm2 = lines[--ei].match(/*JSSTYLED*/\n \t\t    /[-]+[ ]*END CERTIFICATE[ ]*[-]+/);\n \t}\n \tassert.ok(m2, 'invalid PEM footer');\n\n \tlines = lines.slice(si, ei + 1);\n\n \tvar headers = {};\n \twhile (true) {\n \t\tlines = lines.slice(1);\n \t\tm = lines[0].match(/*JSSTYLED*/\n \t\t    /^([A-Za-z0-9-]+): (.+)$/);\n \t\tif (!m)\n \t\t\tbreak;\n \t\theaders[m[1].toLowerCase()] = m[2];\n \t}\n\n \t/* Chop off the first and last lines */\n \tlines = lines.slice(0, -1).join('');\n \tbuf = Buffer.from(lines, 'base64');\n\n \treturn (x509.read(buf, options));\n }\n\n function write(cert, options) {\n \tvar dbuf = x509.write(cert, options);\n\n \tvar header = 'CERTIFICATE';\n \tvar tmp = dbuf.toString('base64');\n \tvar len = tmp.length + (tmp.length / 64) +\n \t    18 + 16 + header.length*2 + 10;\n \tvar buf = Buffer.alloc(len);\n \tvar o = 0;\n \to += buf.write('-----BEGIN ' + header + '-----\\n', o);\n \tfor (var i = 0; i < tmp.length; ) {\n \t\tvar limit = i + 64;\n \t\tif (limit > tmp.length)\n \t\t\tlimit = tmp.length;\n \t\to += buf.write(tmp.slice(i, limit), o);\n \t\tbuf[o++] = 10;\n \t\ti = limit;\n \t}\n \to += buf.write('-----END ' + header + '-----\\n', o);\n\n \treturn (buf.slice(0, o));\n }\n\n\n// #endregion ORIGINAL CODE\n\n_cjsExports = module.exports;\n_read = module.exports.read;\n_verify = module.exports.verify;\n\n}, () => ({\n  './x509': _req,\n  'assert-plus': _req0,\n  'asn1': _req1,\n  'safer-buffer': _req2,\n  '../algs': _req3,\n  '../utils': _req4,\n  '../key': _req5,\n  '../private-key': _req6,\n  './pem': _req7,\n  '../identity': _req8,\n  '../signature': _req9,\n  '../certificate': _req10,\n}));\nexport { _cjsExports as default };\nexport { __cjsMetaURL }\n"]}