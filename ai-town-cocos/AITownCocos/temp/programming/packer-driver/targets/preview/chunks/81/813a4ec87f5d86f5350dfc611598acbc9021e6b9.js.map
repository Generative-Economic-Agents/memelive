{"version":3,"sources":["file:///Users/feiwang/cutepet/node_modules/aws-sdk/lib/signers/s3.js"],"names":["_cjsLoader","_req","__cjsMetaURL","url","define","exports","require","module","__filename","__dirname","AWS","inherit","util","Signers","S3","RequestSigner","subResources","responseHeaders","addAuthorization","credentials","date","request","headers","rfc822","sessionToken","signature","sign","secretAccessKey","stringToSign","auth","accessKeyId","r","parts","push","method","canonicalizedAmzHeaders","canonicalizedResource","join","amzHeaders","each","name","match","sort","a","b","toLowerCase","arrayEach","call","String","path","split","querystring","resource","virtualHostedBucket","resources","param","value","subresource","undefined","decodeURIComponent","length","res","secret","string","crypto","hmac","_cjsExports"],"mappings":"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","sourcesContent":["import _cjsLoader from 'cce:/internal/ml/cjs-loader.mjs';\nimport { __cjsMetaURL as _req} from '../core';\nlet _cjsExports;\nconst __cjsMetaURL = import.meta.url;\n_cjsLoader.define(__cjsMetaURL, function (exports, require, module, __filename, __dirname) {\n// #region ORIGINAL CODE\n\n\n var AWS = require('../core');\n var inherit = AWS.util.inherit;\n\n /**\n  * @api private\n  */\n AWS.Signers.S3 = inherit(AWS.Signers.RequestSigner, {\n   /**\n    * When building the stringToSign, these sub resource params should be\n    * part of the canonical resource string with their NON-decoded values\n    */\n   subResources: {\n     'acl': 1,\n     'accelerate': 1,\n     'analytics': 1,\n     'cors': 1,\n     'lifecycle': 1,\n     'delete': 1,\n     'inventory': 1,\n     'location': 1,\n     'logging': 1,\n     'metrics': 1,\n     'notification': 1,\n     'partNumber': 1,\n     'policy': 1,\n     'requestPayment': 1,\n     'replication': 1,\n     'restore': 1,\n     'tagging': 1,\n     'torrent': 1,\n     'uploadId': 1,\n     'uploads': 1,\n     'versionId': 1,\n     'versioning': 1,\n     'versions': 1,\n     'website': 1\n   },\n\n   // when building the stringToSign, these querystring params should be\n   // part of the canonical resource string with their NON-encoded values\n   responseHeaders: {\n     'response-content-type': 1,\n     'response-content-language': 1,\n     'response-expires': 1,\n     'response-cache-control': 1,\n     'response-content-disposition': 1,\n     'response-content-encoding': 1\n   },\n\n   addAuthorization: function addAuthorization(credentials, date) {\n     if (!this.request.headers['presigned-expires']) {\n       this.request.headers['X-Amz-Date'] = AWS.util.date.rfc822(date);\n     }\n\n     if (credentials.sessionToken) {\n       // presigned URLs require this header to be lowercased\n       this.request.headers['x-amz-security-token'] = credentials.sessionToken;\n     }\n\n     var signature = this.sign(credentials.secretAccessKey, this.stringToSign());\n     var auth = 'AWS ' + credentials.accessKeyId + ':' + signature;\n\n     this.request.headers['Authorization'] = auth;\n   },\n\n   stringToSign: function stringToSign() {\n     var r = this.request;\n\n     var parts = [];\n     parts.push(r.method);\n     parts.push(r.headers['Content-MD5'] || '');\n     parts.push(r.headers['Content-Type'] || '');\n\n     // This is the \"Date\" header, but we use X-Amz-Date.\n     // The S3 signing mechanism requires us to pass an empty\n     // string for this Date header regardless.\n     parts.push(r.headers['presigned-expires'] || '');\n\n     var headers = this.canonicalizedAmzHeaders();\n     if (headers) parts.push(headers);\n     parts.push(this.canonicalizedResource());\n\n     return parts.join('\\n');\n\n   },\n\n   canonicalizedAmzHeaders: function canonicalizedAmzHeaders() {\n\n     var amzHeaders = [];\n\n     AWS.util.each(this.request.headers, function (name) {\n       if (name.match(/^x-amz-/i))\n         amzHeaders.push(name);\n     });\n\n     amzHeaders.sort(function (a, b) {\n       return a.toLowerCase() < b.toLowerCase() ? -1 : 1;\n     });\n\n     var parts = [];\n     AWS.util.arrayEach.call(this, amzHeaders, function (name) {\n       parts.push(name.toLowerCase() + ':' + String(this.request.headers[name]));\n     });\n\n     return parts.join('\\n');\n\n   },\n\n   canonicalizedResource: function canonicalizedResource() {\n\n     var r = this.request;\n\n     var parts = r.path.split('?');\n     var path = parts[0];\n     var querystring = parts[1];\n\n     var resource = '';\n\n     if (r.virtualHostedBucket)\n       resource += '/' + r.virtualHostedBucket;\n\n     resource += path;\n\n     if (querystring) {\n\n       // collect a list of sub resources and query params that need to be signed\n       var resources = [];\n\n       AWS.util.arrayEach.call(this, querystring.split('&'), function (param) {\n         var name = param.split('=')[0];\n         var value = param.split('=')[1];\n         if (this.subResources[name] || this.responseHeaders[name]) {\n           var subresource = { name: name };\n           if (value !== undefined) {\n             if (this.subResources[name]) {\n               subresource.value = value;\n             } else {\n               subresource.value = decodeURIComponent(value);\n             }\n           }\n           resources.push(subresource);\n         }\n       });\n\n       resources.sort(function (a, b) { return a.name < b.name ? -1 : 1; });\n\n       if (resources.length) {\n\n         querystring = [];\n         AWS.util.arrayEach(resources, function (res) {\n           if (res.value === undefined) {\n             querystring.push(res.name);\n           } else {\n             querystring.push(res.name + '=' + res.value);\n           }\n         });\n\n         resource += '?' + querystring.join('&');\n       }\n\n     }\n\n     return resource;\n\n   },\n\n   sign: function sign(secret, string) {\n     return AWS.util.crypto.hmac(secret, string, 'base64', 'sha1');\n   }\n });\n\n /**\n  * @api private\n  */\n module.exports = AWS.Signers.S3;\n\n\n// #endregion ORIGINAL CODE\n\n_cjsExports = module.exports;\n\n\n}, () => ({\n  '../core': _req,\n}));\nexport { _cjsExports as default };\nexport { __cjsMetaURL }\n"]}