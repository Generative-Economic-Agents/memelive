{"version":3,"sources":["file:///Users/feiwang/cutepet/node_modules/aws-sdk/lib/protocol/helpers.js"],"names":["_cjsLoader","_req","__cjsMetaURL","_req0","url","define","exports","require","module","__filename","__dirname","util","AWS","populateHostPrefix","request","enabled","service","config","hostPrefixEnabled","operationModel","api","operations","operation","hasEndpointDiscover","endpoint","hostPrefix","hostPrefixNotation","expandHostPrefix","params","input","prependEndpointPrefix","httpRequest","validateHostname","hostname","isEndpointOperation","endpointOperation","string","lowerFirst","name","endpointDiscoveryRequired","shape","each","members","member","hostLabel","error","Error","message","code","regex","RegExp","replace","prefix","host","labels","split","hostPattern","arrayEach","label","length","test","_cjsExports","_populateHostPrefix"],"mappings":"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","sourcesContent":["import _cjsLoader from 'cce:/internal/ml/cjs-loader.mjs';\nimport { __cjsMetaURL as _req} from '../util';\nimport { __cjsMetaURL as _req0} from '../core';\nlet _cjsExports;\nlet _populateHostPrefix;\nconst __cjsMetaURL = import.meta.url;\n_cjsLoader.define(__cjsMetaURL, function (exports, require, module, __filename, __dirname) {\n// #region ORIGINAL CODE\n\n\n var util =  require('../util');\n var AWS = require('../core');\n\n /**\n  * Prepend prefix defined by API model to endpoint that's already\n  * constructed. This feature does not apply to operations using\n  * endpoint discovery and can be disabled.\n  * @api private\n  */\n function populateHostPrefix(request)  {\n   var enabled = request.service.config.hostPrefixEnabled;\n   if (!enabled) return request;\n   var operationModel = request.service.api.operations[request.operation];\n   //don't marshal host prefix when operation has endpoint discovery traits\n   if (hasEndpointDiscover(request)) return request;\n   if (operationModel.endpoint && operationModel.endpoint.hostPrefix) {\n     var hostPrefixNotation = operationModel.endpoint.hostPrefix;\n     var hostPrefix = expandHostPrefix(hostPrefixNotation, request.params, operationModel.input);\n     prependEndpointPrefix(request.httpRequest.endpoint, hostPrefix);\n     validateHostname(request.httpRequest.endpoint.hostname);\n   }\n   return request;\n }\n\n /**\n  * @api private\n  */\n function hasEndpointDiscover(request) {\n   var api = request.service.api;\n   var operationModel = api.operations[request.operation];\n   var isEndpointOperation = api.endpointOperation && (api.endpointOperation === util.string.lowerFirst(operationModel.name));\n   return (operationModel.endpointDiscoveryRequired !== 'NULL' || isEndpointOperation === true);\n }\n\n /**\n  * @api private\n  */\n function expandHostPrefix(hostPrefixNotation, params, shape) {\n   util.each(shape.members, function(name, member) {\n     if (member.hostLabel === true) {\n       if (typeof params[name] !== 'string' || params[name] === '') {\n         throw util.error(new Error(), {\n           message: 'Parameter ' + name + ' should be a non-empty string.',\n           code: 'InvalidParameter'\n         });\n       }\n       var regex = new RegExp('\\\\{' + name + '\\\\}', 'g');\n       hostPrefixNotation = hostPrefixNotation.replace(regex, params[name]);\n     }\n   });\n   return hostPrefixNotation;\n }\n\n /**\n  * @api private\n  */\n function prependEndpointPrefix(endpoint, prefix) {\n   if (endpoint.host) {\n     endpoint.host = prefix + endpoint.host;\n   }\n   if (endpoint.hostname) {\n     endpoint.hostname = prefix + endpoint.hostname;\n   }\n }\n\n /**\n  * @api private\n  */\n function validateHostname(hostname) {\n   var labels = hostname.split('.');\n   //Reference: https://tools.ietf.org/html/rfc1123#section-2\n   var hostPattern = /^[a-zA-Z0-9]{1}$|^[a-zA-Z0-9][a-zA-Z0-9\\-]*[a-zA-Z0-9]$/;\n   util.arrayEach(labels, function(label) {\n     if (!label.length || label.length < 1 || label.length > 63) {\n       throw util.error(new Error(), {\n         code: 'ValidationError',\n         message: 'Hostname label length should be between 1 to 63 characters, inclusive.'\n       });\n     }\n     if (!hostPattern.test(label)) {\n       throw AWS.util.error(new Error(),\n         {code: 'ValidationError', message: label + ' is not hostname compatible.'});\n     }\n   });\n }\n\n module.exports = {\n   populateHostPrefix: populateHostPrefix\n };\n\n\n// #endregion ORIGINAL CODE\n\n_cjsExports = module.exports;\n_populateHostPrefix = module.exports.populateHostPrefix;\n\n}, () => ({\n  '../util': _req,\n  '../core': _req0,\n}));\nexport { _cjsExports as default };\nexport { __cjsMetaURL }\n"]}