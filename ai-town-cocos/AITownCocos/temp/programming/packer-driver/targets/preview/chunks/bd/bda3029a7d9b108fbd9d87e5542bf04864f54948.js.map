{"version":3,"sources":["file:///Users/feiwang/cutepet/assets/src/module/main/catWork/CatWorkingComponent.ts"],"names":["_decorator","Button","Color","Component","EditBox","Label","Node","Sprite","LoadingController","modelMgr","socket","uiMgr","network","ccclass","property","TAG","currentWorkCostAp","CatWorkingComponent","selectCatId","start","ins","hideLoading","setUserAp","editItemOver","data","addStr","EditBox1","string","length","EditBox2","itemsCombe","console","log","setGoButtonState","interactable","go","getComponent","grayscale","update","deltaTime","catName","apLimit","color","equals","GREEN","catSelectNum","showCatSelectList","currentAp","mainModel","getserItemCountById","toFixed","RED","setPreWorkData","id","energyTxt","earningRate","name","showCatSelectView","catSelectList","active","hideCatSelectView","goToWork","catWorkData","CreateCatWorkCatRequest","catIds","items","sendWebSocketBinary","closeWorkPage","removeParent"],"mappings":"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","sourcesContent":["import { _decorator, Button, Color, ColorKey, Component, EditBox, Label, Node, Sprite } from 'cc';\nimport { LoadingController } from './LoadingController';\nimport { modelMgr, socket, uiMgr } from '../App';\nimport { TAOBAO } from 'cc/env';\nimport { catCfgD } from '../config/DataStruct';\nimport { network } from '../../model/RequestData';\nimport { GlobalConfig } from '../config/GlobalConfig';\nconst { ccclass, property } = _decorator;\n\nconst TAG = 'CatWorkingComponent'\n\nconst currentWorkCostAp = 20\n\n@ccclass('CatWorkingComponent')\nexport class CatWorkingComponent extends Component {\n    @property(Node)\n    catSelectList: Node = null;\n\n    @property(Label)\n    public energyTxt: Label = null;\n\n    @property(Label)\n    public catName: Label = null;\n\n    @property(Label)\n    public itemsCombe: Label = null;\n\n    @property(Label)\n    public apLimit: Label = null;\n\n    @property(Label)\n    public catSelectNum: Label = null;\n\n\n    @property(EditBox)\n    public EditBox1: Label = null;\n\n    @property(EditBox)\n    public EditBox2: Label = null;\n\n    @property(Node)\n    public go: Node = null;\n    selectCatId: number;\n\n    start() {\n        LoadingController.ins.hideLoading();\n        this.setUserAp()\n    }\n\n\n    editItemOver(data: any){\n        const addStr = (this.EditBox1.string.length && this.EditBox2.string.length) ? ' + ' : '';\n        (this.EditBox1.string.length || this.EditBox2.string.length) && (this.itemsCombe.string = `${this.EditBox1.string}${addStr}${this.EditBox2.string}`)\n        console.log(TAG, data)\n    }\n\n\n    setGoButtonState(interactable: boolean){\n        this.go.getComponent(Button).interactable = interactable\n        this.go.getComponent(Sprite).grayscale = !interactable\n    }\n\n    update(deltaTime: number) {\n        if((this.EditBox1.string.length || this.EditBox2.string.length) && this.catName.string.length && this.apLimit.color.equals(Color.GREEN)){\n            this.setGoButtonState(true)\n        }else{\n            this.setGoButtonState(false)\n        }\n        if(this.catName.string.length){\n            this.catSelectNum.string = '1/1'\n        }else{\n            this.catSelectNum.string = '0/1'\n        }\n    }\n\n    showCatSelectList(){\n        \n    }\n\n    setUserAp(){\n        const currentAp = modelMgr.mainModel.getserItemCountById(10101002).toFixed(0)\n        this.apLimit.string = `${currentAp}/20`\n        if(currentAp < currentAp){\n            this.apLimit.color = new Color(Color.RED)\n            this.setGoButtonState(false)\n        }else{\n            this.apLimit.color = new Color(Color.GREEN)\n        }\n        \n    }\n\n    setPreWorkData(data: catCfgD){\n        this.selectCatId = data.id\n        this.energyTxt.string = data.earningRate.toFixed(0)\n        this.catName.string = data.name\n        console.log(TAG, 'setPreWorkData')\n    }\n\n    showCatSelectView(){\n        this.catSelectList.active = true\n    }\n\n    hideCatSelectView(){\n        this.catSelectList.active = false\n    }\n\n    goToWork(){\n        if(this.selectCatId && (this.EditBox1.string.length || this.EditBox2.string.length)){\n            let catWorkData = new network.CreateCatWorkCatRequest\n            catWorkData.data.catIds = [this.selectCatId]\n            catWorkData.data.items = [this.EditBox1.string, this.EditBox2.string]\n            socket.sendWebSocketBinary(catWorkData)\n        }\n\n    }\n\n\n\n    closeWorkPage(){\n        uiMgr.removeParent(\"prefabs/pre_cat_working\");\n    }\n}\n\n"]}