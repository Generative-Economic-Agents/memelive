{"version":3,"sources":["file:///Users/feiwang/AITown/AITownCocos/assets/src/module/TabGroup.ts"],"names":["_decorator","Component","Node","Button","observer","EventType","ccclass","property","TabGroup","type","String","start","node","on","TOUCH_END","_onTouchEnd","TOUCH_CANCEL","touchEvent","update","deltaTime","disable_tab","index","tabbtns","getComponent","interactable","getChildByName","active","tabcontents","enable_tab","emit","on_tab_button_click","e","parseInt","i","length","refresh_tab_content","post","UPDATE_ROLE_PLAY_INDEX","chgTab","ind","setShowTab","tabIndex","needShow","resetAllTabs"],"mappings":"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","sourcesContent":["import { _decorator, Component, Node, Button, EventTouch } from 'cc';\nimport { modelMgr, observer } from '../game/App';\nimport { EventType } from '../EventType';\nimport { AudioManager } from '../manager/AudioManager';\nconst { ccclass, property } = _decorator;\n\n@ccclass('TabGroup')\nexport class TabGroup extends Component {\n    @property({ type: [Node] })\n    public tabbtns: Node[] = [];\n    @property({ type: [Node] })\n    public tabcontents: Node[] = [];\n    @property(String)\n    public tabtype: string = \"\";\n    start() {\n        //记录打开当前页index,即使被销毁后\n        //this.on_tab_button_click(null, modelMgr.mainModel.currentTapIndex[this.tabtype]);\n        this.node.on(Node.EventType.TOUCH_END, this._onTouchEnd, this);\n        this.node.on(Node.EventType.TOUCH_CANCEL, this._onTouchEnd, this);\n        // for (let index = 0; index <  this.tabbtns.length; index++) {\n        //     const element =  this.tabbtns[index];\n        //     if(!element.hasEventListener(Button.EventType.CLICK,this.on_tab_button_click,this)){\n        //         element.on(Button.EventType.CLICK,this.on_tab_button_click,this);\n        //     }\n        // }\n\n    }\n    _onTouchEnd(touchEvent: EventTouch) {\n    }\n    update(deltaTime: number) {\n\n    }\n    private disable_tab(index: any) {\n        if (this.tabbtns[index]) {\n            this.tabbtns[index].getComponent(Button).interactable = true;\n            this.tabbtns[index].getChildByName(\"on\").active = false;\n            this.tabbtns[index].getChildByName(\"off\").active = true;\n            this.tabcontents[index].active = false;\n        }\n\n\n\n    };\n    private enable_tab(index) {\n        if (this.tabbtns[index]) {\n            this.tabbtns[index].getComponent(Button).interactable = false;//禁用,已处于点击状态\n            this.tabbtns[index].getChildByName(\"on\").active = true;\n            this.tabbtns[index].getChildByName(\"off\").active = false;\n            this.tabcontents[index].active = true;\n            //modelMgr.mainModel.currentTapIndex[this.tabtype] = index;\n            this.node.emit(\"update_tab_content\", this.tabcontents[index]);\n        }\n\n    };\n    private on_tab_button_click(e, index) {\n        //AudioManager.instance.playSound(\"new_NormanBtn\");\n        index = parseInt(index);\n        for (let i = 0; i < this.tabbtns.length; i++) {\n            if (i == index) {\n                // this.enable_tab(i);\n            }\n            else {\n                this.disable_tab(i);\n            }\n        }\n        //支持操作同一个content\n        if (this.tabbtns[index]) {\n            this.enable_tab(index);\n            this.node.emit(\"tabgroupeclick\", index);\n        }\n\n    }\n\n    private refresh_tab_content(e, index){\n        index = parseInt(index);\n        for (let i = 0; i < this.tabbtns.length; i++) {\n            if (i == index) {\n                // this.enable_tab(i);\n            }\n            else {\n                if (this.tabbtns[i]) {\n                    this.tabbtns[i].getComponent(Button).interactable = true;\n                    this.tabbtns[i].getChildByName(\"on\").active = false;\n                    this.tabbtns[i].getChildByName(\"off\").active = true;\n                }\n            }\n        }\n        //支持操作同一个content\n        if (this.tabbtns[index]) {\n            //this.enable_tab(index);\n            if (this.tabbtns[index]) {\n                this.tabbtns[index].getComponent(Button).interactable = false;//禁用,已处于点击状态\n                this.tabbtns[index].getChildByName(\"on\").active = true;\n                this.tabbtns[index].getChildByName(\"off\").active = false;\n                //this.tabcontents[index].active = true;\n                //modelMgr.mainModel.currentTapIndex[this.tabtype] = index;\n            }\n        }\n        observer.post(EventType.UPDATE_ROLE_PLAY_INDEX, index + 1)\n    }\n\n    /**\n     * 外部改变tabgroup\n     * @param ind \n     */\n    public chgTab(ind) {\n        this.on_tab_button_click(null, ind);\n    }\n    /**\n     * 显示/隐藏某个tab\n     * @param tabIndex \n     * @param needShow \n     */\n    public setShowTab(tabIndex: number, needShow: boolean) {\n        if (this.tabbtns[tabIndex]) {\n            this.tabbtns[tabIndex].active = needShow;\n            if (this.tabcontents[tabIndex].active) {\n                if (tabIndex == 0) {\n                    this.on_tab_button_click(null, tabIndex + 1);\n                } else {\n                    this.on_tab_button_click(null, 0);\n                }\n\n            }\n        }\n    }\n\n    /**\n     * 隐藏所有tabs\n     */\n    public resetAllTabs() {\n        for (let i = 0; i < this.tabbtns.length; i++) {\n            this.disable_tab(i);\n        }\n        ///modelMgr.mainModel.currentTapIndex[this.tabtype] = -1;\n    }\n\n}\n\n/**\n * \n */"]}