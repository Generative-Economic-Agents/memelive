{"version":3,"sources":["file:///Users/feiwang/cutepet/node_modules/sshpk/lib/formats/auto.js"],"names":["_cjsLoader","_req","__cjsMetaURL","_req0","_req1","_req2","_req3","_req4","_req5","_req6","_req7","_req8","url","define","exports","require","module","__filename","__dirname","read","write","assert","Buffer","utils","Key","PrivateKey","pem","ssh","rfc4253","dnssec","putty","DNSSEC_PRIVKEY_HEADER_PREFIX","buf","options","trim","match","findDNSSECHeader","from","buffer","findPEMHeader","findSSHHeader","findPuTTYHeader","readUInt32BE","length","Error","offset","slice","toString","toLowerCase","headerCheck","lines","split","line","key","_cjsExports","_read","_write"],"mappings":"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","sourcesContent":["import _cjsLoader from 'cce:/internal/ml/cjs-loader.mjs';\nimport { __cjsMetaURL as _req} from 'assert-plus';\nimport { __cjsMetaURL as _req0} from 'safer-buffer';\nimport { __cjsMetaURL as _req1} from '../utils';\nimport { __cjsMetaURL as _req2} from '../key';\nimport { __cjsMetaURL as _req3} from '../private-key';\nimport { __cjsMetaURL as _req4} from './pem';\nimport { __cjsMetaURL as _req5} from './ssh';\nimport { __cjsMetaURL as _req6} from './rfc4253';\nimport { __cjsMetaURL as _req7} from './dnssec';\nimport { __cjsMetaURL as _req8} from './putty';\nlet _cjsExports;\nlet _read;\nlet _write;\nconst __cjsMetaURL = import.meta.url;\n_cjsLoader.define(__cjsMetaURL, function (exports, require, module, __filename, __dirname) {\n// #region ORIGINAL CODE\n\n\n // Copyright 2018 Joyent, Inc.\n\n module.exports = {\n \tread: read,\n \twrite: write\n };\n\n var assert = require('assert-plus');\n var Buffer = require('safer-buffer').Buffer;\n var utils = require('../utils');\n var Key = require('../key');\n var PrivateKey = require('../private-key');\n\n var pem = require('./pem');\n var ssh = require('./ssh');\n var rfc4253 = require('./rfc4253');\n var dnssec = require('./dnssec');\n var putty = require('./putty');\n\n var DNSSEC_PRIVKEY_HEADER_PREFIX = 'Private-key-format: v1';\n\n function read(buf, options) {\n \tif (typeof (buf) === 'string') {\n \t\tif (buf.trim().match(/^[-]+[ ]*BEGIN/))\n \t\t\treturn (pem.read(buf, options));\n \t\tif (buf.match(/^\\s*ssh-[a-z]/))\n \t\t\treturn (ssh.read(buf, options));\n \t\tif (buf.match(/^\\s*ecdsa-/))\n \t\t\treturn (ssh.read(buf, options));\n \t\tif (buf.match(/^putty-user-key-file-2:/i))\n \t\t\treturn (putty.read(buf, options));\n \t\tif (findDNSSECHeader(buf))\n \t\t\treturn (dnssec.read(buf, options));\n \t\tbuf = Buffer.from(buf, 'binary');\n \t} else {\n \t\tassert.buffer(buf);\n \t\tif (findPEMHeader(buf))\n \t\t\treturn (pem.read(buf, options));\n \t\tif (findSSHHeader(buf))\n \t\t\treturn (ssh.read(buf, options));\n \t\tif (findPuTTYHeader(buf))\n \t\t\treturn (putty.read(buf, options));\n \t\tif (findDNSSECHeader(buf))\n \t\t\treturn (dnssec.read(buf, options));\n \t}\n \tif (buf.readUInt32BE(0) < buf.length)\n \t\treturn (rfc4253.read(buf, options));\n \tthrow (new Error('Failed to auto-detect format of key'));\n }\n\n function findPuTTYHeader(buf) {\n \tvar offset = 0;\n \twhile (offset < buf.length &&\n \t    (buf[offset] === 32 || buf[offset] === 10 || buf[offset] === 9))\n \t\t++offset;\n \tif (offset + 22 <= buf.length &&\n \t    buf.slice(offset, offset + 22).toString('ascii').toLowerCase() ===\n \t    'putty-user-key-file-2:')\n \t\treturn (true);\n \treturn (false);\n }\n\n function findSSHHeader(buf) {\n \tvar offset = 0;\n \twhile (offset < buf.length &&\n \t    (buf[offset] === 32 || buf[offset] === 10 || buf[offset] === 9))\n \t\t++offset;\n \tif (offset + 4 <= buf.length &&\n \t    buf.slice(offset, offset + 4).toString('ascii') === 'ssh-')\n \t\treturn (true);\n \tif (offset + 6 <= buf.length &&\n \t    buf.slice(offset, offset + 6).toString('ascii') === 'ecdsa-')\n \t\treturn (true);\n \treturn (false);\n }\n\n function findPEMHeader(buf) {\n \tvar offset = 0;\n \twhile (offset < buf.length &&\n \t    (buf[offset] === 32 || buf[offset] === 10))\n \t\t++offset;\n \tif (buf[offset] !== 45)\n \t\treturn (false);\n \twhile (offset < buf.length &&\n \t    (buf[offset] === 45))\n \t\t++offset;\n \twhile (offset < buf.length &&\n \t    (buf[offset] === 32))\n \t\t++offset;\n \tif (offset + 5 > buf.length ||\n \t    buf.slice(offset, offset + 5).toString('ascii') !== 'BEGIN')\n \t\treturn (false);\n \treturn (true);\n }\n\n function findDNSSECHeader(buf) {\n \t// private case first\n \tif (buf.length <= DNSSEC_PRIVKEY_HEADER_PREFIX.length)\n \t\treturn (false);\n \tvar headerCheck = buf.slice(0, DNSSEC_PRIVKEY_HEADER_PREFIX.length);\n \tif (headerCheck.toString('ascii') === DNSSEC_PRIVKEY_HEADER_PREFIX)\n \t\treturn (true);\n\n \t// public-key RFC3110 ?\n \t// 'domain.com. IN KEY ...' or 'domain.com. IN DNSKEY ...'\n \t// skip any comment-lines\n \tif (typeof (buf) !== 'string') {\n \t\tbuf = buf.toString('ascii');\n \t}\n \tvar lines = buf.split('\\n');\n \tvar line = 0;\n \t/* JSSTYLED */\n \twhile (lines[line].match(/^\\;/))\n \t\tline++;\n \tif (lines[line].toString('ascii').match(/\\. IN KEY /))\n \t\treturn (true);\n \tif (lines[line].toString('ascii').match(/\\. IN DNSKEY /))\n \t\treturn (true);\n \treturn (false);\n }\n\n function write(key, options) {\n \tthrow (new Error('\"auto\" format cannot be used for writing'));\n }\n\n\n// #endregion ORIGINAL CODE\n\n_cjsExports = module.exports;\n_read = module.exports.read;\n_write = module.exports.write;\n\n}, () => ({\n  'assert-plus': _req,\n  'safer-buffer': _req0,\n  '../utils': _req1,\n  '../key': _req2,\n  '../private-key': _req3,\n  './pem': _req4,\n  './ssh': _req5,\n  './rfc4253': _req6,\n  './dnssec': _req7,\n  './putty': _req8,\n}));\nexport { _cjsExports as default };\nexport { __cjsMetaURL }\n"]}