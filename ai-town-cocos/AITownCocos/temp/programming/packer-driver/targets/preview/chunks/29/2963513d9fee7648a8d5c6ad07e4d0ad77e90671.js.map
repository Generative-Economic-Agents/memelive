{"version":3,"sources":["file:///Users/feiwang/cutepet/node_modules/aws-sdk/lib/signers/v4.js"],"names":["_cjsLoader","_req","__cjsMetaURL","_req0","url","define","exports","require","module","__filename","__dirname","AWS","v4Credentials","inherit","util","expiresHeader","Signers","V4","RequestSigner","constructor","request","serviceName","options","call","signatureCache","operation","signatureVersion","algorithm","addAuthorization","credentials","date","datetime","iso8601","replace","isPresigned","updateForPresigned","addHeaders","headers","authorization","sessionToken","credString","credentialString","qs","accessKeyId","signedHeaders","each","key","value","isSignableHeader","lowerKey","toLowerCase","indexOf","sep","path","queryParamsToString","parts","push","signature","join","signingKey","getSigningKey","substr","region","crypto","hmac","stringToSign","hexEncodedHash","canonicalString","pathname","uriEscapePath","method","search","canonicalHeaders","hexEncodedBodyHash","item","sort","a","b","arrayEach","toString","error","Error","code","canonicalHeaderValues","values","keys","createScope","hash","string","sha256","body","unsignableHeaders","_cjsExports"],"mappings":"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","sourcesContent":["import _cjsLoader from 'cce:/internal/ml/cjs-loader.mjs';\nimport { __cjsMetaURL as _req} from '../core';\nimport { __cjsMetaURL as _req0} from './v4_credentials';\nlet _cjsExports;\nconst __cjsMetaURL = import.meta.url;\n_cjsLoader.define(__cjsMetaURL, function (exports, require, module, __filename, __dirname) {\n// #region ORIGINAL CODE\n\n\n var AWS = require('../core');\n var v4Credentials = require('./v4_credentials');\n var inherit = AWS.util.inherit;\n\n /**\n  * @api private\n  */\n var expiresHeader = 'presigned-expires';\n\n /**\n  * @api private\n  */\n AWS.Signers.V4 = inherit(AWS.Signers.RequestSigner, {\n   constructor: function V4(request, serviceName, options) {\n     AWS.Signers.RequestSigner.call(this, request);\n     this.serviceName = serviceName;\n     options = options || {};\n     this.signatureCache = typeof options.signatureCache === 'boolean' ? options.signatureCache : true;\n     this.operation = options.operation;\n     this.signatureVersion = options.signatureVersion;\n   },\n\n   algorithm: 'AWS4-HMAC-SHA256',\n\n   addAuthorization: function addAuthorization(credentials, date) {\n     var datetime = AWS.util.date.iso8601(date).replace(/[:\\-]|\\.\\d{3}/g, '');\n\n     if (this.isPresigned()) {\n       this.updateForPresigned(credentials, datetime);\n     } else {\n       this.addHeaders(credentials, datetime);\n     }\n\n     this.request.headers['Authorization'] =\n       this.authorization(credentials, datetime);\n   },\n\n   addHeaders: function addHeaders(credentials, datetime) {\n     this.request.headers['X-Amz-Date'] = datetime;\n     if (credentials.sessionToken) {\n       this.request.headers['x-amz-security-token'] = credentials.sessionToken;\n     }\n   },\n\n   updateForPresigned: function updateForPresigned(credentials, datetime) {\n     var credString = this.credentialString(datetime);\n     var qs = {\n       'X-Amz-Date': datetime,\n       'X-Amz-Algorithm': this.algorithm,\n       'X-Amz-Credential': credentials.accessKeyId + '/' + credString,\n       'X-Amz-Expires': this.request.headers[expiresHeader],\n       'X-Amz-SignedHeaders': this.signedHeaders()\n     };\n\n     if (credentials.sessionToken) {\n       qs['X-Amz-Security-Token'] = credentials.sessionToken;\n     }\n\n     if (this.request.headers['Content-Type']) {\n       qs['Content-Type'] = this.request.headers['Content-Type'];\n     }\n     if (this.request.headers['Content-MD5']) {\n       qs['Content-MD5'] = this.request.headers['Content-MD5'];\n     }\n     if (this.request.headers['Cache-Control']) {\n       qs['Cache-Control'] = this.request.headers['Cache-Control'];\n     }\n\n     // need to pull in any other X-Amz-* headers\n     AWS.util.each.call(this, this.request.headers, function(key, value) {\n       if (key === expiresHeader) return;\n       if (this.isSignableHeader(key)) {\n         var lowerKey = key.toLowerCase();\n         // Metadata should be normalized\n         if (lowerKey.indexOf('x-amz-meta-') === 0) {\n           qs[lowerKey] = value;\n         } else if (lowerKey.indexOf('x-amz-') === 0) {\n           qs[key] = value;\n         }\n       }\n     });\n\n     var sep = this.request.path.indexOf('?') >= 0 ? '&' : '?';\n     this.request.path += sep + AWS.util.queryParamsToString(qs);\n   },\n\n   authorization: function authorization(credentials, datetime) {\n     var parts = [];\n     var credString = this.credentialString(datetime);\n     parts.push(this.algorithm + ' Credential=' +\n       credentials.accessKeyId + '/' + credString);\n     parts.push('SignedHeaders=' + this.signedHeaders());\n     parts.push('Signature=' + this.signature(credentials, datetime));\n     return parts.join(', ');\n   },\n\n   signature: function signature(credentials, datetime) {\n     var signingKey = v4Credentials.getSigningKey(\n       credentials,\n       datetime.substr(0, 8),\n       this.request.region,\n       this.serviceName,\n       this.signatureCache\n     );\n     return AWS.util.crypto.hmac(signingKey, this.stringToSign(datetime), 'hex');\n   },\n\n   stringToSign: function stringToSign(datetime) {\n     var parts = [];\n     parts.push('AWS4-HMAC-SHA256');\n     parts.push(datetime);\n     parts.push(this.credentialString(datetime));\n     parts.push(this.hexEncodedHash(this.canonicalString()));\n     return parts.join('\\n');\n   },\n\n   canonicalString: function canonicalString() {\n     var parts = [], pathname = this.request.pathname();\n     if (this.serviceName !== 's3' && this.signatureVersion !== 's3v4') pathname = AWS.util.uriEscapePath(pathname);\n\n     parts.push(this.request.method);\n     parts.push(pathname);\n     parts.push(this.request.search());\n     parts.push(this.canonicalHeaders() + '\\n');\n     parts.push(this.signedHeaders());\n     parts.push(this.hexEncodedBodyHash());\n     return parts.join('\\n');\n   },\n\n   canonicalHeaders: function canonicalHeaders() {\n     var headers = [];\n     AWS.util.each.call(this, this.request.headers, function (key, item) {\n       headers.push([key, item]);\n     });\n     headers.sort(function (a, b) {\n       return a[0].toLowerCase() < b[0].toLowerCase() ? -1 : 1;\n     });\n     var parts = [];\n     AWS.util.arrayEach.call(this, headers, function (item) {\n       var key = item[0].toLowerCase();\n       if (this.isSignableHeader(key)) {\n         var value = item[1];\n         if (typeof value === 'undefined' || value === null || typeof value.toString !== 'function') {\n           throw AWS.util.error(new Error('Header ' + key + ' contains invalid value'), {\n             code: 'InvalidHeader'\n           });\n         }\n         parts.push(key + ':' +\n           this.canonicalHeaderValues(value.toString()));\n       }\n     });\n     return parts.join('\\n');\n   },\n\n   canonicalHeaderValues: function canonicalHeaderValues(values) {\n     return values.replace(/\\s+/g, ' ').replace(/^\\s+|\\s+$/g, '');\n   },\n\n   signedHeaders: function signedHeaders() {\n     var keys = [];\n     AWS.util.each.call(this, this.request.headers, function (key) {\n       key = key.toLowerCase();\n       if (this.isSignableHeader(key)) keys.push(key);\n     });\n     return keys.sort().join(';');\n   },\n\n   credentialString: function credentialString(datetime) {\n     return v4Credentials.createScope(\n       datetime.substr(0, 8),\n       this.request.region,\n       this.serviceName\n     );\n   },\n\n   hexEncodedHash: function hash(string) {\n     return AWS.util.crypto.sha256(string, 'hex');\n   },\n\n   hexEncodedBodyHash: function hexEncodedBodyHash() {\n     var request = this.request;\n     if (this.isPresigned() && (['s3', 's3-object-lambda'].indexOf(this.serviceName) > -1) && !request.body) {\n       return 'UNSIGNED-PAYLOAD';\n     } else if (request.headers['X-Amz-Content-Sha256']) {\n       return request.headers['X-Amz-Content-Sha256'];\n     } else {\n       return this.hexEncodedHash(this.request.body || '');\n     }\n   },\n\n   unsignableHeaders: [\n     'authorization',\n     'content-type',\n     'content-length',\n     'user-agent',\n     expiresHeader,\n     'expect',\n     'x-amzn-trace-id'\n   ],\n\n   isSignableHeader: function isSignableHeader(key) {\n     if (key.toLowerCase().indexOf('x-amz-') === 0) return true;\n     return this.unsignableHeaders.indexOf(key) < 0;\n   },\n\n   isPresigned: function isPresigned() {\n     return this.request.headers[expiresHeader] ? true : false;\n   }\n\n });\n\n /**\n  * @api private\n  */\n module.exports = AWS.Signers.V4;\n\n\n// #endregion ORIGINAL CODE\n\n_cjsExports = module.exports;\n\n\n}, () => ({\n  '../core': _req,\n  './v4_credentials': _req0,\n}));\nexport { _cjsExports as default };\nexport { __cjsMetaURL }\n"]}