{"version":3,"sources":["file:///Users/feiwang/AITown/AITownCocos/assets/src/login/RolePartListItem.ts"],"names":["_decorator","Component","Node","WebUtils","Log","observer","EventType","loginModel","ccclass","property","TAG","RolePartListItem","_da","start","node","on","updateData","CHANGE_ROLE_PART_SELECT","refreshRolePart","update","deltaTime","onDestroy","off","SOCKET_ONOPEN","da","setScale","icon","active","getResouceImg","icon_path","currentType","iconValue","log","clickHandler","evt","clickSelect","post","id","roleValue","frame_path","npc","getChildByName","currentName","townNPCPlayer"],"mappings":"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","sourcesContent":["import { _decorator, Component, Label, Node, Sprite } from 'cc';\nimport { AudioManager } from '../manager/AudioManager';\nimport { ToysInfo } from '../model/StaticTextConfig';\nimport WebUtils from '../utils/WebUtils';\nimport  Log  from '../../src/utils/LogUtils'\nimport { observer } from '../game/App';\nimport { EventType } from '../EventType';\nimport loginModel from '../model/loginModel';\nconst { ccclass, property } = _decorator;\n\nconst TAG = 'RolePartListItem'\n\n@ccclass('RolePartListItem')\nexport class RolePartListItem extends Component {\n\n    @property(Node)\n    public on:Node = null;\n\n    @property(Node)\n    public off:Node = null;\n\n    @property(Node)\n    public icon:Node = null;\n\n    @property(Node)\n    public npc:Node = null;\n\n    @property(Node)\n    public townNPCPlayer:Node = null;\n\n    public _da;\n    start() {\n        this.node.on(\"update_data\", this.updateData, this);\n        observer.on(EventType.CHANGE_ROLE_PART_SELECT, this.refreshRolePart, this)\n        \n    }\n\n    update(deltaTime: number) {\n\n    }\n    protected onDestroy(): void {\n        this.node.off(\"update_data\", this.updateData, this);\n        observer.off(EventType.SOCKET_ONOPEN, this.refreshRolePart, this);\n    }\n    /**\n    * 视图更新\n    * @param da \n    */\n    public updateData(da: any) {\n        this._da = da;\n        this.node.setScale(1,1)\n        if (this._da) {\n            this.icon.active = true\n            WebUtils.getResouceImg(da.icon_path, this.icon);\n            if(da.icon_path === loginModel.currentType.iconValue){\n                this.on.active = true\n            }\n            Log.log(TAG, da, loginModel)\n        }\n    }\n\n    /**\n     * 切换购买道具\n     * @param evt \n     * @param da \n     * @returns \n     */\n    public clickHandler(evt, da) {\n        // AudioManager.instance.playSound(\"new_NormanBtn\");\n        // if (this._da) {\n        //     this.buy_page.active = true\n        //     this.buy_page.getComponent(ShopPurchaseComponent).setItemData(this._da)\n\n        // }\n        // Log.log(TAG, 'click', this._da)\n    }\n\n    refreshRolePart(){\n        this.on.active = false\n    }\n\n    clickSelect(){\n        observer.post(EventType.CHANGE_ROLE_PART_SELECT)\n        loginModel.currentType.id = this._da.id\n        loginModel.currentType.iconValue = this._da.icon_path\n        loginModel.currentType.roleValue = this._da.frame_path\n        WebUtils.getResouceImg(this._da.frame_path, this.npc.getChildByName(loginModel.currentName))\n        WebUtils.getResouceImg(this._da.frame_path, this.townNPCPlayer.getChildByName(loginModel.currentName))\n        this.on.active = true\n    }\n\n}\n\n"]}