{"version":3,"sources":["file:///Users/feiwang/workSpace/AITown/cutepet/assets/src/module/main/jishi/GoumaiItem.ts"],"names":["_decorator","Component","Node","Label","showMsg2","modelMgr","uiMgr","LoadingController","DataEvents","StringUtils","WebUtils","JishiGoumaiTK","Log","ccclass","property","TAG","GoumaiItem","String","_da","isSelectShow","isSelect","start","node","on","updateData","onDestroy","off","onEnable","EventType","TOUCH_END","touchEndHandler","jishiModel","UPDATE_JISHI_SHOP","freshShopData","UPDATE_JISHI_STORE","freshData","onDisable","update","deltaTime","setXiangou","spr_xiangou","bg","getChildByName","label","bgres","restrict","active","getResouceImg","getComponent","string","quanta","quota","setGray","setSelcet","da","oprType","hasPlSelect","spr_select","data","from","ind","hasSelectData","indexOf","splice","push","subType","flash","dimension","shoujia","buyPrice","chiyou","amount","unlockLevel","mainModel","userinfo","level","Sprite_jiesuo","Label_jiesuo","salePrice","spr_flash","Boolean","icon","console","warn","getRemoteImg","itempic","Label_name","name","evt","sell","log","DATA","ins","showLoading","popToParent"],"mappings":"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","sourcesContent":["import { _decorator, Component, Node, Label } from 'cc';\nimport { showMsg2 } from '../../../core/message/MessageManager';\nimport { EventType } from '../../../EventType';\nimport { modelMgr, observer, uiMgr } from '../../../game/App';\nimport { LoadingController } from '../../../game/components/LoadingController';\nimport { DataEvents } from '../../../model/DataEvents';\nimport StringUtils from '../../../utils/StringUtils';\nimport WebUtils from '../../../utils/WebUtils';\nimport { JishiGoumaiTK } from './JishiGoumaiTK';\nimport Log from '../../../../../assets/src/utils/LogUtils'\nconst { ccclass, property } = _decorator;\nconst TAG = 'GoumaiItem'\n/**\n * 道具item\n */\n@ccclass('GoumaiItem')\nexport class GoumaiItem extends Component {\n    @property(String)\n    public oprType: string = \"\"; \n    @property(Node)\n    public itempic: Node = null;\n    @property(Label)\n    public chiyou: Label = null;\n\n    @property(Label)\n    public shoujia: Label = null;\n    @property(Node)\n    public spr_select: Node = null;\n    @property(Node)\n    public Sprite_jiesuo: Node = null;\n    @property(Label)\n    public Label_jiesuo: Label = null;\n    @property(Label)\n    public Label_name: Label = null;\n    @property(Node)\n    public spr_flash: Node = null;\n    private _da;\n    isSelectShow: boolean;\n    @property(Node)\n    public spr_xiangou: Node = null;\n    start() {\n        this.node.on(\"update_data\", this.updateData, this);\n\n\n    }\n    onDestroy() {\n        this.node.off(\"update_data\", this.updateData, this);\n       \n\n    }\n\n    onEnable(){\n        this.node.on(Node.EventType.TOUCH_END, this.touchEndHandler, this);\n        this.node.on(\"update_data\", this.updateData, this);\n        // observer.on(EventType.CHOUSHOU_ITEM_SELECTSTATE, this.setSelcet, this);\n        modelMgr.jishiModel.on(DataEvents.UPDATE_JISHI_SHOP, this.freshShopData, this);\n        modelMgr.jishiModel.on(DataEvents.UPDATE_JISHI_STORE, this.freshData, this)\n    }\n\n    onDisable(){\n        this.node.off(Node.EventType.TOUCH_END, this.touchEndHandler, this);\n        this.node.off(\"update_data\", this.updateData, this);\n        // observer.off(EventType.CHOUSHOU_ITEM_SELECTSTATE, this.setSelcet, this);\n        modelMgr.jishiModel.off(DataEvents.UPDATE_JISHI_SHOP, this.freshShopData, this);\n        modelMgr.jishiModel.off(DataEvents.UPDATE_JISHI_STORE, this.freshData, this);\n    }\n    update(deltaTime: number) {\n\n    }\n      /**\n     * 设置限购\n     */\n       public setXiangou() {\n        // \"restrict\": 0, //限购类型(0:不限购|1:每日限购|2:每周限购|3:每月限购|4:赛季限购)\n        // \"quota\": 0, //限购数量\n        // \"sale\": false, //是否可卖(已达到限购数量)\n        if (!this.spr_xiangou) {\n            return; \n        }\n        let bg = this.spr_xiangou.getChildByName(\"Sprite_bg\");\n        let label = this.spr_xiangou.getChildByName(\"Label_num\");\n        let bgres = \"\";\n        switch (this._da.restrict) {\n            case 0:\n                this.spr_xiangou.active = false;\n                break;\n            case 1:\n                this.spr_xiangou.active = true;\n                bgres = \"newjishi/xiangou_1\";\n                break;\n            case 2:\n                this.spr_xiangou.active = true;\n                bgres = \"newjishi/xiangou_3\";\n                break;\n            case 3:\n                this.spr_xiangou.active = true;\n                bgres = \"newjishi/xiangou_2\";\n                break;\n            case 4:\n                this.spr_xiangou.active = false;\n                break;\n            default:\n                this.spr_xiangou.active = false;\n                break;\n        }\n        if(this.spr_xiangou.active&&bgres){\n            WebUtils.getResouceImg(bgres, bg);\n            label.getComponent(Label).string = this._da.quanta + \"/\" + this._da.quota;\n            if (this._da.quanta >= this._da.quota) {\n                StringUtils.setGray(this.node, 1);\n            } else {\n                StringUtils.setGray(this.node, 0);\n            }\n        }\n    }\n    public isSelect: boolean;\n    public setSelcet(da) {\n        if (this.oprType == \"chushou\") {\n\n\n            if (modelMgr.jishiModel.hasPlSelect) {\n                this.isSelectShow = true;\n            } else {\n                this.isSelectShow = false;\n            }\n            this.spr_select.active = this.isSelectShow;\n\n\n            \n            if(da.data.from ==\"self\"){\n                this.isSelect = da.data.isSelect;\n                if (this.isSelect) {\n                    WebUtils.getResouceImg(\"newjishi/select\", this.spr_select);\n                } else {\n                    WebUtils.getResouceImg(\"newjishi/unselect\", this.spr_select);\n                }\n            }\n\n            let ind = modelMgr.jishiModel.hasSelectData.indexOf(this._da);\n            if (!this.isSelect) {\n                if (ind >= 0) {\n                    modelMgr.jishiModel.hasSelectData.splice(ind, 1);\n                }\n            } else if(this.isSelect&&da.data.from ==\"self\"){\n                modelMgr.jishiModel.hasSelectData.push(this._da);\n            }\n        }\n    }\n    /**\n     * 出售刷新\n     * @param da \n     */\n    public freshData(da) {\n        if (da && da.data) {\n            if (this._da && this._da.subType == da.data.subType && this._da.flash == da.data.flash)\n                this._da = da.data;\n                this.updateData(this._da);\n        }\n    }\n        /**\n     * 购买\n     * @param da \n     */\n         public freshShopData(da) {\n            if (da && da.data) {\n                if (this._da&&this._da.subType && this._da.subType == da.data.subType && this._da.dimension)//dimension 确认是种子\n                    this._da = da.data;// 添加后,刷新出现item 丢失 \n                    this.updateData(this._da);\n            }\n        }\n    /**\n     * 刷新视图\n     * @param da \n     */\n    public updateData(da) {\n        this._da = da;\n        if (this._da) {\n            if (this.oprType == \"goumai\") {\n                this.shoujia.string = this._da.buyPrice + \"\";\n                this.chiyou.string =\"持有:\" + this._da.amount + \"\";\n                if (this._da.unlockLevel > modelMgr.mainModel.userinfo.level) {\n                    this.Sprite_jiesuo.active = true;\n                    this.Label_jiesuo.string = this._da.unlockLevel + \"级解锁\";\n                } else {\n                    this.Sprite_jiesuo.active = false;\n                }\n                this.setXiangou();\n            } else if (this.oprType == \"chushou\") {\n                this.shoujia.string = this._da.salePrice + \"\";\n                this.chiyou.string =\"持有:\" + this._da.amount + \"\";\n                this.spr_flash.active = Boolean(this._da.flash);\n                this.setSelcet({ data: { isSelect: false } });//每次更新数据都要重置选择\n\n            }\n            this.node.active = true;\n            if (!this._da.icon) {\n                console.warn(\"没有图片:\", this._da);\n            }else{\n                WebUtils.getRemoteImg(this._da.icon + \"?imageView&thumbnail=162x191\", this.itempic);\n            }\n            this.Label_name.string = this._da.name;\n\n        } else {\n            this.node.active = false;\n        }\n\n    }\n    /**\n     * \n     * @param evt \n     */\n    private touchEndHandler(evt: TouchEvent) {\n\n        if (this.oprType == \"goumai\") {\n            // if (this._da.unlockLevel > modelMgr.mainModel.userinfo.level) {\n            //     showMsg2(\"等级不足，不能购买未解锁的商品\");\n            //     return;\n            // }\n            if (this._da.quota!=0&&this._da.quanta >= this._da.quota) {\n                showMsg2(\"已达到限购数量，不能购买\");\n                return;\n            }\n            if (!this._da.sell) {\n                // if (this._da.unlockLevel>modelMgr.mainModel.userinfo.level) {\n                showMsg2(\"等级不足，不能购买未解锁的商品\");\n                return;\n            }\n            \n        }\n\n        if (modelMgr.jishiModel.hasPlSelect) {\n            this.setSelcet({ data: { isSelect: !this.isSelect ,from:\"self\"} });\n            Log.log(TAG, modelMgr.jishiModel.hasSelectData);\n        } else {\n            JishiGoumaiTK.oprType = this.oprType;\n            JishiGoumaiTK.DATA = this._da;\n\n            //弹出购买弹框\n            LoadingController.ins.showLoading();\n            uiMgr.popToParent(\"prefabs/jishi/pre_jishiGm\");\n        }\n\n    }\n}\n\n"]}